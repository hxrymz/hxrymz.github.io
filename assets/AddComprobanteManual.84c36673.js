import{k as Z,d as $,T as ee,w as ce,M as te,Q as ne,r as g,u as r,g as u,b as t,j as o,a as e,O as A,W as le,p as ie}from"./index.e4ecd20e.js";/* empty css               */import{CloseModal as se}from"./DialogHRM.cdb24d33.js";/* empty css                  */const Q=Z();$();const _=ee(),ae=ce(),oe=te(),W=ne(),p="new_operation_comprobante",Ce=({data:n,confirm:m})=>{var O,k,L,F,I,P,w,D,E,M,T,B,H,j,q;const[d,N]=g.exports.useState(!1),[y,l]=g.exports.useState(0);g.exports.useEffect(()=>{d||(N(!0),r("accountPicker",{}),l(u()))});const v=(c,i,s)=>{let a=t(p)||{};s?(a[s]||(a[s]={}),a[s][c]=i):a[c]=i,r(p,a),l(u())},x=async()=>{let c=t(p);c.date||(c.date=Date.now());let i=new Date;c.comprobanteId=i.getFullYear()+""+(i.getMonth()+1)+"-"+le();let s=t("accountListOnCmp")&&A(t("accountListOnCmp"));s&&(s==null||s.map(async(a,ue)=>{var K,R;let b={...c},f=t("accountListOnCmp")[a];b.account=f.account;let z=(K=t("account_ids"))==null?void 0:K[f.account];z.payOrCollect&&(b.payOrCollect=z.payOrCollect),b.subAccount=f.subAccount,b.type=f.type,b.amount=f.amount*1,b.operationId=u();let X={query:"addOperationsHRG",params:{businessId:(R=t("profileUser"))==null?void 0:R.businessId},form:b};const G=await ie(X);G&&console.log(G)})),n!=null&&n.modalID&&se({id:n==null?void 0:n.modalID}),setTimeout(()=>{r("accountListOnCmp",null),r(p,null),l(u()),m&&m()},400)},U=(c,i)=>{r("accountPicker",{account:c,subAccount:i}),l(u())},Y=()=>{r("accountPicker",null),l(u())},S=(c,i,s)=>{let a=t("accountPicker")||{};s?(a[s]||(a[s]={}),a[s][c]=i):a[c]=i,r("accountPicker",a),l(u())},J=()=>{let c=t("accountPicker")||{};c.type||(c.type="debit");let i=t("accountListOnCmp")||{},s=c.account+"_"+c.subAccount;i[s]=c,r("accountListOnCmp",i),r("accountPicker",null),l(u())},V=c=>{let i=t("accountListOnCmp")||{};delete i[c],r("accountListOnCmp",i),l(u())};let C=(k=t("account_ids"))==null?void 0:k[(O=t("accountPicker"))==null?void 0:O.account],h=(F=t("sub_account_ids"))==null?void 0:F[(L=t("accountPicker"))==null?void 0:L.subAccount];return o("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[o("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Asiento Manual"}),e("div",{className:"flexSpace"})]}),o("div",{className:"_dsplFlx ",children:[e(_,{init:(I=t(p))==null?void 0:I.date,label:"Fecha",width:120,updChanges:c=>v("date",c)}),e("div",{className:"flexSpace"}),e(_,{init:(P=t(p))==null?void 0:P.document,label:"Documento",width:120,updChanges:c=>v("document",c)})]}),e(_,{init:(w=t(p))==null?void 0:w.description,label:"Descripcion",width:520,updChanges:c=>v("description",c)}),o("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(D=t("accountPicker"))!=null&&D.account?o("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[o("div",{className:" acc_dtls",children:[o("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff"},children:C==null?void 0:C.code}),e("div",{className:"name",children:C==null?void 0:C.name})]}),e("div",{className:"flexSpace"}),h?o("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[e("div",{className:"code",children:h==null?void 0:h.subAccount}),e("div",{className:"name",children:h==null?void 0:h.subAccountName})]}):null]}),e("div",{className:"flexSpace"}),e("div",{className:"icon",onClick:Y,children:e(Q,{name:"outline_edit",color:"#1a73e8"})})]}):e(oe,{placeholder:"buscar una cuenta",width:420,handleClick:U}),(E=t("accountPicker"))!=null&&E.account?o("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[e("div",{className:"flexSpace"}),e(ae,{data:[{label:"Debito",id:"debit"},{label:"Credito",id:"credit"}],active:((M=t("accountPicker"))==null?void 0:M.type)||"debit",updSelect:c=>S("type",c)}),e("div",{className:"flexSpace"})]}):null,(T=t("accountPicker"))!=null&&T.account?o("div",{className:"_dsplFlx ",children:[e("div",{className:"",style:{maxWidth:130},children:e(_,{init:(B=t("accountPicker"))==null?void 0:B.amount,label:"Importe",width:120,type:"number",updChanges:c=>S("amount",c)})}),e("div",{className:"flexSpace"}),(H=t("accountPicker"))!=null&&H.amount?e("div",{className:"card",children:e("button",{onClick:J,children:"Agregar"})}):null]}):null,o("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Cuenta"}),e("div",{className:"tr_bar",children:"Sub Cuenta"}),e("div",{className:"tr_bar",children:"Debito"}),e("div",{className:"tr_bar",children:"Credito"})]}),t("accountListOnCmp")&&((j=A(t("accountListOnCmp")))==null?void 0:j.map((c,i)=>e(de,{idKey:c,data:t("accountListOnCmp")[c],deleteItem:V},c)))]}),o("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),((q=t(p))==null?void 0:q.document)&&re(t("accountListOnCmp"))?e("div",{className:"card",children:e("button",{onClick:x,children:"Guardar"})}):null]})]})},de=({data:n,deleteItem:m,idKey:d})=>{var v,x;let N=(v=t("account_ids"))==null?void 0:v[n==null?void 0:n.account],y=(x=t("sub_account_ids"))==null?void 0:x[n==null?void 0:n.subAccount];const l=()=>{m(d)};return o("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",children:e(W,{data:N,labelField:"code",infoField:"name"})}),e("div",{className:"tr_bar",children:e(W,{data:y,labelField:"subAccount",infoField:"subAccountName"})}),e("div",{className:"tr_bar",children:(n==null?void 0:n.type)==="debit"?n.amount:0}),e("div",{className:"tr_bar",children:(n==null?void 0:n.type)==="credit"?n.amount:0}),e("div",{className:"flexSpace"}),e("div",{className:"icon",onClick:l,children:e(Q,{name:"outline_delete",color:"#c62828"})})]})},re=n=>{let m=0,d=n&&A(n);return d&&(d==null||d.map((N,y)=>{let l=n[N];(l==null?void 0:l.type)==="debit"?m+=(l==null?void 0:l.amount)*1:(l==null?void 0:l.type)==="credit"&&(m-=(l==null?void 0:l.amount)*1)})),d&&(d==null?void 0:d.length)>0&&m===0};export{Ce as default};
