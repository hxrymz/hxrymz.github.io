import{k as X,d as Z,T as $,t as ee,G as ce,r as g,u as r,g as u,b as t,j as o,a as e,O as A,H as te,p as ne}from"./index.45b640e6.js";/* empty css               */import{CloseModal as se}from"./DialogHRM.86667e02.js";/* empty css                  */const U=X();Z();const y=$(),le=ee(),ie=ce(),p="new_operation_comprobante",be=({data:n,confirm:m})=>{var O,k,L,I,P,F,w,E,H,M,T,B,D,G,j;const[d,h]=g.exports.useState(!1),[N,s]=g.exports.useState(0);g.exports.useEffect(()=>{d||(h(!0),r("accountPicker",{}),s(u()))});const x=(c,l,i)=>{let a=t(p)||{};i?(a[i]||(a[i]={}),a[i][c]=l):a[c]=l,r(p,a),s(u())},f=async()=>{let c=t(p);c.date||(c.date=Date.now());let l=new Date;c.comprobanteId=l.getFullYear()+""+(l.getMonth()+1)+"-"+te();let i=t("accountListOnCmp")&&A(t("accountListOnCmp"));i&&(i==null||i.map(async(a,de)=>{var K,R;let v={...c},_=t("accountListOnCmp")[a];v.account=_.account;let q=(K=t("account_ids"))==null?void 0:K[_.account];q.payOrCollect&&(v.payOrCollect=q.payOrCollect),v.subAccount=_.subAccount,v.type=_.type,v.amount=_.amount*1,v.operationId=u();let V={query:"addOperationsHRG",params:{businessId:(R=t("profileUser"))==null?void 0:R.businessId},form:v};const z=await ne(V);z&&console.log(z)})),n!=null&&n.modalID&&se({id:n==null?void 0:n.modalID}),setTimeout(()=>{r("accountListOnCmp",null),r(p,null),s(u()),m&&m()},400)},W=(c,l)=>{r("accountPicker",{account:c,subAccount:l}),s(u())},Y=()=>{r("accountPicker",null),s(u())},S=(c,l,i)=>{let a=t("accountPicker")||{};i?(a[i]||(a[i]={}),a[i][c]=l):a[c]=l,r("accountPicker",a),s(u())},J=()=>{let c=t("accountPicker")||{};c.type||(c.type="debit");let l=t("accountListOnCmp")||{},i=c.account+"_"+c.subAccount;l[i]=c,r("accountListOnCmp",l),r("accountPicker",null),s(u())},Q=c=>{let l=t("accountListOnCmp")||{};delete l[c],r("accountListOnCmp",l),s(u())};let C=(k=t("account_ids"))==null?void 0:k[(O=t("accountPicker"))==null?void 0:O.account],b=(I=t("sub_account_ids"))==null?void 0:I[(L=t("accountPicker"))==null?void 0:L.subAccount];return o("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[o("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Asiento Manual"}),e("div",{className:"flexSpace"})]}),o("div",{className:"_dsplFlx ",children:[e(y,{init:(P=t(p))==null?void 0:P.date,label:"Fecha",width:120,updChanges:c=>x("date",c)}),e("div",{className:"flexSpace"}),e(y,{init:(F=t(p))==null?void 0:F.document,label:"Documento",width:120,updChanges:c=>x("document",c)})]}),e(y,{init:(w=t(p))==null?void 0:w.description,label:"Descripcion",width:520,updChanges:c=>x("description",c)}),o("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(E=t("accountPicker"))!=null&&E.account?o("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[o("div",{className:" acc_dtls",children:[o("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff"},children:C==null?void 0:C.code}),e("div",{className:"name",children:C==null?void 0:C.name})]}),e("div",{className:"flexSpace"}),b?o("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[e("div",{className:"code",children:b==null?void 0:b.subAccount}),e("div",{className:"name",children:b==null?void 0:b.subAccountName})]}):null]}),e("div",{className:"flexSpace"}),e("div",{className:"icon",onClick:Y,children:e(U,{name:"outline_edit",color:"#1a73e8"})})]}):e(ie,{placeholder:"buscar una cuenta",width:420,handleClick:W}),(H=t("accountPicker"))!=null&&H.account?o("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[e("div",{className:"flexSpace"}),e(le,{data:[{label:"Debito",id:"debit"},{label:"Credito",id:"credit"}],active:((M=t("accountPicker"))==null?void 0:M.type)||"debit",updSelect:c=>S("type",c)}),e("div",{className:"flexSpace"})]}):null,(T=t("accountPicker"))!=null&&T.account?o("div",{className:"_dsplFlx ",children:[e("div",{className:"",style:{maxWidth:130},children:e(y,{init:(B=t("accountPicker"))==null?void 0:B.amount,label:"Importe",width:120,type:"number",updChanges:c=>S("amount",c)})}),e("div",{className:"flexSpace"}),(D=t("accountPicker"))!=null&&D.amount?e("div",{className:"card",children:e("button",{onClick:J,children:"Agregar"})}):null]}):null,o("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Cuenta"}),e("div",{className:"tr_bar",children:"Sub Cuenta"}),e("div",{className:"tr_bar",children:"Debito"}),e("div",{className:"tr_bar",children:"Credito"})]}),t("accountListOnCmp")&&((G=A(t("accountListOnCmp")))==null?void 0:G.map((c,l)=>e(ae,{idKey:c,data:t("accountListOnCmp")[c],deleteItem:Q},c)))]}),o("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),((j=t(p))==null?void 0:j.document)&&oe(t("accountListOnCmp"))?e("div",{className:"card",children:e("button",{onClick:f,children:"Guardar"})}):null]})]})},ae=({data:n,deleteItem:m,idKey:d})=>{var x,f;let h=(x=t("account_ids"))==null?void 0:x[n==null?void 0:n.account],N=(f=t("sub_account_ids"))==null?void 0:f[n==null?void 0:n.subAccount];const s=()=>{m(d)};return o("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",children:h==null?void 0:h.code}),e("div",{className:"tr_bar",children:N==null?void 0:N.subAccount}),e("div",{className:"tr_bar",children:(n==null?void 0:n.type)==="debit"?n.amount:0}),e("div",{className:"tr_bar",children:(n==null?void 0:n.type)==="credit"?n.amount:0}),e("div",{className:"flexSpace"}),e("div",{className:"icon",onClick:s,children:e(U,{name:"outline_delete",color:"#c62828"})})]})},oe=n=>{let m=0,d=n&&A(n);return d&&(d==null||d.map((h,N)=>{let s=n[h];(s==null?void 0:s.type)==="debit"?m+=(s==null?void 0:s.amount)*1:(s==null?void 0:s.type)==="credit"&&(m-=(s==null?void 0:s.amount)*1)})),d&&(d==null?void 0:d.length)>0&&m===0};export{be as default};
