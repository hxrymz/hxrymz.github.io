import{S as Z,C as $,T as ee,o as ce,a1 as te,D as ne,r as g,u as r,b as u,g as t,j as o,a as e,h as A,M as le,i as ae}from"./index.4583f769.js";/* empty css                */import{CloseModal as se}from"./DialogHRM.74ea5c4e.js";/* empty css                  */const W=Z();$();const f=ee(),ie=ce(),oe=te(),U=ne(),h="new_operation_comprobante",Ce=({data:n,confirm:m})=>{var F,L,O,k,I,P,w,D,E,M,T,B,H,j,q;const[d,x]=g.exports.useState(!1),[y,l]=g.exports.useState(0);g.exports.useEffect(()=>{d||(x(!0),r("accountPicker",{}),l(u()))});const p=(c,a,s)=>{let i=t(h)||{};s?(i[s]||(i[s]={}),i[s][c]=a):i[c]=a,r(h,i),l(u())},N=async()=>{let c=t(h);c.date?c.date=new Date(c.date).getTime():c.date=Date.now();let a=new Date;c.comprobanteId=a.getFullYear()+""+(a.getMonth()+1)+"-"+le();let s=t("accountListOnCmp")&&A(t("accountListOnCmp"));s&&(s==null||s.map(async(i,ue)=>{var K,R;let v={...c},_=t("accountListOnCmp")[i];v.account=_.account;let z=(K=t("account_ids"))==null?void 0:K[_.account];z.payOrCollect&&(v.payOrCollect=z.payOrCollect),v.subAccount=_.subAccount,v.type=_.type,v.amount=_.amount*1,v.operationId=u();let X={query:"addOperationsHRG",params:{businessId:(R=t("profileUser"))==null?void 0:R.businessId},form:v};const G=await ae(X);G&&console.log(G)})),n!=null&&n.modalID&&se({id:n==null?void 0:n.modalID}),setTimeout(()=>{r("accountListOnCmp",null),r(h,null),l(u()),m&&m()},400)},Y=(c,a)=>{r("accountPicker",{account:c,subAccount:a}),l(u())},J=()=>{r("accountPicker",null),l(u())},S=(c,a,s)=>{let i=t("accountPicker")||{};s?(i[s]||(i[s]={}),i[s][c]=a):i[c]=a,r("accountPicker",i),l(u())},Q=()=>{let c=t("accountPicker")||{};c.type||(c.type="debit");let a=t("accountListOnCmp")||{},s=c.account+"_"+c.subAccount;a[s]=c,r("accountListOnCmp",a),r("accountPicker",null),l(u())},V=c=>{let a=t("accountListOnCmp")||{};delete a[c],r("accountListOnCmp",a),l(u())};let C=(L=t("account_ids"))==null?void 0:L[(F=t("accountPicker"))==null?void 0:F.account],b=(k=t("sub_account_ids"))==null?void 0:k[(O=t("accountPicker"))==null?void 0:O.subAccount];return o("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[o("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Asiento Manual"}),e("div",{className:"flexSpace"})]}),o("div",{className:"_dsplFlx ",children:[e(f,{init:(I=t(h))==null?void 0:I.date,label:"Fecha",width:120,updChanges:c=>p("date",c)}),e("div",{className:"flexSpace"}),e(f,{init:(P=t(h))==null?void 0:P.document,label:"Documento",width:120,updChanges:c=>p("document",c)})]}),e(f,{init:(w=t(h))==null?void 0:w.description,label:"Descripcion",width:520,updChanges:c=>p("description",c)}),o("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(D=t("accountPicker"))!=null&&D.account?o("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[o("div",{className:" acc_dtls",children:[o("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff"},children:C==null?void 0:C.code}),e("div",{className:"name",children:C==null?void 0:C.name})]}),e("div",{className:"flexSpace"}),b?o("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[e("div",{className:"code",children:b==null?void 0:b.subAccount}),e("div",{className:"name",children:b==null?void 0:b.subAccountName})]}):null]}),e("div",{className:"flexSpace"}),e("div",{className:"icon",onClick:J,children:e(W,{name:"outline_edit",color:"#1a73e8"})})]}):e(oe,{placeholder:"buscar una cuenta",width:420,handleClick:Y}),(E=t("accountPicker"))!=null&&E.account?o("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[e("div",{className:"flexSpace"}),e(ie,{data:[{label:"Debito",id:"debit"},{label:"Credito",id:"credit"}],active:((M=t("accountPicker"))==null?void 0:M.type)||"debit",updSelect:c=>S("type",c)}),e("div",{className:"flexSpace"})]}):null,(T=t("accountPicker"))!=null&&T.account?o("div",{className:"_dsplFlx ",children:[e("div",{className:"",style:{maxWidth:130},children:e(f,{init:(B=t("accountPicker"))==null?void 0:B.amount,label:"Importe",width:120,type:"number",updChanges:c=>S("amount",c)})}),e("div",{className:"flexSpace"}),(H=t("accountPicker"))!=null&&H.amount?e("div",{className:"card",children:e("button",{onClick:Q,children:"Agregar"})}):null]}):null,o("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Cuenta"}),e("div",{className:"tr_bar",children:"Sub Cuenta"}),e("div",{className:"tr_bar",children:"Debito"}),e("div",{className:"tr_bar",children:"Credito"})]}),t("accountListOnCmp")&&((j=A(t("accountListOnCmp")))==null?void 0:j.map((c,a)=>e(de,{idKey:c,data:t("accountListOnCmp")[c],deleteItem:V},c)))]}),o("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),((q=t(h))==null?void 0:q.document)&&re(t("accountListOnCmp"))?e("div",{className:"card",children:e("button",{onClick:N,children:"Guardar"})}):null]})]})},de=({data:n,deleteItem:m,idKey:d})=>{var p,N;let x=(p=t("account_ids"))==null?void 0:p[n==null?void 0:n.account],y=(N=t("sub_account_ids"))==null?void 0:N[n==null?void 0:n.subAccount];const l=()=>{m(d)};return o("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",children:e(U,{data:x,labelField:"code",infoField:"name"})}),e("div",{className:"tr_bar",children:e(U,{data:y,labelField:"subAccount",infoField:"subAccountName"})}),e("div",{className:"tr_bar",children:(n==null?void 0:n.type)==="debit"?n.amount:0}),e("div",{className:"tr_bar",children:(n==null?void 0:n.type)==="credit"?n.amount:0}),e("div",{className:"flexSpace"}),e("div",{className:"icon",onClick:l,children:e(W,{name:"outline_delete",color:"#c62828"})})]})},re=n=>{let m=0,d=n&&A(n);return d&&(d==null||d.map((x,y)=>{let l=n[x],p=m.toFixed(2);m=(l!=null&&l.amount?(l==null?void 0:l.type)==="debit"?parseFloat(l.amount):parseFloat(l.amount)*-1:0)+parseFloat(p)})),d&&(d==null?void 0:d.length)>0&&m===0};export{Ce as default};
