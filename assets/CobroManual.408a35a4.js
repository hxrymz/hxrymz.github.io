import{k as z,d as U,T as L,t as Q,Q as Y,r as g,u as h,g as v,j as i,a as e,b as t,O as S,H as $,p as J}from"./index.dd640a53.js";/* empty css                */import{CloseModal as V}from"./DialogHRM.eeed9a44.js";/* empty css                  */const W=z();U();const A=L(),X=Q(),O=Y(),s="new_cobro_comprobante",se=({data:c,confirm:u})=>{var p,r,T,w,D,F,E;const[b,_]=g.exports.useState(!1),[I,y]=g.exports.useState(0);g.exports.useEffect(()=>{b||(_(!0),h("accountPicker",{}),y(v()))});const x=(l,a,d)=>{let o=t(s)||{};d?(o[d]||(o[d]={}),o[d][l]=a):o[l]=a,h(s,o),y(v())},n=async()=>{var q;let l=t(s),a=[];l.date||(l.date=Date.now());let d=new Date;l.comprobanteId=d.getFullYear()+""+(d.getMonth()+1)+"-"+$();let o={...l},k=ee(t("multi_collect_by_doc"));o.document=o.collectDocument,o.account=t("PaymentMethodAccount").account,o.subAccount=t("PaymentMethodAccount").subAccount,o.type="debit",o.amount=k*1,o.operationId=v();let B={query:"addOperationsHRG",params:{businessId:(q=t("profileUser"))==null?void 0:q.businessId},form:o};a.push(B);let C=t("multi_collect_by_doc")&&S(t("multi_collect_by_doc"));C&&(C==null||C.map((N,j)=>{var M,P,H;let m={...l},G=t("multi_collect_by_doc")[N];m.document=N,m.account=(M=t("Acc2Collect"))==null?void 0:M.account,m.subAccount=(P=t("Acc2Collect"))==null?void 0:P.subAccount,m.type="credit",m.amount=G*1,m.payOrCollect="collect",m.operationId=v();let K={query:"addOperationsHRG",params:{businessId:(H=t("profileUser"))==null?void 0:H.businessId},form:m};a.push(K)}));const R=a.map(async N=>{await J(N)});await Promise.all(R),c!=null&&c.modalID&&V({id:c==null?void 0:c.modalID}),setTimeout(()=>{h("multi_collect_by_doc",null),h(s,null),y(v()),u&&u()},400)},f=(l,a)=>{h("PaymentMethodAccount",{account:l,subAccount:a})};return i("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[i("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Registrando Cobro"}),e("div",{className:"flexSpace"})]}),i("div",{className:"_dsplFlx ",children:[i("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[e("div",{className:"flexSpace"}),e(X,{data:[{label:"Efectivo",id:"cash"},{label:"Tarjeta",id:"card"},{label:"Cheque",id:"check"}],active:((p=t(s))==null?void 0:p.paymentType)||"cash",updSelect:l=>x("paymentType",l)}),e("div",{className:"flexSpace"})]}),e("div",{className:"flexSpace"}),e(A,{init:(r=t(s))==null?void 0:r.collectDocument,label:"Documento de Cobro",width:200,updChanges:l=>x("collectDocument",l)})]}),((T=t(s))==null?void 0:T.paymentType)==="card"?e(O,{query:"Cred",type:(w=t(s))==null?void 0:w.paymentType,handleClick:f}):e(O,{query:"Efectivo",type:(D=t(s))==null?void 0:D.paymentType,handleClick:f}),e(A,{init:(F=t(s))==null?void 0:F.description,label:"Descripcion",width:520,updChanges:l=>x("description",l)}),i("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[i("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Documento"}),e("div",{className:"tr_bar",children:"Balance"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Por Cobrar"})]}),t("collect_by_doc")&&((E=S(t("collect_by_doc")))==null?void 0:E.map((l,a)=>e(Z,{idKey:l,data:t("collect_by_doc")[l]},l)))]}),i("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),e("div",{className:"card",children:e("button",{onClick:n,children:"Guardar"})})]})]})},Z=({data:c,deleteItem:u,idKey:b})=>{const[_,I]=g.exports.useState(0),y=n=>{I(n),x(c==null?void 0:c.document,n)},x=(n,f,p)=>{let r=t("multi_collect_by_doc")||{};p?(r[p]||(r[p]={}),r[p][n]=f):r[n]=f,h("multi_collect_by_doc",r)};return i("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10},children:c==null?void 0:c.document}),i("div",{className:"tr_bar",style:{marginTop:10},children:["$",((c==null?void 0:c.amount)*1).toFixed(2)]}),e("div",{className:"tr_bar",style:{marginTop:10},children:_>(c==null?void 0:c.amount)?e("div",{className:"icon",children:e(W,{name:"alert",color:"#c62828"})}):null}),e("div",{className:"tr_bar",children:e(A,{init:_,width:80,updChanges:n=>y(n)})})]})},ee=c=>{var b;let u=0;return c&&((b=S(c))==null||b.map((_,I)=>{u+=c[_]*1})),u};export{se as default};
