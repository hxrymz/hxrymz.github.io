import{k as z,d as U,T as L,t as W,W as Y,r as g,u as h,g as y,j as i,a as e,b as t,O as I,H as $,p as J}from"./index.26c96b50.js";/* empty css                */import{CloseModal as Q}from"./DialogHRM.e989df6d.js";/* empty css                  */const V=z();U();const A=L(),X=W(),H=Y(),s="new_cobro_comprobante",se=({data:c,confirm:p})=>{var u,r,T,w,D,F,E;const[x,_]=g.exports.useState(!1),[S,b]=g.exports.useState(0);g.exports.useEffect(()=>{x||(_(!0),h("accountPicker",{}),b(y()))});const f=(l,a,d)=>{let o=t(s)||{};d?(o[d]||(o[d]={}),o[d][l]=a):o[l]=a,h(s,o),b(y())},n=async()=>{var q;let l=t(s),a=[];l.date||(l.date=Date.now());let d=new Date;l.comprobanteId=d.getFullYear()+""+(d.getMonth()+1)+"-"+$();let o={...l},k=ee(t("multi_collect_by_doc"));o.document=o.collectDocument,o.account=t("PaymentMethodAccount").account,o.subAccount=t("PaymentMethodAccount").subAccount,o.type="debit",o.amount=k*1,o.operationId=y();let B={query:"addOperationsHRG",params:{businessId:(q=t("profileUser"))==null?void 0:q.businessId},form:o};a.push(B);let C=t("multi_collect_by_doc")&&I(t("multi_collect_by_doc"));C&&(C==null||C.map((N,j)=>{var M,P,O;let m={...l},G=t("multi_collect_by_doc")[N];m.document=N,m.account=(M=t("Acc2Collect"))==null?void 0:M.account,m.subAccount=(P=t("Acc2Collect"))==null?void 0:P.subAccount,m.type="credit",m.amount=G*1,m.payOrCollect="collect",m.operationId=y();let K={query:"addOperationsHRG",params:{businessId:(O=t("profileUser"))==null?void 0:O.businessId},form:m};a.push(K)}));const R=a.map(async N=>{await J(N)});await Promise.all(R),c!=null&&c.modalID&&Q({id:c==null?void 0:c.modalID}),setTimeout(()=>{h("multi_collect_by_doc",null),h(s,null),b(y()),p&&p()},400)},v=(l,a)=>{h("PaymentMethodAccount",{account:l,subAccount:a})};return i("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[i("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Registrando Cobro"}),e("div",{className:"flexSpace"})]}),i("div",{className:"_dsplFlx ",children:[i("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[e("div",{className:"flexSpace"}),e(X,{data:[{label:"Efectivo",id:"cash"},{label:"Tarjeta",id:"card"},{label:"Cheque",id:"check"}],active:((u=t(s))==null?void 0:u.paymentType)||"cash",updSelect:l=>f("paymentType",l)}),e("div",{className:"flexSpace"})]}),e("div",{className:"flexSpace"}),e(A,{init:(r=t(s))==null?void 0:r.collectDocument,label:"Documento de Cobro",width:200,updChanges:l=>f("collectDocument",l)})]}),((T=t(s))==null?void 0:T.paymentType)==="card"?e(H,{query:"Cred",type:(w=t(s))==null?void 0:w.paymentType,handleClick:v}):e(H,{query:"Efectivo",type:(D=t(s))==null?void 0:D.paymentType,handleClick:v}),e(A,{init:(F=t(s))==null?void 0:F.description,label:"Descripcion",width:520,updChanges:l=>f("description",l)}),i("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[i("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Documento"}),e("div",{className:"tr_bar",children:"Balance"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Por Cobrar"})]}),t("collect_by_doc")&&((E=I(t("collect_by_doc")))==null?void 0:E.map((l,a)=>e(Z,{idKey:l,data:t("collect_by_doc")[l],updObs:b},l)))]}),i("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),e("div",{className:"card",children:e("button",{onClick:n,children:"Guardar"})})]})]})},Z=({data:c,updObs:p,idKey:x})=>{const[_,S]=g.exports.useState(0),b=n=>{S(n),f(c==null?void 0:c.document,n),p(y())},f=(n,v,u)=>{let r=t("multi_collect_by_doc")||{};u?(r[u]||(r[u]={}),r[u][n]=v):r[n]=v,h("multi_collect_by_doc",r)};return i("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10},children:c==null?void 0:c.document}),i("div",{className:"tr_bar",style:{marginTop:10},children:["$",((c==null?void 0:c.amount)*1).toFixed(2)]}),e("div",{className:"tr_bar",style:{marginTop:10},children:_>(c==null?void 0:c.amount)?e("div",{className:"icon",children:e(V,{name:"alert",color:"#c62828"})}):null}),e("div",{className:"tr_bar",children:e(A,{init:_,width:80,updChanges:n=>b(n)})})]})},ee=c=>{var x;let p=0;return c&&((x=I(c))==null||x.map((_,S)=>{p+=c[_]*1})),p};export{se as default};
