import{S as Q,C as V,T as W,o as X,K as Z,r as S,u as f,b as x,g as c,j as r,a as t,h as D,L as ee,i as ce}from"./index.9d80a6be.js";/* empty css               */import{CloseModal as te}from"./DialogHRM.691362e1.js";import{S as le}from"./server_fetching.d11ad7c6.js";/* empty css                  */const oe=Q();V();const I=W(),se=X(),G=Z(),s="new_cobro_comprobante",pe=({data:e,confirm:p})=>{var d,T,w,F,O,P,q,E;const[C,_]=S.exports.useState(!1),[A,h]=S.exports.useState(0);S.exports.useEffect(()=>{C||(_(!0),f("accountPicker",{}),h(x()))});const b=(l,i,m)=>{let u=c(s)||{};m?(u[m]||(u[m]={}),u[m][l]=i):u[l]=i,f(s,u),h(x())},n=async()=>{var k,B;let l=c(s),i=[];l.date?l.date=new Date(l.date).getTime():l.date=Date.now();let m=new Date;l.comprobanteId=m.getFullYear()+""+(m.getMonth()+1)+"-"+ee();let u="",N=c("multi_collect_by_doc")&&D(c("multi_collect_by_doc"));N&&(N==null||N.map((g,Y)=>{var H,K,R,j;let a={...l},$=c("multi_collect_by_doc")[g];a.document=g,u+=g+" ; ",a.account=(H=c("Acc2Collect"))==null?void 0:H.account,a.subAccount=(K=c("Acc2Collect"))==null?void 0:K.subAccount,a.customerId=(R=c("Acc2Collect"))==null?void 0:R.customerId,a.type="credit",a.amount=$*1,a.payOrCollect="collect",a.operationId=x();let J={query:"addOperationsHRG",params:{businessId:(j=c("profileUser"))==null?void 0:j.businessId},form:a};i.push(J)}));let o={...l},z=ie(c("multi_collect_by_doc"));o.document=o.collectDocument,o.collectDocument=u,o.account=c("PaymentMethodAccount").account;let M=(k=c("account_ids"))==null?void 0:k[o.account];M.payOrCollect&&(o.payOrCollect=M.payOrCollect),o.subAccount=c("PaymentMethodAccount").subAccount,o.type="debit",o.amount=z*1,o.operationId=x();let L={query:"addOperationsHRG",params:{businessId:(B=c("profileUser"))==null?void 0:B.businessId},form:o};i.push(L);const U=i.map(async g=>{await ce(g)});await Promise.all(U),e!=null&&e.modalID&&te({id:e==null?void 0:e.modalID}),setTimeout(()=>{f("multi_collect_by_doc",null),f(s,null),h(x()),p&&p()},400)},v=(l,i)=>{f("PaymentMethodAccount",{account:l,subAccount:i})};let y=le(c("collect_by_doc"),"amount");return r("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[r("div",{className:"_dsplFlx ",children:[t("p",{className:"form_title",children:"Registrando Cobro"}),t("div",{className:"flexSpace"})]}),t("div",{className:"_dsplFlx ",children:r("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[t("div",{className:"flexSpace"}),t(se,{data:[{label:"Cheque",id:"check"},{label:"Tarjeta",id:"card"}],active:((d=c(s))==null?void 0:d.paymentType)||"check",updSelect:l=>b("paymentType",l)}),t("div",{className:"flexSpace"})]})}),((T=c(s))==null?void 0:T.paymentType)==="card"?t(G,{query:"Cred",type:(w=c(s))==null?void 0:w.paymentType,handleClick:v}):t(G,{query:"Efectivo",type:(F=c(s))==null?void 0:F.paymentType,handleClick:v}),r("div",{className:"_dsplFlx ",children:[t(I,{init:(O=c(s))==null?void 0:O.date,label:"Fecha",width:120,updChanges:l=>b("date",l)}),t("div",{className:"flexSpace"}),t(I,{init:(P=c(s))==null?void 0:P.collectDocument,label:"Documento de Cobro",width:200,updChanges:l=>b("collectDocument",l)})]}),t(I,{init:(q=c(s))==null?void 0:q.description,label:"Descripcion",width:520,updChanges:l=>b("description",l)}),y?r("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[r("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[t("div",{className:"tr_bar",children:"Documento"}),t("div",{className:"tr_bar",children:"Balance"}),t("div",{className:"tr_bar"}),t("div",{className:"tr_bar",children:"Por Cobrar"})]}),c("collect_by_doc")&&((E=D(c("collect_by_doc")))==null?void 0:E.map((l,i)=>t(ne,{idKey:l,data:c("collect_by_doc")[l],updObs:h},l)))]}):null,r("div",{className:"_dsplFlx ",children:[t("div",{className:"flexSpace"}),t("div",{className:"card",children:t("button",{onClick:n,children:"Guardar"})})]})]})},ne=({data:e,updObs:p,idKey:C})=>{const[_,A]=S.exports.useState(0),h=n=>{A(n),b(e==null?void 0:e.document,n),p(x())},b=(n,v,y)=>{let d=c("multi_collect_by_doc")||{};y?(d[y]||(d[y]={}),d[y][n]=v):d[n]=v,f("multi_collect_by_doc",d)};return(e==null?void 0:e.amount)*1==0?null:r("div",{className:"_dsplFlx hdr_bar",children:[t("div",{className:"tr_bar",style:{marginTop:10},children:e==null?void 0:e.document}),r("div",{className:"tr_bar",style:{marginTop:10},children:["$",((e==null?void 0:e.amount)*1).toFixed(2)]}),t("div",{className:"tr_bar",style:{marginTop:10},children:_>(e==null?void 0:e.amount)?t("div",{className:"icon",children:t(oe,{name:"alert",color:"#c62828"})}):null}),t("div",{className:"tr_bar",children:t(I,{init:_,width:80,updChanges:n=>h(n)})})]})},ie=e=>{var C;let p=0;return e&&((C=D(e))==null||C.map((_,A)=>{p+=e[_]*1})),p};export{pe as default};
