import{k as Y,d as $,T as J,w as Q,a4 as V,r as g,u as y,g as f,b as t,j as a,a as c,O as A,W as X,p as Z}from"./index.1d27e4b7.js";/* empty css                */import{CloseModal as ee}from"./DialogHRM.8404feaa.js";import{S as ce}from"./server_fetching.912f386f.js";/* empty css                  */const te=Y();$();const S=J(),le=Q(),j=V(),s="new_cobro_comprobante",me=({data:e,confirm:u})=>{var r,D,w,T,F,O,P,q;const[x,p]=g.exports.useState(!1),[I,_]=g.exports.useState(0);g.exports.useEffect(()=>{x||(p(!0),y("accountPicker",{}),_(f()))});const h=(l,i,d)=>{let o=t(s)||{};d?(o[d]||(o[d]={}),o[d][l]=i):o[l]=i,y(s,o),_(f())},n=async()=>{var M,k;let l=t(s),i=[];l.date||(l.date=Date.now());let d=new Date;l.comprobanteId=d.getFullYear()+""+(d.getMonth()+1)+"-"+X();let o={...l},G=se(t("multi_collect_by_doc"));o.document=o.collectDocument,o.account=t("PaymentMethodAccount").account;let E=(M=t("account_ids"))==null?void 0:M[o.account];E.payOrCollect&&(o.payOrCollect=E.payOrCollect),o.subAccount=t("PaymentMethodAccount").subAccount,o.type="debit",o.amount=G*1,o.operationId=f();let K={query:"addOperationsHRG",params:{businessId:(k=t("profileUser"))==null?void 0:k.businessId},form:o};i.push(K);let v=t("multi_collect_by_doc")&&A(t("multi_collect_by_doc"));v&&(v==null||v.map((N,U)=>{var B,H,R;let m={...l},L=t("multi_collect_by_doc")[N];m.document=N,m.account=(B=t("Acc2Collect"))==null?void 0:B.account,m.subAccount=(H=t("Acc2Collect"))==null?void 0:H.subAccount,m.type="credit",m.amount=L*1,m.payOrCollect="collect",m.operationId=f();let W={query:"addOperationsHRG",params:{businessId:(R=t("profileUser"))==null?void 0:R.businessId},form:m};i.push(W)}));const z=i.map(async N=>{await Z(N)});await Promise.all(z),e!=null&&e.modalID&&ee({id:e==null?void 0:e.modalID}),setTimeout(()=>{y("multi_collect_by_doc",null),y(s,null),_(f()),u&&u()},400)},C=(l,i)=>{y("PaymentMethodAccount",{account:l,subAccount:i})};let b=ce(t("collect_by_doc"),"amount");return a("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[a("div",{className:"_dsplFlx ",children:[c("p",{className:"form_title",children:"Registrando Cobro"}),c("div",{className:"flexSpace"})]}),c("div",{className:"_dsplFlx ",children:a("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[c("div",{className:"flexSpace"}),c(le,{data:[{label:"Cheque",id:"check"},{label:"Tarjeta",id:"card"}],active:((r=t(s))==null?void 0:r.paymentType)||"check",updSelect:l=>h("paymentType",l)}),c("div",{className:"flexSpace"})]})}),((D=t(s))==null?void 0:D.paymentType)==="card"?c(j,{query:"Cred",type:(w=t(s))==null?void 0:w.paymentType,handleClick:C}):c(j,{query:"Efectivo",type:(T=t(s))==null?void 0:T.paymentType,handleClick:C}),a("div",{className:"_dsplFlx ",children:[c(S,{init:(F=t(s))==null?void 0:F.date,label:"Fecha",width:120,updChanges:l=>h("date",l)}),c("div",{className:"flexSpace"}),c(S,{init:(O=t(s))==null?void 0:O.collectDocument,label:"Documento de Cobro",width:200,updChanges:l=>h("collectDocument",l)})]}),c(S,{init:(P=t(s))==null?void 0:P.description,label:"Descripcion",width:520,updChanges:l=>h("description",l)}),b?a("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[a("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[c("div",{className:"tr_bar",children:"Documento"}),c("div",{className:"tr_bar",children:"Balance"}),c("div",{className:"tr_bar"}),c("div",{className:"tr_bar",children:"Por Cobrar"})]}),t("collect_by_doc")&&((q=A(t("collect_by_doc")))==null?void 0:q.map((l,i)=>c(oe,{idKey:l,data:t("collect_by_doc")[l],updObs:_},l)))]}):null,a("div",{className:"_dsplFlx ",children:[c("div",{className:"flexSpace"}),c("div",{className:"card",children:c("button",{onClick:n,children:"Guardar"})})]})]})},oe=({data:e,updObs:u,idKey:x})=>{const[p,I]=g.exports.useState(0),_=n=>{I(n),h(e==null?void 0:e.document,n),u(f())},h=(n,C,b)=>{let r=t("multi_collect_by_doc")||{};b?(r[b]||(r[b]={}),r[b][n]=C):r[n]=C,y("multi_collect_by_doc",r)};return(e==null?void 0:e.amount)*1==0?null:a("div",{className:"_dsplFlx hdr_bar",children:[c("div",{className:"tr_bar",style:{marginTop:10},children:e==null?void 0:e.document}),a("div",{className:"tr_bar",style:{marginTop:10},children:["$",((e==null?void 0:e.amount)*1).toFixed(2)]}),c("div",{className:"tr_bar",style:{marginTop:10},children:p>(e==null?void 0:e.amount)?c("div",{className:"icon",children:c(te,{name:"alert",color:"#c62828"})}):null}),c("div",{className:"tr_bar",children:c(S,{init:p,width:80,updChanges:n=>_(n)})})]})},se=e=>{var x;let u=0;return e&&((x=A(e))==null||x.map((p,I)=>{u+=e[p]*1})),u};export{me as default};
