import{u as j,h as z,r as p,n as A,a as _,j as t,k as o,o as u,q as k,t as y,v as T,w as E,x,y as P,z as N}from"./index.0d0fbac8.js";import{v as R}from"./validations.6c3f96aa.js";import{InputNFX as b}from"./LoginInput.eb32d48a.js";const w="loginFrm",H=({})=>{j(z);const[h,Q]=p.exports.useState(!1),[S,$]=p.exports.useState(!1),[I,i]=p.exports.useState(!1),[q,s]=p.exports.useState([]);let c={username:{reqired:!0,minLength:4},password:{reqired:!0,minLength:6,maxLength:60}};h&&(c={phoneNumber:{reqired:!0,number:!0,minLength:8,maxLength:8},password:{reqired:!0,minLength:6},username:{reqired:!0,minLength:4}});const v=(e,n)=>{let r=o(w)||{};r[e]=n,u(w,r)},F=async e=>{e.preventDefault();let n=o(w)||{},r={query:h?"singup":"login",params:n};if(R(c,n).valid){const a=await k(x(),r);if(a&&a.data){if(a.data.error==="507")i(!0),s(["No podemos encontrar una cuenta con esta informacion. Reint\xE9ntalo o crea una cuenta nueva."]);else if(a.data.error==="907")i(!0),s(["Su cuenta ha sido bloqueda","debido a muchos intentos de inicio de sesi\xF3n","debe esperar al menos 10 minutos para volver a intentarlo"]);else if(a.data.error==="509")i(!0),s(["Dispositivo no authorizado"," ha alcanzado el maximo de dispositivos permitidos","contacte con el administador para revisar o modificar sus dispositivos",`deviceId: ${o("fingerprintID")}`]);else if(a.data.error==="607")i(!0),s(["Cuenta desactivada por pago no realizado"]);else if(a.data.error==="609")i(!0),s(["Cuenta desactivada"]);else if(a.data.error==="532")i(!0),s(["Usuario en uso"]);else if(a.data.error==="535")i(!0),s(["Dispositivo utilizado por otra cuenta","contacte con el administador para revisar o modificar sus dispositivos",`deviceId: ${o("fingerprintID")}`]);else if(a.data.error==="101")i(!0),s(["Su cuenta ha sido creada y esta siendo revisada por nuestro equipo","si en 4 horas su cuenta no esta activa contacte con el administador","whatsApp:  (5023892075)","",`usuario: ${n.username} `,`deviceId: ${o("fingerprintID")} `]);else if(a.data.token){i(!1),s([""]);let l=new Date().getTime(),f=new Date(l+6e4*60*24*365),C=P();document.cookie=`${C}=${a.data.token}; expires=${f}; path=/;g_state = {"i_l":1,"i_p":${f}}`,u("singinView",!1),u("appLoaded",!0),y();let D={params:{tkn:a.data.token},query:"getTkn"};const g=await k(x(),D);g&&g.data&&g.data.username&&(u("userProfile",g.data),T(g.data.isAdmin),u("singinView",!1),u("appLoaded",!0),y(),E())}}}else s(["formulario invalido"]),i(!0)},U=()=>{let e=window.gapi;e.load("auth2",function(){setTimeout(()=>{e.signin2.render("google-signin-button",{width:232,height:40,longtitle:!0,hidden:!0,onsuccess:V,onfailure:L}),setTimeout(()=>{let n=e.auth2.getAuthInstance(),r=n&&n.currentUser.get(),d=r&&r.getAuthResponse();if(d.id_token){let m=d.id_token,a=d.access_token,l={params:{id_token:m,access_token:a,isQvamarkets:!0},query:"getGoogleUserbyToken"};console.log(l),o("userProfile")&&o("userProfile").name||N(l)}},350)},350)})},L=e=>{console.log("onFail",e)},V=e=>{let r=window.gapi.auth2.getAuthInstance(),d=r&&r.currentUser.get(),m=d&&d.getAuthResponse();var a=m.id_token,l=m.access_token;let f={params:{id_token:a,access_token:l},query:"getGoogleUserbyToken"};o("userProfile")&&o("userProfile").name||N(f)};return p.exports.useEffect(()=>{S||($(!0),A(()=>U()))}),_("div",{className:"hybrid_login_wrapper",style:{heigth:"100vw"},children:[t("div",{className:"login_wrapper_background",children:t("img",{className:"concord-img vlv-creative",src:"/static/media/login_small.jpg",srcset:"/static/media/login_small.jpg 1000w, /static/media/login_medium.jpg 1500w, /static/media/login_large.jpg 1800w",alt:""})}),t("div",{className:"login_body",children:t("div",{className:"padd ",children:t("div",{className:"login_content login_form hybrid_login_form hybrid_login_form_signup","data-uia":"login_page-container",children:_("div",{className:"hybrid_login_form_main",children:[t("h1",{"data-uia":"login_page_title",children:h?"Registrarse":"Inicia sesi\xF3n"}),I&&_("div",{"data-uia":"error_message_container",className:"ui_message_container ui_message_error",children:[t("div",{className:"ui_message_icon"}),t("div",{className:"multi_msg",children:q.map(e=>t("div",{"data-uia":"text",className:"ui_message_contents",children:e}))})]}),_("form",{className:"login_form",action:"",onSubmit:F,children:[t(b,{validationMsg:"Su usuario debe contener entre 4 y 20 caracteres.",validation:c.username,type:"text",placeholder:"Usuario",updChange:e=>v("username",e)}),t(b,{validationMsg:"Su contrase\xF1a debe contener entre 4 y 60 caracteres.",validation:c.password,type:"password",placeholder:"Contrase\xF1a",updChange:e=>v("password",e)}),h&&t(b,{validationMsg:"Su telefono debe contener 8 caracteres numericos.",validation:c.phoneNumber,type:"number",placeholder:"Telefono",updChange:e=>v("phoneNumber",e)}),t("button",{className:"btn login_button btn_submit btn_small",type:"submit",autocomplete:"off",tabindex:"0","data-uia":"login-submit-button",children:"Iniciar sesi\xF3n"})]}),t("div",{id:"google-signin-button","data-theme":"dark"})]})})})})]})};export{H as default};
