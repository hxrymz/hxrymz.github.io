import{u as V,f as j,r as u,i as z,a as p,j as t,e as d,h,k as y,m as k,n as E,o as P,p as $,t as R,q as N}from"./index.20bf7686.js";import{v as T}from"./validations.6c3f96aa.js";import{I as x}from"./LoginInput.8253be71.js";/* empty css                    */const _="loginFrm",J=G=>{V(j);const[S,I]=u.exports.useState(!1),[v,Q]=u.exports.useState(!1),[q,i]=u.exports.useState(!1),[U,s]=u.exports.useState([]);let m={username:{reqired:!0,minLength:4},password:{reqired:!0,minLength:6,maxLength:60}};v&&(m={phoneNumber:{reqired:!0,number:!0,minLength:8,maxLength:8},password:{reqired:!0,minLength:6},username:{reqired:!0,minLength:4}});const b=(e,n)=>{let r=d(_)||{};r[e]=n,h(_,r)},F=async e=>{e.preventDefault();let n=d(_)||{},r={query:v?"singup":"login",params:n};var l=T(m,n);if(l.valid){const a=await y($(),r);if(a&&a.data)if(a.data.error==="507")i(!0),s(["No podemos encontrar una cuenta con esta informacion. Reint\xE9ntalo o crea una cuenta nueva."]);else if(a.data.error==="509")i(!0),s(["Dispositivo no authorizado"," ha alcanzado el maximo de dispositivos permitidos","contacte con el administador para revisar o modificar sus dispositivos",`deviceId: ${d("fingerprintID")}`]);else if(a.data.error==="607")i(!0),s(["Cuenta desactivada por pago no realizado"]);else if(a.data.error==="609")i(!0),s(["Cuenta desactivada"]);else if(a.data.error==="532")i(!0),s(["Usuario en uso"]);else if(a.data.error==="535")i(!0),s(["Dispositivo utilizado por otra cuenta","contacte con el administador para revisar o modificar sus dispositivos",`deviceId: ${d("fingerprintID")}`]);else if(a.data.error==="101")i(!0),s(["Su cuenta ha sido creada y esta siendo revisada por nuestro equipo","si en 4 horassu cuenta no esta activa contacte con el administador","whatsApp:  (5023892075)","",`usuario: ${n.username} `,`deviceId: ${d("fingerprintID")} `]);else{i(!1),s([""]);let f=new Date().getTime();var o=new Date(f+6e4*60*24*365);let w=R();document.cookie=`${w}=${a.data}; expires=${o}; path=/;g_state = {"i_l":1,"i_p":${o}}`;let D={params:{tkn:a.data},query:"getTkn"};const c=await y($(),D);c&&c.data&&c.data.username&&(c.data.isAdmin?(h("userProfile",c.data),E(c.data.isAdmin),h("singinView",!1),h("appLoaded",!0),k(),P()):(i(!0),s(["No tiene privilegios para administar el sistema"]),document.cookie=`${w}=; expires=${o}; path=/;g_state = {"i_l":1,"i_p":${o}}`,k()))}}else s(["formulario invalido"]),i(!0)},L=()=>{let e=window.gapi;e.load("auth2",function(){setTimeout(()=>{e.signin2.render("google-signin-button",{width:232,height:40,longtitle:!0,hidden:!0,onsuccess:C,onfailure:A}),setTimeout(()=>{let n=e.auth2.getAuthInstance(),r=n&&n.currentUser.get(),l=r&&r.getAuthResponse();if(l.id_token){var o=l.id_token,g=l.access_token;let a={params:{id_token:o,access_token:g,isQvamarkets:!0},query:"getGoogleUserbyToken"};d("userProfile")&&d("userProfile").name||N(a)}},350)},350)})},A=e=>{console.log("onFail",e)},C=e=>{let r=window.gapi.auth2.getAuthInstance(),l=r&&r.currentUser.get(),o=l&&l.getAuthResponse();var g=o.id_token,a=o.access_token;let f={params:{id_token:g,access_token:a},query:"getGoogleUserbyToken"};d("userProfile")&&d("userProfile").name||N(f)};return u.exports.useEffect(()=>{S||(I(!0),z(()=>L()))}),p("div",{className:"hybrid_login_wrapper",style:{heigth:"100vw"},children:[t("div",{className:"login_wrapper_background",children:t("img",{className:"concord-img vlv-creative",src:"/static/media/login_small.jpg",srcset:"/static/media/login_small.jpg 1000w, /static/media/login_medium.jpg 1500w, /static/media/login_large.jpg 1800w",alt:""})}),t("div",{className:"login_body",children:t("div",{className:"padd ",children:t("div",{className:"login_content login_form hybrid_login_form hybrid_login_form_signup","data-uia":"login_page-container",children:p("div",{className:"hybrid_login_form_main",children:[t("h1",{"data-uia":"login_page_title",children:"Inicia sesi\xF3n en HRG Books"}),q&&p("div",{"data-uia":"error_message_container",className:"ui_message_container ui_message_error",children:[t("div",{className:"ui_message_icon"}),t("div",{className:"multi_msg",children:U.map(e=>t("div",{"data-uia":"text",className:"ui_message_contents",children:e}))})]}),p("form",{className:"login_form",action:"",onSubmit:F,children:[t(x,{validationMsg:"Su usuario debe contener entre 4 y 20 caracteres.",validation:m.username,type:"text",placeholder:"Usuario",updChange:e=>b("username",e)}),t(x,{validationMsg:"Su contrase\xF1a debe contener entre 4 y 60 caracteres.",validation:m.password,type:"password",placeholder:"Contrase\xF1a",updChange:e=>b("password",e)}),t("button",{className:"btn login_button btn_submit btn_small",type:"submit",autocomplete:"off",tabindex:"0","data-uia":"login-submit-button",children:"Iniciar sesi\xF3n"})]}),t("div",{id:"google-signin-button","data-theme":"dark"})]})})})})]})};export{J as default};
