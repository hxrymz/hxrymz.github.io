import{I as U,A as K,B as Q,S as J,l as E,_ as M,u as W,m as X,r as S,a as b,j as e,k as o,F as Y,J as Z,E as F,K as k,G as O,o as v,g as P,H as q,L,O as z,x as D,C as ee}from"./index.f1592be0.js";import{g as H}from"./index.c887690c.js";const te=U(),se=K(),ae=Q(),oe=J(),ne=E(()=>M(()=>import("./ViewAsientosBox.bbecc164.js"),["assets/ViewAsientosBox.bbecc164.js","assets/index.f1592be0.js","assets/index.4b84795f.css"]));E(()=>M(()=>import("./ViewAsientosItem.53fe8475.js"),["assets/ViewAsientosItem.53fe8475.js","assets/index.f1592be0.js","assets/index.4b84795f.css","assets/index.c887690c.js"]));const ie=E(()=>M(()=>import("./AddManuallyAsientos.1b6026aa.js"),["assets/AddManuallyAsientos.1b6026aa.js","assets/index.f1592be0.js","assets/index.4b84795f.css","assets/index.c887690c.js"])),ue=({view:l})=>{var d,y;W(X);const[i,N]=S.exports.useState(""),[f,_]=S.exports.useState(""),[A,r]=S.exports.useState(!1),p=async()=>{let t={query:"getAllOperationsHRG",params:{businessId:o("businessId")}};const a=await O(D(),t);a&&a.data&&(v("operationsHRGlist",a.data),r(!1),_(P()))},w=async()=>{let t={query:"getAllAccountsByUserId",params:{businessId:o("businessId")}};const a=await O(D(),t);a&&a.data&&v("cuentaslist",q(a.data,"accountId"));let g={query:"getAllSubAccounts",params:{businessId:o("businessId")}};const m=await O(D(),g);m&&m.data&&(v("sub_cuentas_list",m.data),v("sub_cuentas_dict",q(m.data,"sub_accountId")))};S.exports.useEffect(()=>()=>{},[]);const s=t=>{r(!0)},c=()=>F("operationsHRGListFilter",[o("operationsHRGlist"),i,o("showAll_operationsHRG")],()=>{var T;let t="date",u=["date","entryName","amount"],a={},g=[];const C=n=>{var I,$;let B=!1;u.forEach(G=>{var x,V,j;(i==null?void 0:i.toLowerCase())&&((j=(V=(x=n==null?void 0:n[G])==null?void 0:x.toString())==null?void 0:V.toLowerCase())==null?void 0:j.indexOf(i.toLowerCase()))>=0&&(B=!0)});let R=(i==null?void 0:i.toLowerCase())&&(($=(I=n==null?void 0:n.key)==null?void 0:I.toLowerCase())==null?void 0:$.indexOf(i.toLowerCase()))>=0;if(o("showAll_operationsHRG")||B||R){let G=Math.floor(n.date/1e3),x=`${n.document}_${G}`;return a[x]||(a[x]={},g.push({document:n.document,date:n.date,entryName:n.entryName,description:n.description})),a[x][n.operationId]=n,n}},m=(n,B)=>{let R=n[t],I=B[t];return R<I?-1:R>I?1:0};return(T=o("operationsHRGlist"))==null||T.filter(C),v("groupByDocument",a),g.sort(m)});S.exports.useEffect(()=>{setTimeout(()=>{window.scrollTo(0,0),w(),p()},170)},[l]);const h=t=>{v("showAll_operationsHRG",t),_(P())};return b("div",{className:"",children:[e("div",{className:"login_title ",children:e("div",{children:"Comprobantes"})}),b("div",{className:"_dsplFlx ",children:[e("div",{className:"login_title ",children:e(se,{lbl:"Agregar ",icon:"account",theme:"",updChanges:s})}),e("div",{className:"sendBtn _dsplFlx spaceAround ",style:{marginTop:8},children:b("div",{className:"in_stock_switch _dsplFlx",children:[e("div",{className:"in_stock_switch_btn",children:e(ae,{initvalue:o("showAll_operationsHRG"),keyCode:77,updChange:h})}),e("span",{className:"sw_rgh_span",children:"Mostrar Todas"})]})}),e("div",{className:"flexSpace"})]}),A?e(ie,{close:()=>r(!1),refreshlist:p}):b(Y,{children:[e("div",{className:" _search_MrgV  ",children:o("showAll_operationsHRG")?null:e("div",{className:"years_card ",style:{marginLeft:"2vw"},children:e(oe,{updChanges:N,placeholderCode:"buscar..."})})}),Z()?null:e("div",{className:"_dsplFlx  ",children:e("div",{className:"_dsplFlx cuenta_bx_details header",children:b("div",{className:"_dsplFlx ",children:[e("div",{className:"_header_item",style:{width:120},children:e("div",{children:"Fecha"})}),e("div",{className:"_header_item",style:{width:150},children:e("div",{children:"Documento"})}),e("div",{className:"_header_item",style:{width:300},children:e("div",{children:"Nombre Asiento"})}),e("div",{className:"_header_item",style:{width:120,textAlign:"left"},children:"Importe"})]})})}),e("div",{className:"operationsHRGlist",children:((d=c())==null?void 0:d.length)>0&&((y=c())==null?void 0:y.map(t=>t&&e(le,{item:t,refreshlist:p})))})]})]})},le=({item:l,refreshlist:i})=>{var w;let N=Math.floor(l.date/1e3),f=`${l.document}_${N}`;const _=s=>F("getSumAmount_"+s,[o("groupByDocument"),s],()=>{var h,d;let c=0;return(d=L(((h=o("groupByDocument"))==null?void 0:h[s])||{}))==null||d.map(y=>{var t,u,a,g,C,m;(a=(u=(t=o("groupByDocument"))==null?void 0:t[s])==null?void 0:u[y])!=null&&a.creditAccount&&(c+=((m=(C=(g=o("groupByDocument"))==null?void 0:g[s])==null?void 0:C[y])==null?void 0:m.amount)*1)}),c}),A=s=>F("getEntriesByDocument_"+s,[o("groupByDocument"),s],()=>{var h,d;let c=[];return(d=L(((h=o("groupByDocument"))==null?void 0:h[s])||{}))==null||d.map(y=>{var u,a;let t=(a=(u=o("groupByDocument"))==null?void 0:u[s])==null?void 0:a[y];t!=null&&t.debitAccount&&c.push({account:H(t.debitSubAccount),sub_acc:H(t.debitSubAccount,!0),debit:t.amount}),t!=null&&t.creditAccount&&c.push({account:H(t.creditSubAccount),sub_acc:H(t.creditSubAccount,!0),credit:t.amount})}),c}),r=()=>{v("entries2View",A(f));let s={};s.zIndex=450,s.props={item:l,minHeight:"1vh",overlay:!0},s.content=e(ne,{refreshlist:i,item:l}),z(s)},p=()=>{let s={};s.zIndex=450,s.props={minHeight:"1vh",overlay:!0},s.content=e(re,{confirm:()=>i(),item:l,doc_date_Id:f}),z(s)};return e("div",{className:"_dsplFlx cuenta_details ",style:{},children:b("div",{className:"_dsplFlx cuenta_bx_details ",style:{width:"96%"},children:[e("div",{children:b("div",{className:"_dsplFlx ",onClick:r,children:[e("div",{className:"_asiento_item",style:{width:120},children:k(l.date)}),e("div",{className:"_asiento_item",style:{width:150},children:l.document}),e("div",{className:"_asiento_item",style:{width:300},children:l.entryName?l.entryName:"Custom"}),e("div",{className:"_asiento_item",style:{width:120,textAlign:"right"},children:(w=_(f))==null?void 0:w.toFixed(2)})]})}),e("div",{className:"flexSpace"}),e("div",{className:"_dsplFlx",children:e("div",{className:"_dsplFlx delete_icon showOnhover",onClick:p,style:{marginRight:13},children:e(te,{name:"delete",size:24,color:"#b00000",tip:!0,tipMessage:"Borrar",backgroundColorTooltip:"#b00000"})})})]})})},re=({data:l,confirm:i,item:N,doc_date_Id:f})=>{const{modalID:_}=l||{},A=()=>{var p;let r=L(((p=o("groupByDocument"))==null?void 0:p[f])||{});r==null||r.map(async(w,s)=>{let c={query:"deleteOperationsHRG",params:{operationId:w,businessId:o("businessId")}};const d=await O(D(),c);d&&d.data&&s===(r==null?void 0:r.length)-1&&(ee({id:_}),i(N))})};return b("div",{..._?{"dialog-key-id":_}:"",className:"pym81b sendBx upd_alert_bx",style:{background:"var(--color_backgrond_input)"},children:[e("div",{className:"login_title ",style:{margin:"1vw"},children:e("div",{children:`Borrar Asiento "${N.document}"`})}),e("div",{className:"delete_alert_t2 ",children:e("div",{children:"Una vez borrado no podras recuperarlo"})}),e("button",{className:"btn login_button btn_submit btn_small",type:"submit",autocomplete:"off",tabindex:"0","data-uia":"login-submit-button",onClick:A,children:"Borrar"})]})};export{ue as default};
