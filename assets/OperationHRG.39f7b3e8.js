import{I as U,A as K,B as Q,S as J,l as L,_ as E,u as W,m as X,r as B,a as p,j as e,k as n,F as Y,J as Z,E as F,K as k,G as H,o as v,g as j,H as P,L as q,O as z,x as O,C as ee}from"./index.0d0fbac8.js";import{g as R}from"./index.7379b6d7.js";const te=U(),se=K(),ae=Q(),oe=J(),ne=L(()=>E(()=>import("./ViewAsientosBox.00d89c4e.js"),["assets/ViewAsientosBox.00d89c4e.js","assets/index.0d0fbac8.js","assets/index.5da7cfb4.css"]));L(()=>E(()=>import("./ViewAsientosItem.97b94a51.js"),["assets/ViewAsientosItem.97b94a51.js","assets/index.0d0fbac8.js","assets/index.5da7cfb4.css","assets/index.7379b6d7.js"]));const ie=L(()=>E(()=>import("./AddManuallyAsientos.f749bd1c.js"),["assets/AddManuallyAsientos.f749bd1c.js","assets/index.0d0fbac8.js","assets/index.5da7cfb4.css","assets/index.7379b6d7.js"])),ue=({view:l})=>{var m,y;W(X);const[i,_]=B.exports.useState(""),[h,N]=B.exports.useState(""),[A,f]=B.exports.useState(!1),u=async()=>{let t={query:"getAllOperationsHRG",params:{businessId:n("businessId")}};const a=await H(O(),t);a&&a.data&&(v("operationsHRGlist",a.data),f(!1),N(j()))},I=async()=>{let t={query:"getAllAccountsByUserId",params:{businessId:n("businessId")}};const a=await H(O(),t);a&&a.data&&v("cuentaslist",P(a.data,"accountId"));let g={query:"getAllSubAccounts",params:{businessId:n("businessId")}};const d=await H(O(),g);d&&d.data&&(v("sub_cuentas_list",d.data),v("sub_cuentas_dict",P(d.data,"sub_accountId")))};B.exports.useEffect(()=>()=>{},[]);const s=t=>{f(!0)},r=()=>F("operationsHRGListFilter",[n("operationsHRGlist"),i,n("showAll_operationsHRG")],()=>{var M;let t="date",c=["date","entryName","amount"],a={},g=[];const w=o=>{var C,T;let S=!1;c.forEach(G=>{var x,$,V;(i==null?void 0:i.toLowerCase())&&((V=($=(x=o==null?void 0:o[G])==null?void 0:x.toString())==null?void 0:$.toLowerCase())==null?void 0:V.indexOf(i.toLowerCase()))>=0&&(S=!0)});let D=(i==null?void 0:i.toLowerCase())&&((T=(C=o==null?void 0:o.key)==null?void 0:C.toLowerCase())==null?void 0:T.indexOf(i.toLowerCase()))>=0;if(n("showAll_operationsHRG")||S||D){let G=Math.floor(o.date/1e3),x=`${o.document}_${G}`;return a[x]||(a[x]={},g.push({document:o.document,date:o.date,entryName:o.entryName,description:o.description})),a[x][o.operationId]=o,o}},d=(o,S)=>{let D=o[t],C=S[t];return D<C?-1:D>C?1:0};return(M=n("operationsHRGlist"))==null||M.filter(w),v("groupByDocument",a),g.sort(d)});B.exports.useEffect(()=>{setTimeout(()=>{window.scrollTo(0,0),I(),u()},170)},[l]);const b=t=>{v("showAll_operationsHRG",t),N(j())};return p("div",{className:"",children:[e("div",{className:"login_title ",children:e("div",{children:"Comprobantes"})}),p("div",{className:"_dsplFlx ",children:[e("div",{className:"login_title ",children:e(se,{lbl:"Agregar ",icon:"account",theme:"",updChanges:s})}),e("div",{className:"sendBtn _dsplFlx spaceAround ",style:{marginTop:8},children:p("div",{className:"in_stock_switch _dsplFlx",children:[e("div",{className:"in_stock_switch_btn",children:e(ae,{initvalue:n("showAll_operationsHRG"),keyCode:77,updChange:b})}),e("span",{className:"sw_rgh_span",children:"Mostrar Todas"})]})}),e("div",{className:"flexSpace"})]}),A?e(ie,{close:()=>f(!1),refreshlist:u}):p(Y,{children:[e("div",{className:" _search_MrgV  ",children:n("showAll_operationsHRG")?null:e("div",{className:"years_card ",style:{marginLeft:"2vw"},children:e(oe,{updChanges:_,placeholderCode:"buscar..."})})}),Z()?null:e("div",{className:"_dsplFlx  ",children:e("div",{className:"_dsplFlx cuenta_bx_details header",children:p("div",{className:"_dsplFlx ",children:[e("div",{className:"_header_item",style:{width:120},children:e("div",{children:"Fecha"})}),e("div",{className:"_header_item",style:{width:150},children:e("div",{children:"Documento"})}),e("div",{className:"_header_item",style:{width:300},children:e("div",{children:"Nombre Asiento"})}),e("div",{className:"_header_item",style:{width:120,textAlign:"left"},children:"Importe"})]})})}),e("div",{className:"operationsHRGlist",children:((m=r())==null?void 0:m.length)>0&&((y=r())==null?void 0:y.map(t=>t&&e(le,{item:t,refreshlist:u})))})]})]})},le=({item:l,refreshlist:i})=>{var I;let _=Math.floor(l.date/1e3),h=`${l.document}_${_}`;const N=s=>F("getSumAmount_"+s,[n("groupByDocument"),s],()=>{var b,m;let r=0;return(m=q(((b=n("groupByDocument"))==null?void 0:b[s])||{}))==null||m.map(y=>{var t,c,a,g,w,d;(a=(c=(t=n("groupByDocument"))==null?void 0:t[s])==null?void 0:c[y])!=null&&a.creditAccount&&(r+=((d=(w=(g=n("groupByDocument"))==null?void 0:g[s])==null?void 0:w[y])==null?void 0:d.amount)*1)}),r}),A=s=>F("getEntriesByDocument_"+s,[n("groupByDocument"),s],()=>{var b,m;let r=[];return(m=q(((b=n("groupByDocument"))==null?void 0:b[s])||{}))==null||m.map(y=>{var c,a;let t=(a=(c=n("groupByDocument"))==null?void 0:c[s])==null?void 0:a[y];t!=null&&t.debitAccount&&r.push({account:R(t.debitSubAccount),sub_acc:R(t.debitSubAccount,!0),debit:t.amount}),t!=null&&t.creditAccount&&r.push({account:R(t.creditSubAccount),sub_acc:R(t.creditSubAccount,!0),credit:t.amount})}),r}),f=()=>{v("entries2View",A(h));let s={};s.zIndex=450,s.props={item:l,minHeight:"1vh",overlay:!0},s.content=e(ne,{refreshlist:i,item:l}),z(s)},u=()=>{let s={};s.zIndex=450,s.props={minHeight:"1vh",overlay:!0},s.content=e(re,{confirm:()=>i(),item:l}),z(s)};return e("div",{className:"_dsplFlx cuenta_details ",style:{},children:p("div",{className:"_dsplFlx cuenta_bx_details ",style:{width:"96%"},children:[e("div",{children:p("div",{className:"_dsplFlx ",onClick:f,children:[e("div",{className:"_asiento_item",style:{width:120},children:k(l.date)}),e("div",{className:"_asiento_item",style:{width:150},children:l.document}),e("div",{className:"_asiento_item",style:{width:300},children:l.entryName?l.entryName:"Custom"}),e("div",{className:"_asiento_item",style:{width:120,textAlign:"right"},children:(I=N(h))==null?void 0:I.toFixed(2)})]})}),e("div",{className:"flexSpace"}),e("div",{className:"_dsplFlx",children:e("div",{className:"_dsplFlx delete_icon",onClick:u,style:{marginRight:13},children:e(te,{name:"delete",size:24,color:"#b00000",tip:!0,tipMessage:"Borrar",backgroundColorTooltip:"#b00000"})})})]})})},re=({data:l,confirm:i,item:_})=>{const{modalID:h}=l||{},N=async()=>{let A={query:"deleteOperationsHRG",params:{operationId:_.operationId,businessId:n("businessId")}};const u=await H(O(),A);u&&u.data&&(ee({id:h}),i(_))};return p("div",{...h?{"dialog-key-id":h}:"",className:"pym81b sendBx upd_alert_bx",style:{background:"var(--color_backgrond_input)"},children:[e("div",{className:"login_title ",style:{margin:"1vw"},children:e("div",{children:`Borrar Asiento "${_.document}"`})}),e("div",{className:"delete_alert_t2 ",children:e("div",{children:"Una vez borrado no podras recuperarlo"})}),e("button",{className:"btn login_button btn_submit btn_small",type:"submit",autocomplete:"off",tabindex:"0","data-uia":"login-submit-button",onClick:N,children:"Borrar"})]})};export{ue as default};
