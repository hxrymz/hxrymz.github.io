import{I as U,x as Q,l as K,S as J,m as E,_ as M,u as W,z as X,r as I,y as Y,j as b,a as e,k as o,F as Z,P as k,o as G,Q as ee,t as O,q as g,g as j,w as q,O as L,A as z,v as H,C as te}from"./index.81185f1e.js";import{g as D}from"./index.ef9b372c.js";const se=U(),ae=Q(),oe=K(),ne=J(),ie=E(()=>M(()=>import("./ViewAsientosBox.84787be7.js"),["assets/ViewAsientosBox.84787be7.js","assets/index.81185f1e.js","assets/index.ed13fd6f.css"]));E(()=>M(()=>import("./ViewAsientosItem.9514e0e8.js"),["assets/ViewAsientosItem.9514e0e8.js","assets/index.81185f1e.js","assets/index.ed13fd6f.css","assets/index.ef9b372c.js"]));const le=E(()=>M(()=>import("./AddManuallyAsientos.ff9090f6.js"),["assets/AddManuallyAsientos.ff9090f6.js","assets/index.81185f1e.js","assets/index.ed13fd6f.css","assets/index.ef9b372c.js"])),me=({view:l})=>{var d,y;W(X);const[i,N]=I.exports.useState(""),[f,_]=I.exports.useState(""),[A,r]=I.exports.useState(!1),p=async()=>{let t={query:"getAllOperationsHRG",params:{businessId:o("businessId")}};const a=await O(H(),t);a&&a.data&&(g("operationsHRGlist",a.data),r(!1),_(j()))},w=async()=>{let t={query:"getAllAccountsByUserId",params:{businessId:o("businessId")}};const a=await O(H(),t);a&&a.data&&g("cuentaslist",q(a.data,"accountId"));let v={query:"getAllSubAccounts",params:{businessId:o("businessId")}};const m=await O(H(),v);m&&m.data&&(g("sub_cuentas_list",m.data),g("sub_cuentas_dict",q(m.data,"sub_accountId")))};I.exports.useEffect(()=>()=>{},[]);const s=t=>{r(!0)},c=()=>G("operationsHRGListFilter",[o("operationsHRGlist"),i,o("showAll_operationsHRG")],()=>{var T;let t="date",u=["date","entryName","amount"],a={},v=[];const C=n=>{var S,$;let B=!1;u.forEach(F=>{var x,V,P;(i==null?void 0:i.toLowerCase())&&((P=(V=(x=n==null?void 0:n[F])==null?void 0:x.toString())==null?void 0:V.toLowerCase())==null?void 0:P.indexOf(i.toLowerCase()))>=0&&(B=!0)});let R=(i==null?void 0:i.toLowerCase())&&(($=(S=n==null?void 0:n.key)==null?void 0:S.toLowerCase())==null?void 0:$.indexOf(i.toLowerCase()))>=0;if(o("showAll_operationsHRG")||B||R){let F=Math.floor(n.date/1e3),x=`${n.document}_${F}`;return a[x]||(a[x]={},v.push({document:n.document,date:n.date,entryName:n.entryName,description:n.description})),a[x][n.operationId]=n,n}},m=(n,B)=>{let R=n[t],S=B[t];return R<S?-1:R>S?1:0};return(T=o("operationsHRGlist"))==null||T.filter(C),g("groupByDocument",a),v.sort(m)});I.exports.useEffect(()=>{setTimeout(()=>{window.scrollTo(0,0),w(),p(),Y()},170)},[l]);const h=t=>{g("showAll_operationsHRG",t),_(j())};return b("div",{className:"",children:[e("div",{className:"login_title ",children:e("div",{children:"Comprobantes"})}),b("div",{className:"_dsplFlx ",children:[e("div",{className:"login_title ",children:e(ae,{lbl:"Agregar ",icon:"account",theme:"",updChanges:s})}),e("div",{className:"sendBtn _dsplFlx spaceAround ",style:{marginTop:8},children:b("div",{className:"in_stock_switch _dsplFlx",children:[e("div",{className:"in_stock_switch_btn",children:e(oe,{initvalue:o("showAll_operationsHRG"),keyCode:77,updChange:h})}),e("span",{className:"sw_rgh_span",children:"Mostrar Todas"})]})}),e("div",{className:"flexSpace"})]}),A?e(le,{close:()=>r(!1),refreshlist:p}):b(Z,{children:[e("div",{className:" _search_MrgV  ",children:o("showAll_operationsHRG")?null:e("div",{className:"years_card ",style:{marginLeft:"2vw"},children:e(ne,{updChanges:N,placeholderCode:"buscar..."})})}),k()?null:e("div",{className:"_dsplFlx  ",children:e("div",{className:"_dsplFlx cuenta_bx_details header",children:b("div",{className:"_dsplFlx ",children:[e("div",{className:"_header_item",style:{width:120},children:e("div",{children:"Fecha"})}),e("div",{className:"_header_item",style:{width:150},children:e("div",{children:"Documento"})}),e("div",{className:"_header_item",style:{width:300},children:e("div",{children:"Nombre Asiento"})}),e("div",{className:"_header_item",style:{width:120,textAlign:"left"},children:"Importe"})]})})}),e("div",{className:"operationsHRGlist",children:((d=c())==null?void 0:d.length)>0&&((y=c())==null?void 0:y.map(t=>t&&e(re,{item:t,refreshlist:p})))})]})]})},re=({item:l,refreshlist:i})=>{var w;let N=Math.floor(l.date/1e3),f=`${l.document}_${N}`;const _=s=>G("getSumAmount_"+s,[o("groupByDocument"),s],()=>{var h,d;let c=0;return(d=L(((h=o("groupByDocument"))==null?void 0:h[s])||{}))==null||d.map(y=>{var t,u,a,v,C,m;(a=(u=(t=o("groupByDocument"))==null?void 0:t[s])==null?void 0:u[y])!=null&&a.creditAccount&&(c+=((m=(C=(v=o("groupByDocument"))==null?void 0:v[s])==null?void 0:C[y])==null?void 0:m.amount)*1)}),c}),A=s=>G("getEntriesByDocument_"+s,[o("groupByDocument"),s],()=>{var h,d;let c=[];return(d=L(((h=o("groupByDocument"))==null?void 0:h[s])||{}))==null||d.map(y=>{var u,a;let t=(a=(u=o("groupByDocument"))==null?void 0:u[s])==null?void 0:a[y];t!=null&&t.debitAccount&&c.push({account:D(t.debitSubAccount),sub_acc:D(t.debitSubAccount,!0),debit:t.amount}),t!=null&&t.creditAccount&&c.push({account:D(t.creditSubAccount),sub_acc:D(t.creditSubAccount,!0),credit:t.amount})}),c}),r=()=>{g("entries2View",A(f));let s={};s.zIndex=450,s.props={item:l,minHeight:"1vh",overlay:!0},s.content=e(ie,{refreshlist:i,item:l}),z(s)},p=()=>{let s={};s.zIndex=450,s.props={minHeight:"1vh",overlay:!0},s.content=e(ce,{confirm:()=>i(),item:l,doc_date_Id:f}),z(s)};return e("div",{className:"_dsplFlx cuenta_details ",style:{},children:b("div",{className:"_dsplFlx cuenta_bx_details ",style:{width:"96%"},children:[e("div",{children:b("div",{className:"_dsplFlx ",onClick:r,children:[e("div",{className:"_asiento_item",style:{width:120},children:ee(l.date)}),e("div",{className:"_asiento_item",style:{width:150},children:l.document}),e("div",{className:"_asiento_item",style:{width:300},children:l.entryName?l.entryName:"Custom"}),e("div",{className:"_asiento_item",style:{width:120,textAlign:"right"},children:(w=_(f))==null?void 0:w.toFixed(2)})]})}),e("div",{className:"flexSpace"}),e("div",{className:"_dsplFlx",children:e("div",{className:"_dsplFlx delete_icon showOnhover",onClick:p,style:{marginRight:13},children:e(se,{name:"delete",size:24,color:"#b00000",tip:!0,tipMessage:"Borrar",backgroundColorTooltip:"#b00000"})})})]})})},ce=({data:l,confirm:i,item:N,doc_date_Id:f})=>{const{modalID:_}=l||{},A=()=>{var p;let r=L(((p=o("groupByDocument"))==null?void 0:p[f])||{});r==null||r.map(async(w,s)=>{let c={query:"deleteOperationsHRG",params:{operationId:w,businessId:o("businessId")}};const d=await O(H(),c);d&&d.data&&s===(r==null?void 0:r.length)-1&&(te({id:_}),i(N))})};return b("div",{..._?{"dialog-key-id":_}:"",className:"pym81b sendBx upd_alert_bx",style:{background:"var(--color_backgrond_input)"},children:[e("div",{className:"login_title ",style:{margin:"1vw"},children:e("div",{children:`Borrar Asiento "${N.document}"`})}),e("div",{className:"delete_alert_t2 ",children:e("div",{children:"Una vez borrado no podras recuperarlo"})}),e("button",{className:"btn login_button btn_submit btn_small",type:"submit",autocomplete:"off",tabindex:"0","data-uia":"login-submit-button",onClick:A,children:"Borrar"})]})};export{me as default};
