import{k as z,d as U,T as L,t as W,W as Y,r as C,u as h,g,j as i,a as e,b as c,O as S,H as $,p as J}from"./index.45b640e6.js";/* empty css                */import{CloseModal as Q}from"./DialogHRM.86667e02.js";/* empty css                  */const V=z();U();const A=L(),X=W(),O=Y(),a="new_cobro_comprobante",ae=({data:t,confirm:y})=>{var u,r,P,T,w,D,F;const[b,_]=C.exports.useState(!1),[I,x]=C.exports.useState(0);C.exports.useEffect(()=>{b||(_(!0),h("accountPicker",{}),x(g()))});const f=(s,l,d)=>{let n=c(a)||{};d?(n[d]||(n[d]={}),n[d][s]=l):n[s]=l,h(a,n),x(g())},o=async()=>{var E;let s=c(a),l=[];s.date||(s.date=Date.now());let d=new Date;s.comprobanteId=d.getFullYear()+""+(d.getMonth()+1)+"-"+$();let n=c("multi_pay_by_doc")&&S(c("multi_pay_by_doc"));n&&(n==null||n.map((N,j)=>{var q,M,H;let p={...s},G=c("multi_pay_by_doc")[N];p.document=N,p.account=(q=c("Acc2Pay"))==null?void 0:q.account,p.subAccount=(M=c("Acc2Pay"))==null?void 0:M.subAccount,p.type="debit",p.amount=G*1,p.payOrCollect="pay",p.operationId=g();let K={query:"addOperationsHRG",params:{businessId:(H=c("profileUser"))==null?void 0:H.businessId},form:p};l.push(K)}));let m={...s},k=ee(c("multi_pay_by_doc"));m.document=m.collectDocument,m.account=c("PaymentMethodAccount").account,m.subAccount=c("PaymentMethodAccount").subAccount,m.type="credit",m.amount=k*1,m.operationId=g();let B={query:"addOperationsHRG",params:{businessId:(E=c("profileUser"))==null?void 0:E.businessId},form:m};l.push(B);const R=l.map(async N=>{await J(N)});await Promise.all(R),t!=null&&t.modalID&&Q({id:t==null?void 0:t.modalID}),setTimeout(()=>{h("multi_pay_by_doc",null),h(a,null),x(g()),y&&y()},400)},v=(s,l)=>{h("PaymentMethodAccount",{account:s,subAccount:l})};return i("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[i("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Registrando Pago"}),e("div",{className:"flexSpace"})]}),i("div",{className:"_dsplFlx ",children:[i("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[e("div",{className:"flexSpace"}),e(X,{data:[{label:"Efectivo",id:"cash"},{label:"Tarjeta",id:"card"},{label:"Cheque",id:"check"}],active:((u=c(a))==null?void 0:u.paymentType)||"cash",updSelect:s=>f("paymentType",s)}),e("div",{className:"flexSpace"})]}),e("div",{className:"flexSpace"}),e(A,{init:(r=c(a))==null?void 0:r.collectDocument,label:"Documento de Cobro",width:200,updChanges:s=>f("collectDocument",s)})]}),((P=c(a))==null?void 0:P.paymentType)==="card"?e(O,{query:"Cred",type:(T=c(a))==null?void 0:T.paymentType,handleClick:v}):e(O,{query:"Efectivo",type:(w=c(a))==null?void 0:w.paymentType,handleClick:v}),e(A,{init:(D=c(a))==null?void 0:D.description,label:"Descripcion",width:520,updChanges:s=>f("description",s)}),i("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[i("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Documento"}),e("div",{className:"tr_bar",children:"Balance"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Por Pagar"})]}),c("toPay_by_doc")&&((F=S(c("toPay_by_doc")))==null?void 0:F.map((s,l)=>e(Z,{idKey:s,data:c("toPay_by_doc")[s]},s)))]}),i("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),e("div",{className:"card",children:e("button",{onClick:o,children:"Guardar"})})]})]})},Z=({data:t,deleteItem:y,idKey:b})=>{const[_,I]=C.exports.useState(0),x=o=>{I(o),f(t==null?void 0:t.document,o)},f=(o,v,u)=>{let r=c("multi_pay_by_doc")||{};u?(r[u]||(r[u]={}),r[u][o]=v):r[o]=v,h("multi_pay_by_doc",r)};return i("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10},children:t==null?void 0:t.document}),i("div",{className:"tr_bar",style:{marginTop:10},children:["$",((t==null?void 0:t.amount)*1).toFixed(2)]}),e("div",{className:"tr_bar",style:{marginTop:10},children:_>(t==null?void 0:t.amount)?e("div",{className:"icon",children:e(V,{name:"alert",color:"#c62828"})}):null}),e("div",{className:"tr_bar",children:e(A,{init:_,width:80,updChanges:o=>x(o)})})]})},ee=t=>{var b;let y=0;return t&&((b=S(t))==null||b.map((_,I)=>{y+=t[_]*1})),y};export{ae as default};
