import{k as z,d as U,T as L,t as Y,a1 as $,r as C,u as b,g as x,j as i,a as e,b as c,O as I,M as J,p as Q}from"./index.ff191f77.js";/* empty css                */import{CloseModal as V}from"./DialogHRM.a57a3a07.js";/* empty css                  */const W=z();U();const A=L(),X=Y(),k=$(),a="new_cobro_comprobante",ae=({data:t,confirm:u})=>{var y,r,P,T,w,D,F;const[f,_]=C.exports.useState(!1),[S,h]=C.exports.useState(0);C.exports.useEffect(()=>{f||(_(!0),b("accountPicker",{}),h(x()))});const v=(s,l,d)=>{let n=c(a)||{};d?(n[d]||(n[d]={}),n[d][s]=l):n[s]=l,b(a,n),h(x())},o=async()=>{var E;let s=c(a),l=[];s.date||(s.date=Date.now());let d=new Date;s.comprobanteId=d.getFullYear()+""+(d.getMonth()+1)+"-"+J();let n=c("multi_pay_by_doc")&&I(c("multi_pay_by_doc"));n&&(n==null||n.map((N,j)=>{var M,q,O;let p={...s},G=c("multi_pay_by_doc")[N];p.document=N,p.account=(M=c("Acc2Pay"))==null?void 0:M.account,p.subAccount=(q=c("Acc2Pay"))==null?void 0:q.subAccount,p.type="debit",p.amount=G*1,p.payOrCollect="pay",p.operationId=x();let K={query:"addOperationsHRG",params:{businessId:(O=c("profileUser"))==null?void 0:O.businessId},form:p};l.push(K)}));let m={...s},B=ee(c("multi_pay_by_doc"));m.document=m.collectDocument,m.account=c("PaymentMethodAccount").account,m.subAccount=c("PaymentMethodAccount").subAccount,m.type="credit",m.amount=B*1,m.operationId=x();let H={query:"addOperationsHRG",params:{businessId:(E=c("profileUser"))==null?void 0:E.businessId},form:m};l.push(H);const R=l.map(async N=>{await Q(N)});await Promise.all(R),t!=null&&t.modalID&&V({id:t==null?void 0:t.modalID}),setTimeout(()=>{b("multi_pay_by_doc",null),b(a,null),h(x()),u&&u()},400)},g=(s,l)=>{b("PaymentMethodAccount",{account:s,subAccount:l})};return i("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[i("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Registrando Pago"}),e("div",{className:"flexSpace"})]}),i("div",{className:"_dsplFlx ",children:[i("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[e("div",{className:"flexSpace"}),e(X,{data:[{label:"Efectivo",id:"cash"},{label:"Tarjeta",id:"card"},{label:"Cheque",id:"check"}],active:((y=c(a))==null?void 0:y.paymentType)||"cash",updSelect:s=>v("paymentType",s)}),e("div",{className:"flexSpace"})]}),e("div",{className:"flexSpace"}),e(A,{init:(r=c(a))==null?void 0:r.collectDocument,label:"Documento de Cobro",width:200,updChanges:s=>v("collectDocument",s)})]}),((P=c(a))==null?void 0:P.paymentType)==="card"?e(k,{query:"Cred",type:(T=c(a))==null?void 0:T.paymentType,handleClick:g}):e(k,{query:"Efectivo",type:(w=c(a))==null?void 0:w.paymentType,handleClick:g}),e(A,{init:(D=c(a))==null?void 0:D.description,label:"Descripcion",width:520,updChanges:s=>v("description",s)}),i("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[i("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Documento"}),e("div",{className:"tr_bar",children:"Balance"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Por Pagar"})]}),c("toPay_by_doc")&&((F=I(c("toPay_by_doc")))==null?void 0:F.map((s,l)=>e(Z,{idKey:s,data:c("toPay_by_doc")[s],updObs:h},s)))]}),i("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),e("div",{className:"card",children:e("button",{onClick:o,children:"Guardar"})})]})]})},Z=({data:t,updObs:u,idKey:f})=>{const[_,S]=C.exports.useState(0),h=o=>{S(o),v(t==null?void 0:t.document,o),u(x())},v=(o,g,y)=>{let r=c("multi_pay_by_doc")||{};y?(r[y]||(r[y]={}),r[y][o]=g):r[o]=g,b("multi_pay_by_doc",r)};return i("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10},children:t==null?void 0:t.document}),i("div",{className:"tr_bar",style:{marginTop:10},children:["$",((t==null?void 0:t.amount)*1).toFixed(2)]}),e("div",{className:"tr_bar",style:{marginTop:10},children:_>(t==null?void 0:t.amount)?e("div",{className:"icon",children:e(W,{name:"alert",color:"#c62828"})}):null}),e("div",{className:"tr_bar",children:e(A,{init:_,width:80,updChanges:o=>h(o)})})]})},ee=t=>{var f;let u=0;return t&&((f=I(t))==null||f.map((_,S)=>{u+=t[_]*1})),u};export{ae as default};
