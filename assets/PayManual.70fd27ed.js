import{S as Mc,C as Tc,T as wc,o as Oc,Y as qc,Q as Ec,r as S,u,b as m,g as c,j as o,a as e,h as I,I as Hc,i as Rc}from"./index.b7d6b41c.js";/* empty css                */import{CloseModal as Bc}from"./DialogHRM.7a3190e8.js";import{S as Gc}from"./server_fetching.338fc376.js";/* empty css                  */const jc=Mc();Tc();const f=wc(),Kc=Oc(),xc=qc(),Uc=Ec(),d="new_cobro_comprobante",Jc=({data:s,confirm:_})=>{var F,M,T,w,O,q,E,H,R,B,G,j,K,U,k,z,Y,L,Q,W,$,J,V,X,Z,cc,ec,nc,sc,oc,tc,ac,lc,ic,dc,uc,mc,rc,pc;const[N,A]=S.exports.useState(!1),[P,r]=S.exports.useState(0);S.exports.useEffect(()=>{N||(A(!0),u("PaymentMethodAccount",null),u("accountPicker",{}),r(m()))});const C=(n,a,l)=>{let t=c(d)||{};l?(t[l]||(t[l]={}),t[l][n]=a):t[n]=a,u(d,t),r(m())},y=async()=>{var yc,_c,bc,vc,Ac;let n=c(d),a=[];n.date||(n.date=Date.now());let l=new Date;n.comprobanteId=l.getFullYear()+""+(l.getMonth()+1)+"-"+Hc();let t=c("multi_pay_by_doc")&&I(c("multi_pay_by_doc"));t&&(t==null||t.map((i,g)=>{var Cc,Nc,fc;let h={...n},Dc=c("multi_pay_by_doc")[i];h.document=i,h.account=(Cc=c("Acc2Pay"))==null?void 0:Cc.account,h.subAccount=(Nc=c("Acc2Pay"))==null?void 0:Nc.subAccount,h.type="debit",h.amount=Dc*1,h.payOrCollect="pay",h.operationId=m();let Fc={query:"addOperationsHRG",params:{businessId:(fc=c("profileUser"))==null?void 0:fc.businessId},form:h};a.push(Fc)}));let p={...n},Sc=zc(c("multi_pay_by_doc"));p.document=p.collectDocument,p.account=c("PaymentMethodAccount").account;let hc=(yc=c("account_ids"))==null?void 0:yc[p.account];hc.payOrCollect&&(p.payOrCollect=hc.payOrCollect),p.subAccount=c("PaymentMethodAccount").subAccount,p.type="credit",p.amount=Sc*1,p.operationId=m();let Pc={query:"addOperationsHRG",params:{businessId:(_c=c("profileUser"))==null?void 0:_c.businessId},form:p};if(a.push(Pc),(bc=c("ComissionAccount"))!=null&&bc.account){let i={...n};i.document=n.collectDocument,i.account=c("ComissionAccount").account;let g=(vc=c("account_ids"))==null?void 0:vc[i.account];g.payOrCollect&&(i.payOrCollect=g.payOrCollect),i.subAccount=c("ComissionAccount").subAccount,i.type="debit",i.amount=c("ComissionAccount").amount*1,i.operationId=m();let h={query:"addOperationsHRG",params:{businessId:(Ac=c("profileUser"))==null?void 0:Ac.businessId},form:i};a.push(h)}const Ic=a.map(async i=>{await Rc(i)});await Promise.all(Ic),s!=null&&s.modalID&&Bc({id:s==null?void 0:s.modalID}),setTimeout(()=>{u("multi_pay_by_doc",null),u(d,null),r(m()),_&&_()},400)},x=n=>{u("ComissionAccount",null),u("PaymentMethodAccount",null),C("paymentType",n),r(m())},b=(n,a)=>{u("PaymentMethodAccount",{account:n,subAccount:a}),r(m())},v=(n,a)=>{u("ComissionAccount",{account:n,subAccount:a}),r(m())},gc=(n,a,l)=>{let t=c("ComissionAccount")||{};l?(t[l]||(t[l]={}),t[l][n]=a):t[n]=a,u("ComissionAccount",t),r(m())};let D=Gc(c("collect_by_doc"),"amount");return o("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[o("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Registrando Pago"}),e("div",{className:"flexSpace"})]}),e("div",{className:"_dsplFlx ",children:o("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[e("div",{className:"flexSpace"}),e(Kc,{data:[{label:"Cheque",id:"check"},{label:"Tarjeta",id:"card"}],active:((F=c(d))==null?void 0:F.paymentType)||"check",updSelect:n=>x(n)}),e("div",{className:"flexSpace"})]})}),((M=c(d))==null?void 0:M.paymentType)==="card"?e(xc,{query:"Cred",type:(T=c(d))==null?void 0:T.paymentType,handleClick:b}):e(xc,{query:"Efectivo",type:(w=c(d))==null?void 0:w.paymentType,handleClick:b}),o("div",{className:"_dsplFlx",children:[e("div",{className:"flexSpace"}),(O=c("PaymentMethodAccount"))!=null&&O.account?o("div",{className:" acc_dtls",children:[o("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff"},children:(H=(E=c("account_ids"))==null?void 0:E[(q=c("PaymentMethodAccount"))==null?void 0:q.account])==null?void 0:H.code}),e("div",{className:"name",children:(G=(B=c("account_ids"))==null?void 0:B[(R=c("PaymentMethodAccount"))==null?void 0:R.account])==null?void 0:G.name})]}),e("div",{className:"flexSpace"}),(j=c("PaymentMethodAccount"))!=null&&j.subAccount?o("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[e("div",{className:"code",children:(k=(U=c("sub_account_ids"))==null?void 0:U[(K=c("PaymentMethodAccount"))==null?void 0:K.subAccount])==null?void 0:k.subAccount}),e("div",{className:"name",children:(L=(Y=c("sub_account_ids"))==null?void 0:Y[(z=c("PaymentMethodAccount"))==null?void 0:z.subAccount])==null?void 0:L.subAccountName})]}):null]}):null]}),((Q=c(d))==null?void 0:Q.paymentType)==="card"&&((W=c("PaymentMethodAccount"))==null?void 0:W.account)?o("div",{className:"",children:[e("div",{className:"separator"}),($=c("ComissionAccount"))!=null&&$.account?o("div",{className:"",children:[o("div",{className:" acc_dtls",children:[o("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff"},children:(X=(V=c("account_ids"))==null?void 0:V[(J=c("ComissionAccount"))==null?void 0:J.account])==null?void 0:X.code}),e("div",{className:"name",children:(ec=(cc=c("account_ids"))==null?void 0:cc[(Z=c("ComissionAccount"))==null?void 0:Z.account])==null?void 0:ec.name})]}),e("div",{className:"flexSpace"}),(nc=c("ComissionAccount"))!=null&&nc.subAccount?o("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[e("div",{className:"code",children:(tc=(oc=c("sub_account_ids"))==null?void 0:oc[(sc=c("ComissionAccount"))==null?void 0:sc.subAccount])==null?void 0:tc.subAccount}),e("div",{className:"name",children:(ic=(lc=c("sub_account_ids"))==null?void 0:lc[(ac=c("ComissionAccount"))==null?void 0:ac.subAccount])==null?void 0:ic.subAccountName})]}):null]}),o("div",{className:"_dsplFlx",children:[e("div",{className:"flexSpace"}),e("div",{style:{maxWidth:120},children:e(f,{init:(dc=c("ComissionAccount"))==null?void 0:dc.amount,label:"comision",width:80,updChanges:n=>gc("amount",n)})}),e("div",{className:"flexSpace"})]})]}):e(Uc,{placeholder:"buscar cuenta de comision bancaria ",handleClick:v}),e("div",{className:"separator"})]}):null,o("div",{className:"_dsplFlx ",children:[e(f,{init:(uc=c(d))==null?void 0:uc.date,label:"Fecha",width:120,updChanges:n=>C("date",n)}),e("div",{className:"flexSpace"}),e(f,{init:(mc=c(d))==null?void 0:mc.collectDocument,label:"Documento de Cobro",width:200,updChanges:n=>C("collectDocument",n)})]}),e(f,{init:(rc=c(d))==null?void 0:rc.description,label:"Descripcion",width:520,updChanges:n=>C("description",n)}),D?o("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[o("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Documento"}),e("div",{className:"tr_bar",children:"Balance"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Por Pagar"})]}),D&&c("toPay_by_doc")&&((pc=I(c("toPay_by_doc")))==null?void 0:pc.map((n,a)=>e(kc,{idKey:n,data:c("toPay_by_doc")[n],updObs:r},n)))]}):null,o("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),e("div",{className:"card",children:e("button",{onClick:y,children:"Guardar"})})]})]})},kc=({data:s,updObs:_,idKey:N})=>{const[A,P]=S.exports.useState(0),r=y=>{P(y),C(s==null?void 0:s.document,y),_(m())},C=(y,x,b)=>{let v=c("multi_pay_by_doc")||{};b?(v[b]||(v[b]={}),v[b][y]=x):v[y]=x,u("multi_pay_by_doc",v)};return(s==null?void 0:s.amount)*1===0?null:o("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10},children:s==null?void 0:s.document}),o("div",{className:"tr_bar",style:{marginTop:10},children:["$",((s==null?void 0:s.amount)*1).toFixed(2)]}),e("div",{className:"tr_bar",style:{marginTop:10},children:A>(s==null?void 0:s.amount)?e("div",{className:"icon",children:e(jc,{name:"alert",color:"#c62828"})}):null}),e("div",{className:"tr_bar",children:e(f,{init:A,width:80,updChanges:y=>r(y)})})]})},zc=s=>{var N;let _=0;return s&&((N=I(s))==null||N.map((A,P)=>{_+=s[A]*1})),_};export{Jc as default};
