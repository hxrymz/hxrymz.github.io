import{k as W,d as Y,T as $,w as J,a4 as Q,r as N,u as x,g as f,j as r,a as e,b as c,O as A,W as V,p as X}from"./index.e4ecd20e.js";/* empty css                */import{CloseModal as Z}from"./DialogHRM.cdb24d33.js";/* empty css                  */const ee=W();Y();const S=$(),ce=J(),R=Q(),a="new_cobro_comprobante",ie=({data:t,confirm:u})=>{var y,d,P,w,T,D,F,O;const[v,h]=N.exports.useState(!1),[I,_]=N.exports.useState(0);N.exports.useEffect(()=>{v||(h(!0),x("accountPicker",{}),_(f()))});const b=(s,i,p)=>{let l=c(a)||{};p?(l[p]||(l[p]={}),l[p][s]=i):l[s]=i,x(a,l),_(f())},o=async()=>{var q,M;let s=c(a),i=[];s.date||(s.date=Date.now());let p=new Date;s.comprobanteId=p.getFullYear()+""+(p.getMonth()+1)+"-"+V();let l=c("multi_pay_by_doc")&&A(c("multi_pay_by_doc"));l&&(l==null||l.map((C,z)=>{var k,B,H;let m={...s},U=c("multi_pay_by_doc")[C];m.document=C,m.account=(k=c("Acc2Pay"))==null?void 0:k.account,m.subAccount=(B=c("Acc2Pay"))==null?void 0:B.subAccount,m.type="debit",m.amount=U*1,m.payOrCollect="pay",m.operationId=f();let L={query:"addOperationsHRG",params:{businessId:(H=c("profileUser"))==null?void 0:H.businessId},form:m};i.push(L)}));let n={...s},j=se(c("multi_pay_by_doc"));n.document=n.collectDocument,n.account=c("PaymentMethodAccount").account;let E=(q=c("account_ids"))==null?void 0:q[n.account];E.payOrCollect&&(n.payOrCollect=E.payOrCollect),n.subAccount=c("PaymentMethodAccount").subAccount,n.type="credit",n.amount=j*1,n.operationId=f();let G={query:"addOperationsHRG",params:{businessId:(M=c("profileUser"))==null?void 0:M.businessId},form:n};i.push(G);const K=i.map(async C=>{await X(C)});await Promise.all(K),t!=null&&t.modalID&&Z({id:t==null?void 0:t.modalID}),setTimeout(()=>{x("multi_pay_by_doc",null),x(a,null),_(f()),u&&u()},400)},g=(s,i)=>{x("PaymentMethodAccount",{account:s,subAccount:i})};return r("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[r("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Registrando Pago"}),e("div",{className:"flexSpace"})]}),e("div",{className:"_dsplFlx ",children:r("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[e("div",{className:"flexSpace"}),e(ce,{data:[{label:"Efectivo",id:"cash"},{label:"Tarjeta",id:"card"},{label:"Cheque",id:"check"}],active:((y=c(a))==null?void 0:y.paymentType)||"cash",updSelect:s=>b("paymentType",s)}),e("div",{className:"flexSpace"})]})}),((d=c(a))==null?void 0:d.paymentType)==="card"?e(R,{query:"Cred",type:(P=c(a))==null?void 0:P.paymentType,handleClick:g}):e(R,{query:"Efectivo",type:(w=c(a))==null?void 0:w.paymentType,handleClick:g}),r("div",{className:"_dsplFlx ",children:[e(S,{init:(T=c(a))==null?void 0:T.date,label:"Fecha",width:120,updChanges:s=>b("date",s)}),e("div",{className:"flexSpace"}),e(S,{init:(D=c(a))==null?void 0:D.collectDocument,label:"Documento de Cobro",width:200,updChanges:s=>b("collectDocument",s)})]}),e(S,{init:(F=c(a))==null?void 0:F.description,label:"Descripcion",width:520,updChanges:s=>b("description",s)}),r("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[r("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Documento"}),e("div",{className:"tr_bar",children:"Balance"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Por Pagar"})]}),c("toPay_by_doc")&&((O=A(c("toPay_by_doc")))==null?void 0:O.map((s,i)=>e(te,{idKey:s,data:c("toPay_by_doc")[s],updObs:_},s)))]}),r("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),e("div",{className:"card",children:e("button",{onClick:o,children:"Guardar"})})]})]})},te=({data:t,updObs:u,idKey:v})=>{const[h,I]=N.exports.useState(0),_=o=>{I(o),b(t==null?void 0:t.document,o),u(f())},b=(o,g,y)=>{let d=c("multi_pay_by_doc")||{};y?(d[y]||(d[y]={}),d[y][o]=g):d[o]=g,x("multi_pay_by_doc",d)};return r("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10},children:t==null?void 0:t.document}),r("div",{className:"tr_bar",style:{marginTop:10},children:["$",((t==null?void 0:t.amount)*1).toFixed(2)]}),e("div",{className:"tr_bar",style:{marginTop:10},children:h>(t==null?void 0:t.amount)?e("div",{className:"icon",children:e(ee,{name:"alert",color:"#c62828"})}):null}),e("div",{className:"tr_bar",children:e(S,{init:h,width:80,updChanges:o=>_(o)})})]})},se=t=>{var v;let u=0;return t&&((v=A(t))==null||v.map((h,I)=>{u+=t[h]*1})),u};export{ie as default};
