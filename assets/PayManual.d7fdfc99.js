import{S as wc,C as Oc,T as qc,o as Ec,K as Hc,M as Rc,r as P,u as r,b as p,g as c,j as s,a as e,h as I,L as Bc,i as Gc}from"./index.d7d73e67.js";/* empty css               */import{CloseModal as Kc}from"./DialogHRM.96df4305.js";import{S as jc}from"./server_fetching.71484e72.js";/* empty css                  */const Uc=wc();Oc();const f=qc(),kc=Ec(),Pc=Hc(),zc=Rc(),d="new_cobro_comprobante",Xc=({data:o,confirm:_})=>{var F,M,T,w,O,q,E,H,R,B,G,K,j,U,k,z,L,W,Y,$,J,Q,V,X,Z,cc,ec,nc,oc,sc,tc,ac,lc,ic,dc,uc,mc,rc,pc;const[N,A]=P.exports.useState(!1),[S,h]=P.exports.useState(0);P.exports.useEffect(()=>{N||(A(!0),r("PaymentMethodAccount",null),r("accountPicker",{}),h(p()))});const C=(n,a,l)=>{let t=c(d)||{};l?(t[l]||(t[l]={}),t[l][n]=a):t[n]=a,r(d,t),h(p())},y=async()=>{var yc,_c,bc,vc,Ac,Cc;let n=c(d),a=[];n.date?n.date=new Date(n.date).getTime():n.date=Date.now();let l=new Date;n.comprobanteId=l.getFullYear()+""+(l.getMonth()+1)+"-"+Bc();let t=c("multi_pay_by_doc")&&I(c("multi_pay_by_doc"));if(t&&(t==null||t.map((i,g)=>{var Nc,fc,xc,gc;let m={...n},Mc=c("multi_pay_by_doc")[i];m.document=i,m.account=(Nc=c("Acc2Pay"))==null?void 0:Nc.account,m.subAccount=(fc=c("Acc2Pay"))==null?void 0:fc.subAccount,m.providerId=(xc=c("Acc2Pay"))==null?void 0:xc.providerId,m.type="debit",m.amount=Mc*1,m.payOrCollect="pay",m.operationId=p();let Tc={query:"addOperationsHRG",params:{businessId:(gc=c("profileUser"))==null?void 0:gc.businessId},form:m};a.push(Tc)})),(yc=c("ComissionAccount"))!=null&&yc.account){let i={...n};i.document=n.collectDocument,i.account=c("ComissionAccount").account;let g=(_c=c("account_ids"))==null?void 0:_c[i.account];g.payOrCollect&&(i.payOrCollect=g.payOrCollect),i.subAccount=c("ComissionAccount").subAccount,i.type="debit",i.amount=c("ComissionAccount").amount*1,i.operationId=p();let m={query:"addOperationsHRG",params:{businessId:(bc=c("profileUser"))==null?void 0:bc.businessId},form:i};a.push(m)}let u={...n},Ic=Wc(c("multi_pay_by_doc"));u.document=u.collectDocument,u.account=c("PaymentMethodAccount").account;let hc=(vc=c("account_ids"))==null?void 0:vc[u.account];hc.payOrCollect&&(u.payOrCollect=hc.payOrCollect),u.subAccount=c("PaymentMethodAccount").subAccount,u.type="credit",u.amount=Ic*1,(Ac=c("ComissionAccount"))!=null&&Ac.amount&&(u.amount+=c("ComissionAccount").amount*1),u.operationId=p();let Dc={query:"addOperationsHRG",params:{businessId:(Cc=c("profileUser"))==null?void 0:Cc.businessId},form:u};a.push(Dc);const Fc=a.map(async i=>{await Gc(i)});await Promise.all(Fc),o!=null&&o.modalID&&Kc({id:o==null?void 0:o.modalID}),setTimeout(()=>{r("multi_pay_by_doc",null),r(d,null),h(p()),_&&_()},400)},x=n=>{r("ComissionAccount",null),r("PaymentMethodAccount",null),C("paymentType",n),h(p())},b=(n,a)=>{r("PaymentMethodAccount",{account:n,subAccount:a}),h(p())},v=(n,a)=>{r("ComissionAccount",{account:n,subAccount:a}),h(p())},Sc=(n,a,l)=>{let t=c("ComissionAccount")||{};l?(t[l]||(t[l]={}),t[l][n]=a):t[n]=a,r("ComissionAccount",t),h(p())};let D=jc(c("toPay_by_doc"),"amount");return s("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[s("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Registrando Pago"}),e("div",{className:"flexSpace"})]}),e("div",{className:"_dsplFlx ",children:s("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[e("div",{className:"flexSpace"}),e(kc,{data:[{label:"Cheque",id:"check"},{label:"Tarjeta",id:"card"}],active:((F=c(d))==null?void 0:F.paymentType)||"check",updSelect:n=>x(n)}),e("div",{className:"flexSpace"})]})}),((M=c(d))==null?void 0:M.paymentType)==="card"?e(Pc,{query:"Cred",type:(T=c(d))==null?void 0:T.paymentType,handleClick:b}):e(Pc,{query:"Efectivo",type:(w=c(d))==null?void 0:w.paymentType,handleClick:b}),s("div",{className:"_dsplFlx",children:[e("div",{className:"flexSpace"}),(O=c("PaymentMethodAccount"))!=null&&O.account?s("div",{className:" acc_dtls",children:[s("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff"},children:(H=(E=c("account_ids"))==null?void 0:E[(q=c("PaymentMethodAccount"))==null?void 0:q.account])==null?void 0:H.code}),e("div",{className:"name",children:(G=(B=c("account_ids"))==null?void 0:B[(R=c("PaymentMethodAccount"))==null?void 0:R.account])==null?void 0:G.name})]}),e("div",{className:"flexSpace"}),(K=c("PaymentMethodAccount"))!=null&&K.subAccount?s("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[e("div",{className:"code",children:(k=(U=c("sub_account_ids"))==null?void 0:U[(j=c("PaymentMethodAccount"))==null?void 0:j.subAccount])==null?void 0:k.subAccount}),e("div",{className:"name",children:(W=(L=c("sub_account_ids"))==null?void 0:L[(z=c("PaymentMethodAccount"))==null?void 0:z.subAccount])==null?void 0:W.subAccountName})]}):null]}):null]}),((Y=c(d))==null?void 0:Y.paymentType)==="card"&&(($=c("PaymentMethodAccount"))==null?void 0:$.account)?s("div",{className:"",children:[e("div",{className:"separator"}),(J=c("ComissionAccount"))!=null&&J.account?s("div",{className:"",children:[s("div",{className:" acc_dtls",children:[s("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff"},children:(X=(V=c("account_ids"))==null?void 0:V[(Q=c("ComissionAccount"))==null?void 0:Q.account])==null?void 0:X.code}),e("div",{className:"name",children:(ec=(cc=c("account_ids"))==null?void 0:cc[(Z=c("ComissionAccount"))==null?void 0:Z.account])==null?void 0:ec.name})]}),e("div",{className:"flexSpace"}),(nc=c("ComissionAccount"))!=null&&nc.subAccount?s("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[e("div",{className:"code",children:(tc=(sc=c("sub_account_ids"))==null?void 0:sc[(oc=c("ComissionAccount"))==null?void 0:oc.subAccount])==null?void 0:tc.subAccount}),e("div",{className:"name",children:(ic=(lc=c("sub_account_ids"))==null?void 0:lc[(ac=c("ComissionAccount"))==null?void 0:ac.subAccount])==null?void 0:ic.subAccountName})]}):null]}),s("div",{className:"_dsplFlx",children:[e("div",{className:"flexSpace"}),e("div",{style:{maxWidth:120},children:e(f,{init:(dc=c("ComissionAccount"))==null?void 0:dc.amount,label:"comision",width:80,updChanges:n=>Sc("amount",n)})}),e("div",{className:"flexSpace"})]})]}):e(zc,{placeholder:"buscar cuenta de comision bancaria ",handleClick:v}),e("div",{className:"separator"})]}):null,s("div",{className:"_dsplFlx ",children:[e(f,{init:(uc=c(d))==null?void 0:uc.date,label:"Fecha",width:120,updChanges:n=>C("date",n)}),e("div",{className:"flexSpace"}),e(f,{init:(mc=c(d))==null?void 0:mc.collectDocument,label:"Documento de Cobro",width:200,updChanges:n=>C("collectDocument",n)})]}),e(f,{init:(rc=c(d))==null?void 0:rc.description,label:"Descripcion",width:520,updChanges:n=>C("description",n)}),D?s("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[s("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Documento"}),e("div",{className:"tr_bar",children:"Balance"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Por Pagar"})]}),D&&c("toPay_by_doc")&&((pc=I(c("toPay_by_doc")))==null?void 0:pc.map((n,a)=>e(Lc,{idKey:n,data:c("toPay_by_doc")[n],updObs:h},n)))]}):null,s("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),e("div",{className:"card",children:e("button",{onClick:y,children:"Guardar"})})]})]})},Lc=({data:o,updObs:_,idKey:N})=>{const[A,S]=P.exports.useState(0),h=y=>{S(y),C(o==null?void 0:o.document,y),_(p())},C=(y,x,b)=>{let v=c("multi_pay_by_doc")||{};b?(v[b]||(v[b]={}),v[b][y]=x):v[y]=x,r("multi_pay_by_doc",v)};return(o==null?void 0:o.amount)*1===0?null:s("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10},children:o==null?void 0:o.document}),s("div",{className:"tr_bar",style:{marginTop:10},children:["$",((o==null?void 0:o.amount)*1).toFixed(2)]}),e("div",{className:"tr_bar",style:{marginTop:10},children:A>(o==null?void 0:o.amount)?e("div",{className:"icon",children:e(Uc,{name:"alert",color:"#c62828"})}):null}),e("div",{className:"tr_bar",children:e(f,{init:A,width:80,updChanges:y=>h(y)})})]})},Wc=o=>{var N;let _=0;return o&&((N=I(o))==null||N.map((A,S)=>{_+=o[A]*1})),_};export{Xc as default};
