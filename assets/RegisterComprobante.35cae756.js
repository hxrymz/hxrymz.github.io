import{S as R,C as j,T as k,E as q,a3 as G,r as I,u as x,b as F,g as a,j as p,a as e,h as E,M as K,i as U}from"./index.d92c6cda.js";/* empty css                */import{CloseModal as W}from"./DialogHRM.05c7f368.js";/* empty css                  */R();j();const w=k(),B=q(),Y=G(),i="entry_operation_comprobante",ee=({data:t,confirm:o,item:l})=>{var g,v,u,C,h,m,T;const[N,S]=I.exports.useState(!1),[c,r]=I.exports.useState(0);I.exports.useEffect(()=>{if(!N){S(!0),x("accountPicker",{}),n("description",l.name);let s=l.accountsToParameterize;x("multi_params",s),r(F())}});const n=(s,f,b)=>{let _=a(i)||{};b?(_[b]||(_[b]={}),_[b][s]=f):_[s]=f,x(i,_),r(F())},A=async()=>{var O;let s={...a(i)};s.date?s.date=new Date(s.date).getTime():s.date=Date.now();let f=new Date;s.comprobanteId=f.getFullYear()+""+(f.getMonth()+1)+"-"+K();let b=[];a("multi_params")&&((O=E(a("multi_params")))==null||O.map(async(D,H)=>{var P,z;let y=a("multi_params")[D];if(!isNaN(y.amount*1)&&y.amount*1>0){let d={...s};d.type="debit",d.account=y.account,d.subAccount=y.subAccount,d.type=y.type,d.amount=y.amount*1,d.operationId=F();let M=(P=a("account_ids"))==null?void 0:P[y.account];M.payOrCollect&&(d.payOrCollect=M.payOrCollect);let L={query:"addOperationsHRG",params:{businessId:(z=a("profileUser"))==null?void 0:z.businessId},form:d};b.push(L)}}));const _=b.map(async D=>{await U(D)});await Promise.all(_),t!=null&&t.modalID&&W({id:t==null?void 0:t.modalID}),setTimeout(()=>{x("multi_params",null),x(i,null),r(F()),o&&o()},400)};return p("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[p("div",{className:"_dsplFlx ",children:[e("p",{className:"form_title",children:"Asiento Manual"}),e("div",{className:"flexSpace"})]}),p("div",{className:"_dsplFlx ",children:[e(w,{init:(g=a(i))==null?void 0:g.date,label:"Fecha",width:120,updChanges:s=>n("date",s)}),e("div",{className:"flexSpace"}),e(w,{init:(v=a(i))==null?void 0:v.document,label:"Documento",width:120,updChanges:s=>n("document",s)})]}),e(w,{init:(u=a(i))==null?void 0:u.description,label:"Descripcion",width:520,updChanges:s=>n("description",s)}),(l==null?void 0:l.extra)==="employee"?e("div",{style:{margin:"18px 0"},children:(C=a(i))!=null&&C.employeeId?e("div",{className:" acc_dtls",children:p("div",{className:"_dsplFlx",children:[e("div",{className:"code",style:{color:"#646cff",cursor:"pointer"},onClick:()=>n("employeeId",null),children:"Empleado"}),e("div",{className:"name",children:(h=a("employees_ids")[a(i).employeeId])==null?void 0:h.name})]})}):e(Y,{width:420,handleClick:s=>n("employeeId",s)})}):null,p("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[p("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[e("div",{className:"tr_bar",children:"Cuenta"}),e("div",{className:"tr_bar",children:"Sub Cuenta"}),e("div",{className:"tr_bar"}),e("div",{className:"tr_bar",children:"Importe"})]}),a("multi_params")&&((m=E(a("multi_params")))==null?void 0:m.map((s,f)=>e(J,{idKey:s,data:a("multi_params")[s],updObs:r},s)))]}),p("div",{className:"_dsplFlx ",children:[e("div",{className:"flexSpace"}),((T=a(i))==null?void 0:T.document)&&Q(a("multi_params"))?e("div",{className:"card",children:e("button",{className:"group_title addBtn purple",onClick:A,children:"Guardar"})}):null]})]})},J=({data:t,updObs:o,idKey:l})=>{var g,v;const[N,S]=I.exports.useState(0),c=u=>{r("amount",u,l),o(F())},r=(u,C,h)=>{let m=a("multi_params")||{};h?(m[h]||(m[h]={}),m[h][u]=C):m[u]=C,x("multi_params",m)};let n=(g=a("account_ids"))==null?void 0:g[t==null?void 0:t.account],A=(v=a("sub_account_ids"))==null?void 0:v[t==null?void 0:t.subAccount];return p("div",{className:"_dsplFlx hdr_bar",children:[e("div",{className:"tr_bar",style:{marginTop:10,fontWeight:600,color:t.type==="debit"?"#009688":"#c62828"},children:e(B,{data:n,color:t.type==="debit"?"#009688":"#c62828",labelField:"code",infoField:"name"})}),e("div",{className:"tr_bar",style:{marginTop:10},children:e(B,{data:A,color:t.type==="debit"?"#009688":"#c62828",labelField:"subAccount",infoField:"subAccountName"})}),e("div",{className:"tr_bar",style:{marginTop:10}}),e("div",{className:"tr_bar",children:e(w,{init:N,type:"number",width:80,init:t==null?void 0:t.amount,updChanges:c})})]})},Q=t=>{let o=0,l=t&&E(t);return l&&(l==null||l.map((N,S)=>{let c=t[N],r=o.toFixed(2);o=(c!=null&&c.amount?(c==null?void 0:c.type)==="debit"?parseFloat(c.amount):parseFloat(c.amount)*-1:0)+parseFloat(r)})),l&&(l==null?void 0:l.length)>0&&o===0};export{ee as default};
