import{k as L,d as M,T as R,Q as j,r as F,u as g,g as C,b as a,j as h,a as s,O as D,W as q,p as G}from"./index.77dade03.js";/* empty css                */import{CloseModal as K}from"./DialogHRM.f69351dd.js";/* empty css                  */L();M();const I=R(),P=j(),r="entry_operation_comprobante",X=({data:t,confirm:n,item:l})=>{var y,N,u,v,p;const[x,w]=F.exports.useState(!1),[i,c]=F.exports.useState(0);F.exports.useEffect(()=>{if(!x){w(!0),g("accountPicker",{}),m("description",l.name);let e=l.accountsToParameterize;g("multi_params",e),c(C())}});const m=(e,f,d)=>{let b=a(r)||{};d?(b[d]||(b[d]={}),b[d][e]=f):b[e]=f,g(r,b),c(C())},A=async()=>{var T;let e={...a(r)};e.date||(e.date=Date.now());let f=new Date;e.comprobanteId=f.getFullYear()+""+(f.getMonth()+1)+"-"+q();let d=[];a("multi_params")&&((T=D(a("multi_params")))==null||T.map(async(S,B)=>{var O,E;let _=a("multi_params")[S];if(!isNaN(_.amount*1)&&_.amount*1>0){let o={...e};o.type="debit",o.account=_.account,o.subAccount=_.subAccount,o.type=_.type,o.amount=_.amount*1,o.operationId=C();let z=(O=a("account_ids"))==null?void 0:O[_.account];z.payOrCollect&&(o.payOrCollect=z.payOrCollect);let H={query:"addOperationsHRG",params:{businessId:(E=a("profileUser"))==null?void 0:E.businessId},form:o};d.push(H)}}));const b=d.map(async S=>{await G(S)});await Promise.all(b),t!=null&&t.modalID&&K({id:t==null?void 0:t.modalID}),setTimeout(()=>{g("multi_params",null),g(r,null),c(C()),n&&n()},400)};return h("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[h("div",{className:"_dsplFlx ",children:[s("p",{className:"form_title",children:"Asiento Manual"}),s("div",{className:"flexSpace"})]}),h("div",{className:"_dsplFlx ",children:[s(I,{init:(y=a(r))==null?void 0:y.date,label:"Fecha",width:120,updChanges:e=>m("date",e)}),s("div",{className:"flexSpace"}),s(I,{init:(N=a(r))==null?void 0:N.document,label:"Documento",width:120,updChanges:e=>m("document",e)})]}),s(I,{init:(u=a(r))==null?void 0:u.description,label:"Descripcion",width:520,updChanges:e=>m("description",e)}),h("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[h("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[s("div",{className:"tr_bar",children:"Cuenta"}),s("div",{className:"tr_bar",children:"Sub Cuenta"}),s("div",{className:"tr_bar"}),s("div",{className:"tr_bar",children:"Importe"})]}),a("multi_params")&&((v=D(a("multi_params")))==null?void 0:v.map((e,f)=>s(W,{idKey:e,data:a("multi_params")[e],updObs:c},e)))]}),h("div",{className:"_dsplFlx ",children:[s("div",{className:"flexSpace"}),((p=a(r))==null?void 0:p.document)&&Q(a("multi_params"))?s("div",{className:"card",children:s("button",{className:"group_title addBtn purple",onClick:A,children:"Guardar"})}):null]})]})},W=({data:t,updObs:n,idKey:l})=>{var y,N;const[x,w]=F.exports.useState(0),i=u=>{c("amount",u,l),n(C())},c=(u,v,p)=>{let e=a("multi_params")||{};p?(e[p]||(e[p]={}),e[p][u]=v):e[u]=v,g("multi_params",e)};let m=(y=a("account_ids"))==null?void 0:y[t==null?void 0:t.account],A=(N=a("sub_account_ids"))==null?void 0:N[t==null?void 0:t.subAccount];return h("div",{className:"_dsplFlx hdr_bar",children:[s("div",{className:"tr_bar",style:{marginTop:10,fontWeight:600,color:t.type==="debit"?"#009688":"#c62828"},children:s(P,{data:m,color:t.type==="debit"?"#009688":"#c62828",labelField:"code",infoField:"name"})}),s("div",{className:"tr_bar",style:{marginTop:10},children:s(P,{data:A,color:t.type==="debit"?"#009688":"#c62828",labelField:"subAccount",infoField:"subAccountName"})}),s("div",{className:"tr_bar",style:{marginTop:10}}),s("div",{className:"tr_bar",children:s(I,{init:x,type:"number",width:80,init:t==null?void 0:t.amount,updChanges:i})})]})},Q=t=>{let n=0,l=t&&D(t);return l&&(l==null||l.map((x,w)=>{let i=t[x],c=n.toFixed(2);n=(i!=null&&i.amount?(i==null?void 0:i.type)==="debit"?parseFloat(i.amount):parseFloat(i.amount)*-1:0)+parseFloat(c)})),l&&(l==null?void 0:l.length)>0&&n===0};export{X as default};
