import{S as L,C as M,T as R,H as j,r as F,u as g,b as C,g as a,j as _,a as s,h as D,I as q,i as G}from"./index.b7d6b41c.js";/* empty css                */import{CloseModal as K}from"./DialogHRM.7a3190e8.js";/* empty css                  */L();M();const I=R(),H=j(),r="entry_operation_comprobante",X=({data:t,confirm:n,item:i})=>{var y,N,u,v,p;const[x,S]=F.exports.useState(!1),[l,c]=F.exports.useState(0);F.exports.useEffect(()=>{if(!x){S(!0),g("accountPicker",{}),m("description",i.name);let e=i.accountsToParameterize;g("multi_params",e),c(C())}});const m=(e,f,d)=>{let b=a(r)||{};d?(b[d]||(b[d]={}),b[d][e]=f):b[e]=f,g(r,b),c(C())},w=async()=>{var T;let e={...a(r)};e.date||(e.date=Date.now());let f=new Date;e.comprobanteId=f.getFullYear()+""+(f.getMonth()+1)+"-"+q();let d=[];a("multi_params")&&((T=D(a("multi_params")))==null||T.map(async(A,P)=>{var E,O;let h=a("multi_params")[A];if(!isNaN(h.amount*1)&&h.amount*1>0){let o={...e};o.type="debit",o.account=h.account,o.subAccount=h.subAccount,o.type=h.type,o.amount=h.amount*1,o.operationId=C();let z=(E=a("account_ids"))==null?void 0:E[h.account];z.payOrCollect&&(o.payOrCollect=z.payOrCollect);let B={query:"addOperationsHRG",params:{businessId:(O=a("profileUser"))==null?void 0:O.businessId},form:o};d.push(B)}}));const b=d.map(async A=>{await G(A)});await Promise.all(b),t!=null&&t.modalID&&K({id:t==null?void 0:t.modalID}),setTimeout(()=>{g("multi_params",null),g(r,null),c(C()),n&&n()},400)};return _("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[_("div",{className:"_dsplFlx ",children:[s("p",{className:"form_title",children:"Asiento Manual"}),s("div",{className:"flexSpace"})]}),_("div",{className:"_dsplFlx ",children:[s(I,{init:(y=a(r))==null?void 0:y.date,label:"Fecha",width:120,updChanges:e=>m("date",e)}),s("div",{className:"flexSpace"}),s(I,{init:(N=a(r))==null?void 0:N.document,label:"Documento",width:120,updChanges:e=>m("document",e)})]}),s(I,{init:(u=a(r))==null?void 0:u.description,label:"Descripcion",width:520,updChanges:e=>m("description",e)}),_("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[_("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[s("div",{className:"tr_bar",children:"Cuenta"}),s("div",{className:"tr_bar",children:"Sub Cuenta"}),s("div",{className:"tr_bar"}),s("div",{className:"tr_bar",children:"Importe"})]}),a("multi_params")&&((v=D(a("multi_params")))==null?void 0:v.map((e,f)=>s(U,{idKey:e,data:a("multi_params")[e],updObs:c},e)))]}),_("div",{className:"_dsplFlx ",children:[s("div",{className:"flexSpace"}),((p=a(r))==null?void 0:p.document)&&W(a("multi_params"))?s("div",{className:"card",children:s("button",{className:"group_title addBtn purple",onClick:w,children:"Guardar"})}):null]})]})},U=({data:t,updObs:n,idKey:i})=>{var y,N;const[x,S]=F.exports.useState(0),l=u=>{c("amount",u,i),n(C())},c=(u,v,p)=>{let e=a("multi_params")||{};p?(e[p]||(e[p]={}),e[p][u]=v):e[u]=v,g("multi_params",e)};let m=(y=a("account_ids"))==null?void 0:y[t==null?void 0:t.account],w=(N=a("sub_account_ids"))==null?void 0:N[t==null?void 0:t.subAccount];return _("div",{className:"_dsplFlx hdr_bar",children:[s("div",{className:"tr_bar",style:{marginTop:10,fontWeight:600,color:t.type==="debit"?"#009688":"#c62828"},children:s(H,{data:m,color:t.type==="debit"?"#009688":"#c62828",labelField:"code",infoField:"name"})}),s("div",{className:"tr_bar",style:{marginTop:10},children:s(H,{data:w,color:t.type==="debit"?"#009688":"#c62828",labelField:"subAccount",infoField:"subAccountName"})}),s("div",{className:"tr_bar",style:{marginTop:10}}),s("div",{className:"tr_bar",children:s(I,{init:x,type:"number",width:80,init:t==null?void 0:t.amount,updChanges:l})})]})},W=t=>{let n=0,i=t&&D(t);return i&&(i==null||i.map((x,S)=>{let l=t[x],c=n.toFixed(2);n=(l!=null&&l.amount?(l==null?void 0:l.type)==="debit"?parseFloat(l.amount):parseFloat(l.amount)*-1:0)+parseFloat(c)})),i&&(i==null?void 0:i.length)>0&&n===0};export{X as default};
