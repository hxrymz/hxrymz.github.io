import{k as M,d as R,T as j,r as S,u as f,g as I,b as i,j as h,a as s,O as T,H as q,p as B}from"./index.26c96b50.js";/* empty css                */import{CloseModal as G}from"./DialogHRM.e989df6d.js";/* empty css                  */M();R();const w=j(),o="entry_operation_comprobante",Q=({data:t,confirm:n,item:l})=>{var y,v,m,N,p;const[g,A]=S.exports.useState(!1),[a,_]=S.exports.useState(0);S.exports.useEffect(()=>{if(!g){A(!0),f("accountPicker",{}),r("description",l.name);let e=l.accountsToParameterize;f("multi_params",e),_(I())}});const r=(e,b,u)=>{let d=i(o)||{};u?(d[u]||(d[u]={}),d[u][e]=b):d[e]=b,f(o,d),_(I())},x=async()=>{var O;let e={...i(o)};e.date||(e.date=Date.now());let b=new Date;e.comprobanteId=b.getFullYear()+""+(b.getMonth()+1)+"-"+q();let u=[];i("multi_params")&&((O=T(i("multi_params")))==null||O.map(async(F,H)=>{var D,z;let c={...e},C=i("multi_params")[F];c.type="debit",c.account=C.account,c.subAccount=C.subAccount,c.type=C.type,c.amount=C.amount*1,c.operationId=I();let E=(D=i("account_ids"))==null?void 0:D[C.account];E.payOrCollect&&(c.payOrCollect=E.payOrCollect);let P={query:"addOperationsHRG",params:{businessId:(z=i("profileUser"))==null?void 0:z.businessId},form:c};u.push(P)}));const d=u.map(async F=>{await B(F)});await Promise.all(d),t!=null&&t.modalID&&G({id:t==null?void 0:t.modalID}),setTimeout(()=>{f("multi_params",null),f(o,null),_(I()),n&&n()},400)};return h("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[h("div",{className:"_dsplFlx ",children:[s("p",{className:"form_title",children:"Asiento Manual"}),s("div",{className:"flexSpace"})]}),h("div",{className:"_dsplFlx ",children:[s(w,{init:(y=i(o))==null?void 0:y.date,label:"Fecha",width:120,updChanges:e=>r("date",e)}),s("div",{className:"flexSpace"}),s(w,{init:(v=i(o))==null?void 0:v.document,label:"Documento",width:120,updChanges:e=>r("document",e)})]}),s(w,{init:(m=i(o))==null?void 0:m.description,label:"Descripcion",width:520,updChanges:e=>r("description",e)}),h("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[h("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[s("div",{className:"tr_bar",children:"Cuenta"}),s("div",{className:"tr_bar",children:"Sub Cuenta"}),s("div",{className:"tr_bar"}),s("div",{className:"tr_bar",children:"Importe"})]}),i("multi_params")&&((N=T(i("multi_params")))==null?void 0:N.map((e,b)=>s(K,{idKey:e,data:i("multi_params")[e],updObs:_},e)))]}),h("div",{className:"_dsplFlx ",children:[s("div",{className:"flexSpace"}),((p=i(o))==null?void 0:p.document)&&L(i("multi_params"))?s("div",{className:"card",children:s("button",{className:"group_title addBtn purple",onClick:x,children:"Guardar"})}):null]})]})},K=({data:t,updObs:n,idKey:l})=>{var y,v;const[g,A]=S.exports.useState(0),a=m=>{_("amount",m,l),n(I())},_=(m,N,p)=>{let e=i("multi_params")||{};p?(e[p]||(e[p]={}),e[p][m]=N):e[m]=N,f("multi_params",e)};let r=(y=i("account_ids"))==null?void 0:y[t==null?void 0:t.account],x=(v=i("sub_account_ids"))==null?void 0:v[t==null?void 0:t.subAccount];return h("div",{className:"_dsplFlx hdr_bar",children:[s("div",{className:"tr_bar",style:{marginTop:10,fontWeight:600,color:t.type==="debit"?"#009688":"#c62828"},children:r==null?void 0:r.code}),s("div",{className:"tr_bar",style:{marginTop:10},children:x==null?void 0:x.subAccount}),s("div",{className:"tr_bar",style:{marginTop:10}}),s("div",{className:"tr_bar",children:s(w,{init:g,width:80,init:t==null?void 0:t.amount,updChanges:a})})]})},L=t=>{let n=0,l=t&&T(t);return l&&(l==null||l.map((g,A)=>{let a=t[g];(a==null?void 0:a.type)==="debit"?n+=(a==null?void 0:a.amount)*1:(a==null?void 0:a.type)==="credit"&&(n-=(a==null?void 0:a.amount)*1)})),l&&(l==null?void 0:l.length)>0&&n===0};export{Q as default};
