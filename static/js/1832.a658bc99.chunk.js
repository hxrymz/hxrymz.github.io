"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[1832],{1832:(o,c,e)=>{e.r(c),e.d(c,{default:()=>y});var l=e(2791),a=e(2350),n=e(2647),d=(e(6021),e(9760)),i=e(9179),t=e(1232),s=e(24),u=e(184);const r=(0,n.PU)(),v=(0,s.f_)(),b=(0,n.Np)(),m=(0,n.tL)(),h=(0,i.NC)(),p=(0,i.a)(),_="new_cobro_comprobante",y=o=>{var c,e,n,i,s,r,y,A,N,f,C,I,P,M,g,R,z,w,D,F,S,k,T,O,U,Q,Z,q,E,G,H,K,$,B,L,V,W,Y,J;let{data:X,confirm:oo}=o;const[co,eo]=(0,l.useState)(!1),[lo,ao]=(0,l.useState)(0);(0,l.useEffect)((()=>{co||(eo(!0),(0,a.Rz)("PaymentMethodAccount",null),(0,a.Rz)("accountPicker",{}),ao((0,a.M5)()))}));const no=(o,c,e)=>{let l=(0,a.bh)(_)||{};e?(l[e]||(l[e]={}),l[e][o]=c):l[o]=c,(0,a.Rz)(_,l),ao((0,a.M5)())},io=(o,c)=>{let e={account:o,subAccount:c};(0,a.Rz)("PaymentMethodAccount",e),ao((0,a.M5)())};let to=(0,t.GP)((0,a.bh)("toPay_by_doc"),"amount");return(0,u.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"560px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)("p",{className:"form_title",children:"Registrando Pago"}),(0,u.jsx)("div",{className:"flexSpace"})]}),(0,u.jsx)("div",{className:"_dsplFlx ",children:(0,u.jsxs)("div",{className:"_dsplFlx ",style:{padding:"35px 18px 10px "},children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)(m,{data:[{label:"Cheque",id:"check"},{label:"Tarjeta",id:"card"}],active:(null===(c=(0,a.bh)(_))||void 0===c?void 0:c.paymentType)||"check",updSelect:o=>(o=>{(0,a.Rz)("ComissionAccount",null),(0,a.Rz)("PaymentMethodAccount",null),no("paymentType",o),ao((0,a.M5)())})(o)}),(0,u.jsx)("div",{className:"flexSpace"})]})}),"card"===(null===(e=(0,a.bh)(_))||void 0===e?void 0:e.paymentType)?(0,u.jsx)(h,{query:"Cred",type:null===(n=(0,a.bh)(_))||void 0===n?void 0:n.paymentType,handleClick:io}):(0,u.jsx)(h,{query:"Efectivo",type:null===(i=(0,a.bh)(_))||void 0===i?void 0:i.paymentType,handleClick:io}),(0,u.jsxs)("div",{className:"_dsplFlx",children:[(0,u.jsx)("div",{className:"flexSpace"}),null!==(s=(0,a.bh)("PaymentMethodAccount"))&&void 0!==s&&s.account?(0,u.jsxs)("div",{className:" acc_dtls",children:[(0,u.jsxs)("div",{className:"_dsplFlx",children:[(0,u.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===(r=(0,a.bh)("account_ids"))||void 0===r||null===(y=r[null===(A=(0,a.bh)("PaymentMethodAccount"))||void 0===A?void 0:A.account])||void 0===y?void 0:y.code}),(0,u.jsx)("div",{className:"name",children:null===(N=(0,a.bh)("account_ids"))||void 0===N||null===(f=N[null===(C=(0,a.bh)("PaymentMethodAccount"))||void 0===C?void 0:C.account])||void 0===f?void 0:f.name})]}),(0,u.jsx)("div",{className:"flexSpace"}),null!==(I=(0,a.bh)("PaymentMethodAccount"))&&void 0!==I&&I.subAccount?(0,u.jsxs)("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[(0,u.jsx)("div",{className:"code",children:null===(P=(0,a.bh)("sub_account_ids"))||void 0===P||null===(M=P[null===(g=(0,a.bh)("PaymentMethodAccount"))||void 0===g?void 0:g.subAccount])||void 0===M?void 0:M.subAccount}),(0,u.jsx)("div",{className:"name",children:null===(R=(0,a.bh)("sub_account_ids"))||void 0===R||null===(z=R[null===(w=(0,a.bh)("PaymentMethodAccount"))||void 0===w?void 0:w.subAccount])||void 0===z?void 0:z.subAccountName})]}):null]}):null]}),"card"===(null===(D=(0,a.bh)(_))||void 0===D?void 0:D.paymentType)&&null!==(F=(0,a.bh)("PaymentMethodAccount"))&&void 0!==F&&F.account?(0,u.jsxs)("div",{className:"",children:[(0,u.jsx)("div",{className:"separator"}),null!==(S=(0,a.bh)("ComissionAccount"))&&void 0!==S&&S.account?(0,u.jsxs)("div",{className:"",children:[(0,u.jsxs)("div",{className:" acc_dtls",children:[(0,u.jsxs)("div",{className:"_dsplFlx",children:[(0,u.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===(k=(0,a.bh)("account_ids"))||void 0===k||null===(T=k[null===(O=(0,a.bh)("ComissionAccount"))||void 0===O?void 0:O.account])||void 0===T?void 0:T.code}),(0,u.jsx)("div",{className:"name",children:null===(U=(0,a.bh)("account_ids"))||void 0===U||null===(Q=U[null===(Z=(0,a.bh)("ComissionAccount"))||void 0===Z?void 0:Z.account])||void 0===Q?void 0:Q.name})]}),(0,u.jsx)("div",{className:"flexSpace"}),null!==(q=(0,a.bh)("ComissionAccount"))&&void 0!==q&&q.subAccount?(0,u.jsxs)("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[(0,u.jsx)("div",{className:"code",children:null===(E=(0,a.bh)("sub_account_ids"))||void 0===E||null===(G=E[null===(H=(0,a.bh)("ComissionAccount"))||void 0===H?void 0:H.subAccount])||void 0===G?void 0:G.subAccount}),(0,u.jsx)("div",{className:"name",children:null===(K=(0,a.bh)("sub_account_ids"))||void 0===K||null===($=K[null===(B=(0,a.bh)("ComissionAccount"))||void 0===B?void 0:B.subAccount])||void 0===$?void 0:$.subAccountName})]}):null]}),(0,u.jsxs)("div",{className:"_dsplFlx",children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)("div",{style:{maxWidth:120},children:(0,u.jsx)(b,{init:null===(L=(0,a.bh)("ComissionAccount"))||void 0===L?void 0:L.amount,label:"comision",width:80,updChanges:o=>((o,c,e)=>{let l=(0,a.bh)("ComissionAccount")||{};e?(l[e]||(l[e]={}),l[e][o]=c):l[o]=c,(0,a.Rz)("ComissionAccount",l),ao((0,a.M5)())})("amount",o)})}),(0,u.jsx)("div",{className:"flexSpace"})]})]}):(0,u.jsx)(p,{placeholder:"buscar cuenta de comision bancaria ",handleClick:(o,c)=>{let e={account:o,subAccount:c};(0,a.Rz)("ComissionAccount",e),ao((0,a.M5)())}}),(0,u.jsx)("div",{className:"separator"})]}):null,(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)(v,{init:null===(V=(0,a.bh)(_))||void 0===V?void 0:V.date,updDate:o=>no("date",o)}),(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)(b,{init:null===(W=(0,a.bh)(_))||void 0===W?void 0:W.collectDocument,label:"Documento de Cobro",width:200,updChanges:o=>no("collectDocument",o)})]}),(0,u.jsx)(b,{init:null===(Y=(0,a.bh)(_))||void 0===Y?void 0:Y.description,label:"Descripcion",width:520,updChanges:o=>no("description",o)}),to?(0,u.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,u.jsx)("div",{className:"tr_bar tr_bar_40",children:"Documento"}),(0,u.jsx)("div",{className:"tr_bar tr_bar_20",children:"Balance"}),(0,u.jsx)("div",{className:"tr_bar tr_bar_10"}),(0,u.jsx)("div",{className:"tr_bar tr_bar_25",children:"Por Pagar"})]}),to&&(0,a.bh)("toPay_by_doc")&&(null===(J=(0,a._2)((0,a.bh)("toPay_by_doc")))||void 0===J?void 0:J.map(((o,c)=>(0,u.jsx)(x,{idKey:o,data:(0,a.bh)("toPay_by_doc")[o],updObs:ao},o))))]}):null,(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)("div",{className:"card",children:(0,u.jsx)("button",{onClick:async()=>{var o,c,e,l,n;let i=(0,a.bh)(_),t=[];i.date?i.date=new Date(i.date).getTime()+4800:i.date=(new Date).getTime()+4800;let s=await(0,a.fN)(i.date),u={date:i.date,comprobanteId:s,description:i.description,businessId:null===(o=(0,a.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:new Date(i.date).getFullYear()};delete i.date;let r="",v=(0,a.bh)("multi_pay_by_doc")&&(0,a._2)((0,a.bh)("multi_pay_by_doc"));if(v&&(null===v||void 0===v||v.map(((o,c)=>{var e,l,n;let d={...i},s=(0,a.bh)("multi_pay_by_doc")[o];d.document=o,r+=o+" ; ",d.account=null===(e=(0,a.bh)("Acc2Pay"))||void 0===e?void 0:e.account,d.subAccount=null===(l=(0,a.bh)("Acc2Pay"))||void 0===l?void 0:l.subAccount,d.providerId=null===(n=(0,a.bh)("Acc2Pay"))||void 0===n?void 0:n.providerId,d.type="debit",d.amount=1*s,d.payOrCollect="pay",d.operationId=(0,a.M5)(),t.push(d)}))),null!==(c=(0,a.bh)("ComissionAccount"))&&void 0!==c&&c.account){var b;let o={...i};o.document=o.collectDocument,o.collectDocument=r,o.account=(0,a.bh)("ComissionAccount").account;let c=null===(b=(0,a.bh)("account_ids"))||void 0===b?void 0:b[o.account];c.payOrCollect&&(o.payOrCollect=c.payOrCollect),o.subAccount=(0,a.bh)("ComissionAccount").subAccount,o.type="debit",o.amount=1*(0,a.bh)("ComissionAccount").amount,o.operationId=(0,a.M5)(),t.push(o)}let m={...i},h=j((0,a.bh)("multi_pay_by_doc"));m.document=m.collectDocument,m.collectDocument=r,m.account=(0,a.bh)("PaymentMethodAccount").account;let p=null===(e=(0,a.bh)("account_ids"))||void 0===e?void 0:e[m.account];p.payOrCollect&&(m.payOrCollect=p.payOrCollect),m.subAccount=(0,a.bh)("PaymentMethodAccount").subAccount,m.type="credit",m.amount=1*h,null!==(l=(0,a.bh)("ComissionAccount"))&&void 0!==l&&l.amount&&(m.amount+=1*(0,a.bh)("ComissionAccount").amount),m.operationId=(0,a.M5)(),t.push(m);let y={...null===(n=(0,a.bh)((0,a.hQ)()))||void 0===n?void 0:n.add_multi_opera};y.params=u,y.form=t;const x=(0,a.I7)(y);await x&&((null===X||void 0===X?void 0:X.modalID)&&(0,d.CloseModal)({id:null===X||void 0===X?void 0:X.modalID}),setTimeout((()=>{(0,a.Rz)("multi_pay_by_doc",null),(0,a.Rz)(_,null),ao((0,a.M5)()),oo&&oo()}),400))},children:"Guardar"})})]})]})},x=o=>{let{data:c,updObs:e,idKey:n}=o;const[d,i]=(0,l.useState)(0),t=(o,c,e)=>{let l=(0,a.bh)("multi_pay_by_doc")||{};e?(l[e]||(l[e]={}),l[e][o]=c):l[o]=c,(0,a.Rz)("multi_pay_by_doc",l)};return 1*(null===c||void 0===c?void 0:c.amount)===0?null:(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,u.jsx)("div",{className:"tr_bar tr_bar_40",style:{marginTop:10},children:null===c||void 0===c?void 0:c.document}),(0,u.jsxs)("div",{className:"tr_bar tr_bar_20",style:{marginTop:10},children:["$",(1*(null===c||void 0===c?void 0:c.amount)).toFixed(2)]}),(0,u.jsx)("div",{className:"tr_bar tr_bar_10",style:{marginTop:10},children:d>(null===c||void 0===c?void 0:c.amount)?(0,u.jsx)("div",{className:"icon",children:(0,u.jsx)(r,{name:"alert",color:"#c62828"})}):null}),(0,u.jsx)("div",{className:"tr_bar tr_bar_25",children:(0,u.jsx)(b,{init:d,width:80,updChanges:o=>{return i(l=o),t(null===c||void 0===c?void 0:c.document,l),void e((0,a.M5)());var l}})})]})},j=o=>{var c;let e=0;return o&&(null===(c=(0,a._2)(o))||void 0===c||c.map(((c,l)=>{e+=(0,a.Zv)(o[c],2)}))),e}},1232:(o,c,e)=>{e.d(c,{GP:()=>t,N$:()=>d,hF:()=>u,i7:()=>a,nr:()=>n,pj:()=>r});var l=e(2350);const a=async(o,c)=>{var e,a;let n={...null===(e=(0,l.bh)((0,l.hQ)()))||void 0===e?void 0:e.filter_search_opera};n.params={businessId:null===(a=(0,l.bh)("profileUser"))||void 0===a?void 0:a.businessId,":account":null===o||void 0===o?void 0:o.account,":subAccount":null===o||void 0===o?void 0:o.subAccount,year:(0,l.bh)("date_current_year")};const d=(0,l.I7)(n),t=await d;if(t&&!t.error){(0,l.Rz)("collect_list",t),(0,l.Rz)("collect_by_doc",i(t)),(0,l.Rz)("collect_by_docM",i(t));let c=(null===o||void 0===o?void 0:o.account)+"_"+(null===o||void 0===o?void 0:o.subAccount);s(t,c)}c&&c()},n=async(o,c)=>{var e,a;let n={...null===(e=(0,l.bh)((0,l.hQ)()))||void 0===e?void 0:e.filter_search_opera};n.params={businessId:null===(a=(0,l.bh)("profileUser"))||void 0===a?void 0:a.businessId,":account":null===o||void 0===o?void 0:o.account,":subAccount":null===o||void 0===o?void 0:o.subAccount,year:(0,l.bh)("date_current_year")};const d=(0,l.I7)(n),t=await d;if(t&&!t.error){(0,l.Rz)("toPay_list",t),(0,l.Rz)("toPay_by_doc",i(t,!0)),(0,l.Rz)("toPay_by_docM",i(t,!0));let c=(null===o||void 0===o?void 0:o.account)+"_"+(null===o||void 0===o?void 0:o.subAccount);s(t,c)}c&&c()},d=async o=>{var c,e;let a={...null===(c=(0,l.bh)((0,l.hQ)()))||void 0===c?void 0:c.search_opera};a.params={businessId:null===(e=(0,l.bh)("profileUser"))||void 0===e?void 0:e.businessId,":search":(0,l.bh)("search_acc_record"),year:(0,l.bh)("date_current_year")};const n=(0,l.I7)(a),d=await n;d&&!d.error&&((0,l.Rz)("comprobante_list",d),(0,l.Rz)("comprobante_by_doc",i(d))),o&&o()};function i(o,c){var e={};let a=o&&(0,l._2)(o);return a.length>0?a.map((a=>{var n;let d=o[a],i=null===(n=d.document)||void 0===n?void 0:n.trim();if(!e[i]){e[i]={},["date","description","document","entryName"].forEach((o=>{e[i][o]=d[o]})),e[i].amount=0,e[i].operations=[]}if(d.type){let o=(0,l.Zv)(d.amount,2),a=(0,l.Zv)(e[i].amount,2),n=0;n=c?1*a+o*("debit"===d.type?-1:1):1*a+o*("credit"===d.type?-1:1),e[i].amount=(0,l.Zv)(n,2),e[i].operations.push(function(o){var c,e;let a={};a.account=null===(c=(0,l.bh)("account_ids"))||void 0===c?void 0:c[o.account],a.sub_account=null===(e=(0,l.bh)("sub_account_ids"))||void 0===e?void 0:e[o.subAccount],a.comprobanteId=o.comprobanteId,a.operationId=o.operationId,a.date=o.date,a.description=o.description;let n=(0,l.Zv)(o.amount,2);"credit"===o.type?(a.debit=0,a.credit=n):"debit"===o.type&&(a.credit=0,a.debit=n);return a}(d))}})):e=null,e}const t=(o,c,e)=>(0,l.MV)("SumDocuments",[o,c,e],(()=>{var e;let a=0;return o&&(null===(e=(0,l._2)(o))||void 0===e||e.map(((e,l)=>{var n;a+=1*(null===(n=o[e])||void 0===n?void 0:n[c])}))),a})),s=async(o,c,e)=>{let a=(0,l.bh)("rec_by_acc")||{};a[c]=((o,c,e)=>{var a;let n=0;return o&&(null===(a=(0,l._2)(o))||void 0===a||a.map(((c,e)=>{var a;let d=(0,l.Zv)(o[c].amount,2);n+=d*("credit"===(null===(a=o[c])||void 0===a?void 0:a.type)?-1:1)}))),n})(o)||"no",(0,l.Rz)("rec_by_acc",a),e&&e()},u=async(o,c,e)=>{var a,n;let d={...null===(a=(0,l.bh)((0,l.hQ)()))||void 0===a?void 0:a.filter_search_opera};d.params={businessId:null===(n=(0,l.bh)("profileUser"))||void 0===n?void 0:n.businessId,":account":null===o||void 0===o?void 0:o.account,":subAccount":null===o||void 0===o?void 0:o.subAccount,year:(0,l.bh)("date_current_year")};const i=(0,l.I7)(d),t=await i;t&&!t.error&&s(t,c),e&&e()},r=async(o,c,e)=>{var a,n;let d={...null===(a=(0,l.bh)((0,l.hQ)()))||void 0===a?void 0:a.search_subacc_acc};d.params={businessId:null===(n=(0,l.bh)("profileUser"))||void 0===n?void 0:n.businessId,":account":o,":search":c,year:(0,l.bh)("date_current_year")};const i=(0,l.I7)(d),t=await i;if(t&&!t.error){var s;let o=null===(s=(0,l._2)(t))||void 0===s?void 0:s[0];e&&e(t[o])}}},6021:()=>{}}]);
//# sourceMappingURL=1832.a658bc99.chunk.js.map