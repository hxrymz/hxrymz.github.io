"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[1879,9760],{9760:(e,l,t)=>{t.r(l),t.d(l,{CloseModal:()=>r,OpenModal:()=>n,default:()=>c});var d=t(2791),i=t(5408),o=t(2350),s=t(184);const a="listDialog_mdh392",c=()=>{const e=(0,o.bh)("listDialog")||{};(0,i.Z)(a);let l=Object.keys(e);return(0,s.jsx)(s.Fragment,{children:l.map(((l,t)=>{let i=e[l];if(i&&i.visible){let e={};i.height&&(e.heigth=i.height),i.width,i.zIndex&&(e.zIndex=i.zIndex-1);let t={zIndex:i.zIndex},o=null,a=i.data;return i.content&&(o=d.cloneElement(i.content,{data:a})),(0,s.jsxs)("div",{className:"ltr-1kbnjow",style:e,children:[(0,s.jsx)("div",{className:"ltr-hoe9xz",children:(0,s.jsx)("div",{className:"ltr-1wao6ny",style:t,id:l,children:o})}),i.data.overlay?(0,s.jsx)("div",{className:"DialogHRMOverlay ".concat(i.visible?"active":""),onClick:()=>{var e;e=l,document.getElementsByTagName("html")[0].classList.remove("has-level-two"),r({id:e})}}):null]},l)}}))})},n=e=>{let l=(0,o.bh)("listDialog")||{},t=(0,o.M5)();l[t]||(l[t]={}),l[t].visible=!0;let d={};e.props?(d=e.props,d.modalID=t):d.modalID=t;let i=document.getElementsByTagName("body")[0];null!==i&&void 0!==i&&i.style&&(i.style.overflowY="hidden"),l[t].isView=e.isView,l[t].observeResize=e.observeResize,l[t].observeResize&&(l[t].observeInterval=setInterval((()=>{let e=document.querySelector("[dialog-key-id='".concat(t,"']")),d=e&&e.getBoundingClientRect();d&&(d.width===l[t].width&&d.height===l[t].height||(l[t].height=d.height+10,l[t].width=d.width,(0,o.Rz)("listDialog",l),(0,o.wt)(a)))}),200)),l[t].display=!0,e.zIndex&&(l[t].zIndex=e.zIndex),e.height&&(l[t].height=e.height),e.width&&(l[t].width=e.width),e.content&&(l[t].content=e.content),l[t].data=d,(0,o.Rz)("listDialog",l),(0,o.wt)(a),setTimeout((()=>{document.getElementsByTagName("html")[0].classList.add("has-level-two"),(0,o.Rz)("modalOpen",t),(0,o.wt)(a)}),125)},r=e=>{let l=(0,o.bh)("listDialog")||{},t=e.id;if(l[t]){var d,i,s;l[t].observeResize&&l[t].observeInterval&&clearInterval(l[t].observeInterval),l[t].display=!1,null===(d=l[t])||void 0===d||null===(i=d.data)||void 0===i||null===(s=i.closeEvent)||void 0===s||s.call(i),(0,o.Rz)("listDialog",l),delete l[t],document.getElementsByTagName("body")[0].style.overflowY=null,(0,o.wt)(a),setTimeout((()=>{delete l[t],document.getElementsByTagName("html")[0].classList.remove("has-level-two"),(0,o.Rz)("modalOpen",null)}),750)}}},1879:(e,l,t)=>{t.r(l),t.d(l,{default:()=>_});var d=t(2791),i=t(2350),o=t(2647),s=(t(1534),t(9760)),a=t(7689),c=t(9661),n=t(24),r=t(713),u=t(184);const v=(0,o.PU)(),h=(0,o.Np)(),p=(0,n.f_)(),m=(0,c.FC)(),b=(0,n.Az)(),x="new_product_out_comprobante",_=e=>{var l,t,o,c,n,r,v,m;let{data:b,confirm:_}=e;const[j,I]=(0,d.useState)(!1),[k,N]=(0,d.useState)(0),f=(0,a.s0)();(0,d.useEffect)((()=>{j||(I(!0),(0,i.Rz)("accountPicker",{}),N((0,i.M5)()))}));const O=(e,l,t)=>{let d=(0,i.bh)(x)||{};t?(d[t]||(d[t]={}),d[t][e]=l):d[e]=l,(0,i.Rz)(x,d),N((0,i.M5)())};return(0,u.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"750px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)("p",{className:"form_title",children:"Salida de Mercancias"}),(0,u.jsx)("div",{className:"flexSpace"})]}),(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)(p,{init:null===(l=(0,i.bh)(x))||void 0===l?void 0:l.date,updDate:e=>O("date",e)}),(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)(h,{init:null===(t=(0,i.bh)(x))||void 0===t?void 0:t.document,label:"Documento",width:120,updChanges:e=>O("document",e)}),(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)(h,{init:null===(o=(0,i.bh)(x))||void 0===o?void 0:o.amount,label:"Importe de la venta",width:120,updChanges:e=>O("amount",e)})]}),(0,u.jsx)(h,{init:null===(c=(0,i.bh)(x))||void 0===c?void 0:c.description,label:"Descripcion",width:520,updChanges:e=>O("description",e)}),(0,u.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)(y,{})]}),(0,u.jsx)(g,{}),(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)("div",{className:"flexSpace"}),null!==(n=(0,i.bh)(x))&&void 0!==n&&n.document&&null!==(r=(0,i.bh)(x))&&void 0!==r&&r.amount&&null!==(v=(0,i.bh)("customerOutPicker"))&&void 0!==v&&v.account&&(null===(m=(0,i._2)((0,i.bh)("productListOnOut")))||void 0===m?void 0:m.length)>0?(0,u.jsx)("div",{className:"card",children:(0,u.jsx)("button",{onClick:async()=>{var e;let l=(0,i.bh)(x),t=(new Date).getTime()+800;if(l.date){let e=new Date(l.date).getTime();t=e||t}l.date=t;let d=[],o=await(0,i.fN)(l.date);l.comprobanteId=o;let a=0,c=0,n=(0,i.bh)("global_account_params"),r=(0,i.bh)("productListOnOut")&&(0,i._2)((0,i.bh)("productListOnOut"));if(r&&(null===r||void 0===r||r.map((async(e,o)=>{var s,n;let r={...(0,i.bh)("productListOnOut")[e]},u={...r};u.document=l.document.trim(),u.date=t,u.price=1*r.price,u.qty=-1*r.qty,u.comprobanteId=l.comprobanteId,u.inventoryId=(0,i.M5)(),delete u.product,delete u.account,delete u.subAccount;let v=1*r.qty*(1*r.price);a+=v,c+=v,u.amount=-1*v;let h={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.add_inventory};h.params={businessId:null===(n=(0,i.bh)("profileUser"))||void 0===n?void 0:n.businessId},h.form=u,d.push(h)}))),c>0){var u,v,h,p,m,y;let e={...l};e.type="credit",e.account=null===n||void 0===n||null===(u=n.inventory)||void 0===u?void 0:u.account,e.amount=c,e.operationId=(0,i.M5)();let t={...null===(v=(0,i.bh)((0,i.hQ)()))||void 0===v?void 0:v.add_opera};t.params={businessId:null===(h=(0,i.bh)("profileUser"))||void 0===h?void 0:h.businessId,year:new Date(l.date).getFullYear()},t.form=e,d.push(t);let o={...l};o.type="debit",o.account=null===n||void 0===n||null===(p=n.inventory_expensess)||void 0===p?void 0:p.account,o.amount=c,o.operationId=(0,i.M5)();let s={...null===(m=(0,i.bh)((0,i.hQ)()))||void 0===m?void 0:m.add_opera};s.params={businessId:null===(y=(0,i.bh)("profileUser"))||void 0===y?void 0:y.businessId,year:new Date(l.date).getFullYear()},s.form=o,d.push(s)}if(a>0&&(0,i.bh)("customerOutPicker").account){var g,j,I,k,O,w,z;let e={...l};e.type="debit",e.account=null===(g=(0,i.bh)("customerOutPicker"))||void 0===g?void 0:g.account,e.subAccount=null===(j=(0,i.bh)("customerOutPicker"))||void 0===j?void 0:j.subAccount,e.providerId=null===(I=(0,i.bh)("customerOutPicker"))||void 0===I?void 0:I.providerId,e.operationId=(0,i.M5)();let t=null===(k=(0,i.bh)("account_ids"))||void 0===k?void 0:k[null===(O=(0,i.bh)("customerOutPicker"))||void 0===O?void 0:O.account];t&&t.payOrCollect&&(e.payOrCollect=t.payOrCollect),e.amount=1*e.amount;let o={...null===(w=(0,i.bh)((0,i.hQ)()))||void 0===w?void 0:w.add_opera};o.params={businessId:null===(z=(0,i.bh)("profileUser"))||void 0===z?void 0:z.businessId,year:new Date(l.date).getFullYear()},o.form=e,d.push(o)}if(null!==n&&void 0!==n&&null!==(e=n.sales_income)&&void 0!==e&&e.account){var P,R,C;let e={...l};e.type="credit",e.account=null===n||void 0===n||null===(P=n.sales_income)||void 0===P?void 0:P.account,e.operationId=(0,i.M5)(),e.amount=1*e.amount;let t={...null===(R=(0,i.bh)((0,i.hQ)()))||void 0===R?void 0:R.add_opera};t.params={businessId:null===(C=(0,i.bh)("profileUser"))||void 0===C?void 0:C.businessId,year:new Date(l.date).getFullYear()},t.form=e,d.push(t)}const D=d.map((async e=>{const l=(0,i.I7)(e);await l}));await Promise.all(D),(null===b||void 0===b?void 0:b.modalID)&&(0,s.CloseModal)({id:null===b||void 0===b?void 0:b.modalID}),setTimeout((()=>{(0,i.Rz)("extraAccountListOnCmp",null),(0,i.Rz)("productListOnOut",null),(0,i.Rz)("customerOutPicker",null),(0,i.Rz)(x,null),N((0,i.M5)()),_&&_(),f({pathname:"/accounting-ledger",search:"?cId=".concat(o)})}),400)},children:"Guardar"})}):null]})]})},y=e=>{var l,t;let{}=e;const[o,s]=(0,d.useState)(0);let a=null===(l=(0,i.bh)("providers_ids"))||void 0===l?void 0:l[null===(t=(0,i.bh)("customerOutPicker"))||void 0===t?void 0:t.providerId];return(0,u.jsx)("div",{children:null!==a&&void 0!==a&&a.name?(0,u.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,u.jsxs)("div",{className:" acc_dtls",children:[(0,u.jsx)("div",{className:"_dsplFlx",children:(0,u.jsx)("div",{className:"code",style:{color:"#646cff"},onClick:()=>{(0,i.Rz)("customerOutPicker",null),s((0,i.M5)())},children:null===a||void 0===a?void 0:a.name})}),(0,u.jsx)("div",{className:"flexSpace"})]})}):(0,u.jsx)(m,{placeholder:"buscar una provedor",width:320,handleClick:e=>{let l={providerId:e.providerId,account:e.account,subAccount:e.subAccount};(0,i.Rz)("customerOutPicker",l),s((0,i.M5)())}})})},g=e=>{var l,t,o,s,a,c,n,v,p,m,x,_,y;let{}=e;const[g,I]=(0,d.useState)(0),k=()=>{I((0,i.M5)())};let N=null===(l=(0,i.bh)("products_ids"))||void 0===l?void 0:l[null===(t=(0,i.bh)("productPicker"))||void 0===t?void 0:t.productId];const f=e=>{let l=(0,i.bh)("productListOnOut")||{};delete l[e],(0,i.Rz)("productListOnOut",l),I((0,i.M5)())};return(0,u.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[null!==(o=(0,i.bh)("productPicker"))&&void 0!==o&&o.productId?(0,u.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,u.jsxs)("div",{className:" acc_dtls",children:[(0,u.jsxs)("div",{className:"_dsplFlx",onClick:e=>{(0,i.Rz)("productPicker",null),I((0,i.M5)())},children:[(0,u.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===N||void 0===N?void 0:N.upc_barcode}),(0,u.jsx)("div",{className:"name",children:null===N||void 0===N?void 0:N.name})]}),(0,u.jsx)("div",{className:"flexSpace"})]})}):(0,u.jsx)(b,{width:420,handleClick:e=>{let l={productId:e.productId,product:e.product,subAccount:e.subAccount};(0,i.Rz)("productPicker",l),(0,r.Rd)(e.productId,k)}}),null!==(s=(0,i.bh)("products_stock"))&&void 0!==s&&null!==(a=s[null===(c=(0,i.bh)("productPicker"))||void 0===c?void 0:c.productId])&&void 0!==a&&a.qty?(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)(h,{init:null===(n=(0,i.bh)("productPicker"))||void 0===n?void 0:n.qty,label:"Cantidad",width:120,type:"number",updChanges:e=>((e,l,t)=>{let d=(0,i.bh)("productPicker")||{};t?(d[t]||(d[t]={}),d[t][e]=l):d[e]=l,(0,i.Rz)("productPicker",d),I((0,i.M5)())})("qty",e)}),(0,u.jsx)("div",{className:"flexSpace"}),null!==(v=(0,i.bh)("productPicker"))&&void 0!==v&&v.qty&&(null===(p=(0,i.bh)("productPicker"))||void 0===p?void 0:p.qty)<=(null===(m=(0,i.bh)("products_stock"))||void 0===m||null===(x=m[null===(_=(0,i.bh)("productPicker"))||void 0===_?void 0:_.productId])||void 0===x?void 0:x.qty)?(0,u.jsx)("div",{style:{marginTop:38},children:(0,u.jsx)("button",{onClick:()=>{var e,l,t,d,o,s;let a={...(0,i.bh)("productPicker")}||{},c={...(0,i.bh)("productPicker")}||{},n={...(0,i.bh)("productListOnOut")}||{},r=a.productId,u=(null===(e=(0,i.bh)("products_stock"))||void 0===e||null===(l=e[null===(t=(0,i.bh)("productPicker"))||void 0===t?void 0:t.productId])||void 0===l?void 0:l.amount)/(null===(d=(0,i.bh)("products_stock"))||void 0===d||null===(o=d[null===(s=(0,i.bh)("productPicker"))||void 0===s?void 0:s.productId])||void 0===o?void 0:o.qty);a.price=u,n[r]=a,(0,i.Rz)("productListOnOut",n),c.productId=null,c.qty="",c.price="",(0,i.Rz)("productPicker",c),I((0,i.M5)())},children:"Agregar"})}):null]}):null,(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,u.jsx)("div",{className:"tr_bar tr_bar_50 ",children:"Producto"}),(0,u.jsx)("div",{className:"tr_bar tr_bar_20",children:"Qty"}),(0,u.jsx)("div",{className:"tr_bar tr_bar_20",children:"Costo (un)"}),(0,u.jsx)("div",{className:"tr_bar tr_bar_5"})]}),(0,i.bh)("productListOnOut")&&(null===(y=(0,i._2)((0,i.bh)("productListOnOut")))||void 0===y?void 0:y.map(((e,l)=>(0,u.jsx)(j,{idKey:e,data:(0,i.bh)("productListOnOut")[e],deleteItem:f},e))))]})},j=e=>{var l;let{data:t,deleteItem:d,idKey:o}=e,s=null===(l=(0,i.bh)("products_ids"))||void 0===l?void 0:l[null===t||void 0===t?void 0:t.productId];return(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,u.jsx)("div",{className:"tr_bar tr_bar_50",children:null===s||void 0===s?void 0:s.name}),(0,u.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,i.Zv)(null===t||void 0===t?void 0:t.qty,2)}),(0,u.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,i.Zv)(null===t||void 0===t?void 0:t.price,2)}),(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)("div",{className:"icon",onClick:()=>{d(o)},children:(0,u.jsx)(v,{name:"outline_delete",color:"#c62828"})})]})}},1534:()=>{}}]);
//# sourceMappingURL=1879.4cac86ef.chunk.js.map