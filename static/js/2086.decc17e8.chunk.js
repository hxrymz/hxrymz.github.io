"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[2086,7766],{8779:(e,i,l)=>{l.d(i,{Z:()=>s});l(2791),l(1534);var o=l(9760),d=l(184);const s=e=>{let{data:i,confirm:l,label:s,labelColor:n,body:a,btnConfirm:c,theme:t}=e;const{modalID:r}=i,v=e=>{(0,o.CloseModal)({id:r})};let u=t||"red";return(0,d.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"28vh",minWidth:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,d.jsxs)("div",{className:"_dsplFlx ",children:[(0,d.jsx)("p",{className:"form_title",style:n?{color:n}:null,children:s}),(0,d.jsx)("div",{className:"flexSpace"})]}),(0,d.jsx)("div",{className:"_dsplFlx ",style:{margin:"15px 0"},children:(0,d.jsx)("span",{children:a||"Una vez eliminado no podra ser recuperado"})}),(0,d.jsxs)("div",{className:"_dsplFlx ",style:{padding:"15px 10px"},children:[(0,d.jsx)("div",{className:"flexSpace"}),(0,d.jsx)("p",{className:"group_title addBtn",onClick:v,children:"Cancelar"}),(0,d.jsx)("p",{className:"group_title addBtn ".concat(u),onClick:()=>{l&&l(),v()},children:c||"Eliminar"})]})]})}},1496:(e,i,l)=>{l.r(i),l.d(i,{default:()=>y});var o=l(2791),d=l(2350),s=l(2647),n=l(9760),a=(l(3971),l(5986)),c=l(6496),t=l(4050),r=(l(261),l(6824)),v=l(8779),u=l(184);const m=(0,s.PU)(),h=(0,s.Vg)(),p=(0,s.YZ)(),x=((0,s.tW)(),{1:{color:"var(--hrm_palette-success-fg)",icon:"success"},2:{color:"var(--hrm_palette-selected-nav-text)",icon:"problem"},3:{color:"rgb(254, 120, 23)",icon:"alert"},9:{color:"var(--hrm_palette-success-fg)",icon:"check_circle_outline"}}),_=e=>{var i,l,s,n,a;let{data:t,item:v}=e;const[,_]=(0,o.useState)(0),[g,f]=(0,o.useState)(""),[N,C]=(0,o.useState)(!1),[I,y]=(0,o.useState)(!1),[k,F]=(0,o.useState)(!1),[w,S]=(0,o.useState)(!1);(0,o.useEffect)((()=>{N||(C(!0),(0,c.S$)(D))}),[N]);const D=()=>{_((0,d.M5)()),y(!1)},M=e=>{f(e),I&&y(!1)},A=()=>{(0,c.S$)(D)},U=e=>{S(e===w?null:e)};return(0,u.jsxs)("div",{style:{maxHeight:"96vh",minHeight:"94vh",width:"94vw",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px 30px"},children:[(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)("p",{className:"title_collect",children:"Compare Invoices"}),(0,u.jsx)("div",{className:"flexSpace"}),k?(0,u.jsxs)("div",{className:"actionBx _dsplFlx",children:[(0,u.jsx)("div",{className:"filterCode",onClick:()=>(e=>{var i;let l=[];(0,d.bh)("invoiceCmpDocs")&&(null===(i=(0,d._2)((0,d.bh)("invoiceCmpDocs")))||void 0===i||i.map(((e,i)=>{var o;let s=null===(o=(0,d.bh)("invoiceCmpDocs"))||void 0===o?void 0:o[e];(g||k)&&j(s,g,k,w)&&l.push(s)}))),(0,r.cg)(l)})(),children:(0,u.jsx)(m,{name:"printer",color:"#8b949e"})}),(0,u.jsx)("div",{className:"filterCode",onClick:()=>(e=>{var i;let l=[];(0,d.bh)("invoiceCmpDocs")&&(null===(i=(0,d._2)((0,d.bh)("invoiceCmpDocs")))||void 0===i||i.map(((e,i)=>{var o;let s=null===(o=(0,d.bh)("invoiceCmpDocs"))||void 0===o?void 0:o[e];if((g||k)&&j(s,g,k,w)){var n,a,c,t,r;let e={fecha:s.date?(0,d.sJ)(s.date):"",documento:s.document,importe:null===(n=1*(null===s||void 0===s?void 0:s.amount))||void 0===n?void 0:n.toFixed(2),vendido:null===(a=1*(null===s||void 0===s?void 0:s.cc_d))||void 0===a?void 0:a.toFixed(2),anticipo:null===(c=1*(null===s||void 0===s?void 0:s.hasAnticipo))||void 0===c?void 0:c.toFixed(2),cobrado:null===(t=1*(null===s||void 0===s?void 0:s.cc_c))||void 0===t?void 0:t.toFixed(2),saldo:null===(r=1*(null===s||void 0===s?void 0:s.saldo))||void 0===r?void 0:r.toFixed(2)};l.push(e)}}))),(0,d.eY)("export_invoices_"+(0,d.M5)()+".csv",l)})(),children:(0,u.jsx)(m,{name:"google-spreadsheet",color:"#8b949e"})})]}):null]}),(0,u.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,u.jsx)("div",{style:{marginTop:11},children:(0,u.jsx)(h,{placeholder:"Buscar ....",width:560,obs:_,fetchData:M,loading:I,change:e=>{!I&&y(!0),f(e)},callempty:M,keyFlds:"search_cmpInvoice"})}),(0,u.jsx)("div",{className:"flexSpace"}),k?(0,u.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:20,marginRight:20},children:[(0,u.jsx)("div",{className:"filterCode",onClick:()=>U(2),children:(0,u.jsx)(m,{name:null===(i=x[2])||void 0===i?void 0:i.icon,color:2===w?null===(l=x[2])||void 0===l?void 0:l.color:"#8b949e"})}),(0,u.jsx)("div",{className:"filterCode",onClick:()=>U(3),children:(0,u.jsx)(m,{name:null===(s=x[3])||void 0===s?void 0:s.icon,color:3===w?null===(n=x[3])||void 0===n?void 0:n.color:"#8b949e"})})]}):null,(0,u.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:20},children:[(0,u.jsx)(p,{initvalue:k,keyCode:57,updChange:F}),(0,u.jsx)("span",{className:"checklabel",children:"Need Attention"})]})]}),(0,u.jsxs)("div",{style:{marginTop:14},children:[(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar purple",children:[(0,u.jsx)("div",{className:"tr_bar_5",children:" "}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Fecha"}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Documento"}),(0,u.jsx)("div",{className:"tr_bar_12",children:"Importe"}),(0,u.jsx)("div",{className:"tr_bar_12",children:"Vendido"}),(0,u.jsx)("div",{className:"tr_bar_12",children:"Anticipo"}),(0,u.jsx)("div",{className:"tr_bar_12",children:"Cobrado"}),(0,u.jsx)("div",{className:"tr_bar_12",children:"Saldo"}),(0,u.jsx)("div",{className:"tr_bar_5",children:" "})]}),(0,u.jsx)("div",{className:"scollVh subMHeight",children:(0,d.bh)("invoiceCmpDocs")&&(null===(a=(0,d._2)((0,d.bh)("invoiceCmpDocs")))||void 0===a?void 0:a.map(((e,i)=>{var l;let o=null===(l=(0,d.bh)("invoiceCmpDocs"))||void 0===l?void 0:l[e];if((g||k)&&!j(o,g,k,w))return null;let s=(0,d.Zv)(null===o||void 0===o?void 0:o.saldo,2),n=s<0?2:s>0?3:(null===o||void 0===o?void 0:o.cc_c)>0?1:2;return(0,u.jsx)(b,{eleId:e,element:o,hasErr:n,reload:A},i)})))})]})]})},b=e=>{var i,l,o,s,a,c,t;let{element:r,eleId:h,hasErr:p,reload:_}=e;const b=async()=>{var e,i;let l={...null===(e=(0,d.bh)((0,d.hQ)()))||void 0===e?void 0:e.upd_invoice};l.params={businessId:null===(i=(0,d.bh)("profileUser"))||void 0===i?void 0:i.businessId,invoiceId:r.invoiceId},l.data2update={invoiceLinkConfirmed:99};const o=(0,d.I7)(l);await o&&_&&_()};99===(null===r||void 0===r?void 0:r.invoiceLinkConfirmed)&&(p=9);return(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar manual_vrfy",children:[(0,u.jsx)("div",{className:"tr_bar_5",children:(0,u.jsx)("div",{onClick:e=>{var i;let l={};l.id=e,l.zIndex=490,l.height="40vh",l.props={minHeight:"1vh",overlay:!0,closeEvent:()=>{}};let o=(0,u.jsx)("div",{children:(0,u.jsx)("h4",{className:"",style:{padding:4,margin:0},children:"El Invoice esta verificado en la contabilidad"})}),d=(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)("div",{className:"centerBx",style:{padding:4,marginRight:20},children:(0,u.jsx)(m,{name:"success",color:null===(i=x[p])||void 0===i?void 0:i.color})}),(0,u.jsx)("h4",{className:"",style:{padding:4,margin:0},children:"Confirmar Invoice !!!"})]});l.content=(0,u.jsx)(v.Z,{label:d,labelColor:"var(--hrm_palette-success-fg)",body:o,btnConfirm:"Ok",theme:"green",confirm:b,done:e=>{e&&(0,n.CloseModal)({id:e})}}),(0,n.OpenModal)(l)},children:(0,u.jsx)(m,{name:null===(i=x[p])||void 0===i?void 0:i.icon,color:null===(l=x[p])||void 0===l?void 0:l.color})})}),(0,u.jsx)("div",{className:"tr_bar_15",children:(null===r||void 0===r?void 0:r.date)&&(0,d.sJ)(r.date)}),(0,u.jsx)("div",{className:"tr_bar_15 comprobanteId",children:h}),(0,u.jsx)("div",{className:"tr_bar_12 ",children:null===(o=1*(null===r||void 0===r?void 0:r.amount))||void 0===o?void 0:o.toFixed(2)}),(0,u.jsx)("div",{className:"tr_bar_12",children:null===(s=1*(null===r||void 0===r?void 0:r.cc_d))||void 0===s?void 0:s.toFixed(2)}),(0,u.jsx)("div",{className:"tr_bar_12",children:null===(a=1*(null===r||void 0===r?void 0:r.hasAnticipo))||void 0===a?void 0:a.toFixed(2)}),(0,u.jsx)("div",{className:"tr_bar_12",children:null===(c=1*(null===r||void 0===r?void 0:r.cc_c))||void 0===c?void 0:c.toFixed(2)}),(0,u.jsx)("div",{className:"tr_bar_12",children:null===(t=1*(null===r||void 0===r?void 0:r.saldo))||void 0===t?void 0:t.toFixed(2)}),(0,u.jsx)("div",{className:"tr_bar_5",children:" "})]})},j=(e,i,l,o)=>{let s=!1;if(i){let n=i.toLowerCase();["amount","document","cc_c","cc_d","saldo"].map((i=>{if(l){var a,c,t;let l=(0,d.Zv)(null===e||void 0===e?void 0:e.saldo,2),m=l<0?2:l>0?3:(null===e||void 0===e?void 0:e.cc_c)>0?1:2;var r,v,u;if(99===(null===e||void 0===e?void 0:e.invoiceLinkConfirmed)&&(m=1),o)m===o&&e[i]&&(null===(r=e[i])||void 0===r||null===(v=r.toString())||void 0===v||null===(u=v.toLowerCase())||void 0===u?void 0:u.indexOf(n))>=0&&(s=!0);else 1!==m&&e[i]&&(null===(a=e[i])||void 0===a||null===(c=a.toString())||void 0===c||null===(t=c.toLowerCase())||void 0===t?void 0:t.indexOf(n))>=0&&(s=!0)}else{var m,h,p;e[i]&&(null===(m=e[i])||void 0===m||null===(h=m.toString())||void 0===h||null===(p=h.toLowerCase())||void 0===p?void 0:p.indexOf(n))>=0&&(s=!0)}}))}else{let i=(0,d.Zv)(null===e||void 0===e?void 0:e.saldo,2),l=i<0?2:i>0?3:(null===e||void 0===e?void 0:e.cc_c)>0?1:2;99===(null===e||void 0===e?void 0:e.invoiceLinkConfirmed)&&(l=1),o?l===o&&(s=!0):1!==l&&(s=!0)}return s};var g=l(713);const f=(0,s.Vg)(),N=(0,a.bb)(),C=(0,a.T5)(),I=(0,a.qY)(),y=e=>{var i,l,s;let{data:a,elmId:r,updObs:v}=e;const[m,h]=(0,o.useState)(!1),[p,x]=(0,o.useState)(0),[b,j]=(0,o.useState)(64),[y,k]=(0,o.useState)(!1);(0,o.useEffect)((()=>{m||(h(!0),x((0,d.M5)()),(0,c.p9)(D),(0,g.N0)(v),(0,t.Ht)("global_accounts","global_account_params",v))}));const F=()=>{},w=e=>{(0,c.p9)(D)},S=()=>{j((e=>e+64))},D=()=>{var e;(async(e,i)=>{64!==b?j(64):x((0,d.M5)()),k(!1)})();let i=Math.ceil((null===(e=(0,d._2)((0,d.bh)("invoices_list")))||void 0===e?void 0:e.length)/64);(0,d.Z$)(S,1250,i),setTimeout((()=>{k(!1)}),230)};return(0,u.jsxs)("div",{className:"",children:[(0,u.jsxs)("div",{className:"accounts_header",children:[(0,u.jsx)("h2",{children:"Invoices"}),(0,u.jsxs)("div",{className:"_dsplFlx ",children:[null!==(i=(0,d.Ch)()[(0,d.bh)("date_current_year")])&&void 0!==i&&i.isClosed?null:(0,u.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{let e={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,u.jsx)(C,{}),(0,n.OpenModal)(e)},children:"Add Invoice"}),(0,u.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{let e={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,u.jsx)(_,{}),(0,n.OpenModal)(e)},children:"Compare Invoice"}),(0,u.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{let e={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,u.jsx)(I,{}),(0,n.OpenModal)(e)},children:"Print Check"}),(0,u.jsxs)("div",{className:"group_title addBtn purple upl",children:["Import Invoices from File",(0,u.jsx)("input",{id:"fileupload",type:"file",onChange:e=>{var i=new FileReader;i.onload=function(e){var i=e.target.result;(0,c.c_)(i)},i.readAsText(e.target.files[0],"UTF-8")}})]})]}),(0,u.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,u.jsx)(f,{placeholder:"Buscar ....",width:360,obs:x,fetchData:e=>{k(!0),(0,c._3)(D)},loading:y,change:e=>{!y&&k(!0)},callempty:w,keyFlds:"searchQry"}),(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsx)("div",{className:"total_comprobante_title",children:"No de Invoices:"}),(0,u.jsx)("div",{className:"total_comprobante gray",children:(0,u.jsx)("span",{children:null===(l=(0,d._2)((0,d.bh)("invoices_list")))||void 0===l?void 0:l.length})})]})]})]}),(0,u.jsx)("div",{className:"invoices_container scollVh",style:{height:"calc(98vh - 230px)"},children:(0,d.bh)("invoices_list")&&(null===(s=(0,d._2)((0,d.bh)("invoices_list")))||void 0===s?void 0:s.map(((e,i)=>(0,u.jsx)(N,{data:(0,d.bh)("invoices_list")[e],elmId:e,openUpdateView:F,handleRefreshAll:w,show:i<b,index:i},e))))})]})}},6496:(e,i,l)=>{l.d(i,{S$:()=>c,_3:()=>s,c_:()=>v,jB:()=>a,p9:()=>d});var o=l(2350);const d=async e=>{let i=(0,o.bh)("getall_invoice_last")||0;if(Date.now()>i){var l,d;(0,o.Rz)("getall_invoice_last",Date.now()+190);let i={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.all_invoices};i.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId};const s=(0,o.I7)(i),a=await s;a&&((0,o.Rz)("invoices_list",n(a,"document")),(0,o.Rz)("invoices_ids",(0,o.ME)((0,o.jQ)(a),"document")),e&&e())}},s=async e=>{var i,l;let d={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.search_invoice};d.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId,":search":(0,o.bh)("searchQry")};const s=(0,o.I7)(d),a=await s;a&&((0,o.Rz)("invoices_list",n((0,o.jQ)(a),"document")),e&&e())},n=(e,i,l)=>(0,o.MV)("sortInvoices",[e],(()=>e&&e.sort(((e,o)=>{let d=e[i],s=o[i];return d<s?l?-1:1:d>s?l?1:-1:0})))),a=async(e,i)=>{var l,d;let s={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.delete_invoice};s.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,invoiceId:e};const n=(0,o.I7)(s);await n&&i&&i()},c=async e=>{var i,l;let d={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.all_invoices};d.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId};const s=(0,o.I7)(d),n=await s;n&&((0,o.Rz)("invoiceCmp",n),t("SSJsgB2uUqcuoagD",(()=>{t("v5MkYLwPAbgci3wW",(()=>{let i=r();(0,o.Rz)("invoiceCmpDocs",i),e&&e()}))})))},t=async(e,i)=>{var l,d;let s={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.filter_search_opera};s.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,year:(0,o.bh)("date_current_year"),":account":e};const n=(0,o.I7)(s),a=await n;a&&!a.error?((0,o.Rz)("invoiceCmp"+e,a),i&&i()):i&&i()},r=()=>{let e=(0,o.bh)("invoiceCmp"),i=(0,o.bh)("invoiceCmpSSJsgB2uUqcuoagD"),l=(0,o.bh)("invoiceCmpv5MkYLwPAbgci3wW"),d={};return(0,o._2)(e).map((i=>{let l=e[i].document.trim();var o,s;d[l]||(d[l]={document:l,invoiceId:null===(o=e[i])||void 0===o?void 0:o.invoiceId,invoiceLinkConfirmed:null===(s=e[i])||void 0===s?void 0:s.invoiceLinkConfirmed,amount:0,saldo:0,hasAnticipo:0,cc_c:0,cc_d:0,comprobanteIds:{}});d[l].amount+=e[i].amount,d[l].saldo+=1*e[i].amount,d[l].date=e[i].date})),(0,o._2)(i).map((e=>{var l,o,s;let n=i[e].document.trim();d[n]||(d[n]={document:n,amount:0,saldo:0,hasAnticipo:0,cc_c:0,cc_d:0,comprobanteIds:{}}),d[n].cc_d+="debit"===(null===(l=i[e])||void 0===l?void 0:l.type)?1*i[e].amount:0,d[n].cc_c+="credit"===(null===(o=i[e])||void 0===o?void 0:o.type)?1*i[e].amount:0,d[n].saldo+="credit"===(null===(s=i[e])||void 0===s?void 0:s.type)?-1*i[e].amount:0,d[n].comprobanteIds[i[e].comprobanteId]={date:i[e].date,description:i[e].description}})),(0,o._2)(l).map((e=>{var i,o;let s=l[e].document.trim();s.indexOf("A-")>=0&&(s=s.split("A-")[1]),d[s]||(d[s]={document:s,amount:0,hasAnticipo:0,cc_c:0,cc_d:0,saldo:0,comprobanteIds:{}}),d[s].hasAnticipo+="credit"===(null===(i=l[e])||void 0===i?void 0:i.type)?1*l[e].amount:-1*l[e].amount,d[s].saldo+=-1*("credit"===(null===(o=l[e])||void 0===o?void 0:o.type)?1*l[e].amount:-1*l[e].amount),d[s].comprobanteIds[l[e].comprobanteId]={date:l[e].date,description:l[e].description}})),d},v=e=>{let i=[],l=(0,o._U)((0,o.bh)("invoices_list"),"document");(0,o.sO)(e)&&(e=JSON.parse(e)),console.log({docM:l}),e.map((e=>{let d={...e},s=new Date("05/14/2024").getTime();if(d.date>s&&(d.invoiceId=(0,o.M5)(),d.invoiceLinkConfirmed&&d.amount&&d.document&&!l[d.document])){var n,a;let e={...null===(n=(0,o.bh)((0,o.hQ)()))||void 0===n?void 0:n.add_invoice};e.params={businessId:null===(a=(0,o.bh)("profileUser"))||void 0===a?void 0:a.businessId},e.form=d,i.push(e)}})),(0,o.DF)(i,u)},u=async e=>{const i=(0,o.I7)(e),l=await i;if(l)return l}},1534:()=>{},3971:()=>{},261:()=>{}}]);
//# sourceMappingURL=2086.decc17e8.chunk.js.map