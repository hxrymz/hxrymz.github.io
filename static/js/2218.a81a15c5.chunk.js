"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[2218],{2064:(e,t,o)=>{o.r(t),o.d(t,{default:()=>_});var a=o(2791),i=o(2350),l=(o(1e3),o(2647)),d=o(3588),s=o(6963),n=o(4e3);let r=0,c=null,b=null;const u=async e=>{const t=await s.PDFDocument.create();if(t.registerFontkit(n.Z),c=await t.embedFont(s.StandardFonts.TimesRoman,{subset:!0}),b=await t.embedFont(s.StandardFonts.TimesRomanBold,{subset:!0}),(0,i.bh)("modernFontReport")){let e=(0,i.bh)("Roboto-Bold.ttf"),o=(0,i.bh)("ggSans-Italic.ttf"),a=(0,i.bh)("ggSans-Medium.ttf");const l=await fetch(e).then((e=>e.arrayBuffer()));b=await t.embedFont(l,{subset:!0});await fetch(o).then((e=>e.arrayBuffer()));const d=await fetch(a).then((e=>e.arrayBuffer()));c=await t.embedFont(d,{subset:!0})}let o=t.addPage();const{width:a,height:l}=o.getSize(),d=10;let u=0,m=44;r=l-40,o.drawText(e.entryName||"Comprobante Manual",{x:50,y:r,size:14,font:b,color:(0,s.rgb)(0,0,0)});const v=b.widthOfTextAtSize(e.comprobanteId,14),p=c.widthOfTextAtSize("Comprobante:  ",13);o.drawText("Comprobante:  ",{x:580-p-v,y:r,size:13,font:c,color:(0,s.rgb)(0,0,0)}),o.drawText(e.comprobanteId+"",{x:580-v,y:r,size:14,font:b,color:(0,s.rgb)(0,0,0)}),r-=25;const x=c.widthOfTextAtSize("Fecha:  ",13),h=b.widthOfTextAtSize((0,i.Gv)(e.date)+"",14);o.drawText("Fecha:  ",{x:580-x-h,y:r,size:13,font:c,color:(0,s.rgb)(0,0,0)}),o.drawText((0,i.Gv)(e.date)+"",{x:580-h,y:r,size:14,font:b,color:(0,s.rgb)(0,0,0)}),r-=15;let y=(null===e||void 0===e?void 0:e.operations)||[];r-=18,o.drawText("Cuenta",{x:20,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)}),o.drawText("Sub Cuenta",{x:205,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)}),o.drawText("Documento",{x:360,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)});const f=b.widthOfTextAtSize("Debito",13);o.drawText("Debito",{x:500-f,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)});const _=b.widthOfTextAtSize("Credito",13);o.drawText("Credito",{x:580-_,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)}),r-=8,o.drawRectangle({x:15,y:r+1,width:570,height:.95,color:(0,s.rgb)(0,0,0),borderColor:(0,s.rgb)(0,0,0)});let g=Math.ceil(y.length/40);Array.from(Array(g).keys()).map((e=>{if(e>0){o=t.addPage(),r=l-26,o.drawText("Cuenta",{x:20,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)}),o.drawText("Sub Cuenta",{x:205,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)}),o.drawText("Documento",{x:360,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)});const e=b.widthOfTextAtSize("Debito",13);o.drawText("Debito",{x:500-e,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)});const a=b.widthOfTextAtSize("Credito",13);o.drawText("Credito",{x:580-a,y:r,size:13,font:b,color:(0,s.rgb)(0,0,0)}),r-=8,o.drawRectangle({x:15,y:r+1,width:570,height:.95,color:(0,s.rgb)(0,0,0),borderColor:(0,s.rgb)(0,0,0)}),r-=2}let a=y.slice(u,m);e>0&&(u=m+1,m=u+48),Array.isArray(a)&&a.map(((e,t)=>{var a,i,l,n,b;(r-=16,null!==e&&void 0!==e&&null!==(a=e.account)&&void 0!==a&&a.name)&&o.drawText((null===e||void 0===e||null===(b=e.account)||void 0===b?void 0:b.name)+"",{x:20,y:r,size:d,font:c,color:(0,s.rgb)(0,0,0)});if(null!==e&&void 0!==e&&null!==(i=e.sub_account)&&void 0!==i&&i.subAccountName){var u;let t=null===e||void 0===e||null===(u=e.sub_account)||void 0===u?void 0:u.subAccountName.substring(0,32);o.drawText(t+"",{x:205,y:r,size:d,font:c,color:(0,s.rgb)(0,0,0)})}o.drawText((null===e||void 0===e?void 0:e.document)+"",{x:360,y:r,size:d,font:c,color:(0,s.rgb)(0,0,0)});let m=null!==e&&void 0!==e&&e.debit?null===(l=1*(null===e||void 0===e?void 0:e.debit))||void 0===l?void 0:l.toFixed(2):"0.00";const v=c.widthOfTextAtSize(m+"",d);o.drawText(m+"",{x:500-v,y:r,size:d,font:c,color:(0,s.rgb)(0,0,0)});let p=null!==e&&void 0!==e&&e.credit?null===(n=1*(null===e||void 0===e?void 0:e.credit))||void 0===n?void 0:n.toFixed(2):"0.00";const x=c.widthOfTextAtSize(p+"",d);o.drawText(p+"",{x:580-x,y:r,size:d,font:c,color:(0,s.rgb)(0,0,0)})}))})),r-=28,o.drawRectangle({x:15,y:r+1,width:570,height:.85,color:(0,s.rgb)(0,0,0),borderColor:(0,s.rgb)(0,0,0)}),r-=18,o.drawText("Detalles: ",{x:50,y:r,size:12,font:c,color:(0,s.rgb)(0,0,0)}),r-=18,o.drawText(e.description?e.description:"",{x:70,y:r,size:11,font:c,color:(0,s.rgb)(0,0,0)});let w=function(e){let t=new Blob([e],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(t)}(await t.save());window.open(w)};var m=o(9760),v=o(2692),p=o(2502),x=o(184);const h=(0,l.JC)(),y=(0,v.dz)(),f=(0,l.PU)(),_=e=>{var t,o,l,s,n;let{data:r,item:c}=e;const[b,m]=(0,a.useState)(!1),[v,h]=(0,a.useState)(0);(0,a.useEffect)((()=>{if(!b){var e;if(m(!0),null!==c&&void 0!==c&&c.employeeId)null!==(e=(0,i.bh)("employees_ids"))&&void 0!==e&&e[null===c||void 0===c?void 0:c.employeeId]||(0,p.Dy)(y);h((0,i.M5)())}}));const y=()=>{h((0,i.M5)())};let _=null===(t=(0,i.bh)("employees_ids"))||void 0===t||null===(o=t[null===c||void 0===c?void 0:c.employeeId])||void 0===o?void 0:o.name,w=1*(null===(l=c.balance)||void 0===l?void 0:l.toFixed(2))!==0;return(0,x.jsxs)("div",{style:{maxHeight:"96vh",minHeight:"90vh",width:"960px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,x.jsx)("div",{className:"_dsplFlx ",children:(0,x.jsx)("div",{className:"flexSpace"})}),(0,x.jsxs)("div",{className:"_dsplFlx ",children:[(0,x.jsxs)("div",{className:"_dsplFlx",style:{marginTop:20},children:[(0,x.jsx)("div",{className:"desc_lbl",children:"Comprobante:"}),(0,x.jsx)("div",{className:"name comprobante_id",style:w?{color:"var(--hrm_palette-selected-nav-text)"}:{},children:null===c||void 0===c?void 0:c.comprobanteId})]}),w?(0,x.jsx)("div",{className:"msg_alert",children:(0,x.jsxs)("div",{className:"msg_alert_title",children:["El comprobante no esta cuadrado ",null===c||void 0===c||null===(s=c.balance)||void 0===s?void 0:s.toFixed(2)]})}):null,(0,x.jsx)("div",{className:"flexSpace"}),(0,x.jsx)("div",{className:"icon",onClick:()=>{var e;let t=[];c.operations&&(null===(e=c.operations)||void 0===e||e.map(((e,o)=>{let a={...e};a.description=c.description,a.comprobanteId=c.comprobanteId,a.date=(0,i.sJ)(c.date),a.description=c.description;let l=e.account.code+" - "+e.account.name;if(a.account=l,a.sub_account){let t=e.sub_account.subAccount+" - "+e.sub_account.subAccountName;a.sub_account=t}t.push(a)}))),(0,i.eY)("export_compobante_"+c.comprobanteId+"_"+(0,i.M5)()+".csv",t)},style:{marginRight:17},children:(0,x.jsx)(f,{name:"google-spreadsheet",color:"#282828"})}),(0,x.jsx)("div",{className:"icon",onClick:()=>{u(c)},children:(0,x.jsx)(f,{name:"printer",color:"#282828"})})]}),(0,x.jsxs)("div",{className:"_dsplFlx cmp_dtls",children:[(0,x.jsx)("div",{className:"flexSpace"}),(0,x.jsxs)("div",{className:"_dsplFlx",children:[(0,x.jsx)("div",{className:"desc_lbl"}),(0,x.jsx)("div",{className:"name",children:(0,i.sG)(null===c||void 0===c?void 0:c.date)})]})]}),(0,x.jsxs)("div",{className:"_dsplFlx hdr_bar purple",children:[(0,x.jsx)("div",{className:"tr_bar_15",children:"Cuenta"}),(0,x.jsx)("div",{className:"tr_bar_15",children:"Sub Cuenta"}),(0,x.jsx)("div",{className:"tr_bar_40",children:"Documento"}),(0,x.jsx)("div",{className:"tr_bar_15",children:"Debito"}),(0,x.jsx)("div",{className:"tr_bar_15",children:"Credito"})]}),null===(n=(0,d.Eb)(null===c||void 0===c?void 0:c.operations))||void 0===n?void 0:n.map(((e,t)=>(0,x.jsx)(g,{element:e,in2D:t},t))),(0,x.jsxs)("div",{className:"cmp_desc",children:[(0,x.jsx)("div",{className:"desc_lbl",children:"Detalles:"}),(0,x.jsxs)("div",{className:"description",children:[null===c||void 0===c?void 0:c.description," ",_]})]}),(0,x.jsxs)("div",{className:"_dsplFlx cmp_dtls",children:[(0,x.jsx)("div",{className:"flexSpace"}),(0,x.jsx)("span",{className:"entryType",children:c.entryName||"Comprobante Manual"})]})]})},g=e=>{var t,o;let{element:a,in2D:l}=e;return(0,x.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,x.jsx)("div",{className:"tr_bar_15",children:(0,x.jsx)(h,{data:a.account,labelField:"code",infoField:"name"})}),(0,x.jsx)("div",{className:"tr_bar_15",children:(0,x.jsx)(h,{data:a.sub_account,labelField:"subAccount",infoField:"subAccountName"})}),(0,x.jsx)("div",{className:"tr_bar_40",onClick:()=>{var e;if(null!==(e=(0,i.Ch)()[(0,i.bh)("date_current_year")])&&void 0!==e&&e.isClosed);else if((0,i.ML)()){let e=(0,i.bh)("lastTimeCallModal")||0;if(Date.now()>e){let e=["document","amount","type","description","account","subAccount","comprobanteId"],t=(0,i.Ld)({...(0,i.bh)("comprobante_list")[a.operationId]},e);(0,i.Rz)("upd_comprobantebyId",t),(0,i.Rz)("upd_comprobantebyId_bck",JSON.parse(JSON.stringify(t))),(0,i.Rz)("lastTimeCallModal",Date.now()+320);let o={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};o.content=(0,x.jsx)(y,{confirm:()=>{},item:a}),(0,m.OpenModal)(o)}}},children:a.document}),(0,x.jsx)("div",{className:"tr_bar_15",children:null===(t=1*a.debit)||void 0===t?void 0:t.toFixed(2)}),(0,x.jsx)("div",{className:"tr_bar_15",children:null===(o=1*a.credit)||void 0===o?void 0:o.toFixed(2)})]},l)}},2502:(e,t,o)=>{o.d(t,{Dy:()=>i,kQ:()=>l,lG:()=>d});var a=o(2350);const i=async e=>{var t,o;let i={...null===(t=(0,a.bh)((0,a.hQ)()))||void 0===t?void 0:t.all_employee};i.params={businessId:null===(o=(0,a.bh)("profileUser"))||void 0===o?void 0:o.businessId};const l=(0,a.I7)(i),d=await l;d&&((0,a.Rz)("employees_list",s((0,a.jQ)(d),"code")),(0,a.Rz)("employees_ids",(0,a.ME)((0,a.jQ)(d),"employeeId")),e&&e())},l=async e=>{var t,o;let i={...null===(t=(0,a.bh)((0,a.hQ)()))||void 0===t?void 0:t.search_employee};i.params={businessId:null===(o=(0,a.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search":(0,a.bh)("searchQry")};const l=(0,a.I7)(i),d=await l;d&&((0,a.Rz)("employees_list",s((0,a.jQ)(d),"code")),e&&e())},d=async(e,t)=>{var o,i,l,d;let s={...null===(o=(0,a.bh)((0,a.hQ)()))||void 0===o?void 0:o.filter_search_opera};s.params={businessId:null===(i=(0,a.bh)("profileUser"))||void 0===i?void 0:i.businessId,year:(0,a.bh)("date_current_year"),":date1":(null===(l=(0,a.bh)("date_range_comps"))||void 0===l?void 0:l.initDate)-10,":date2":null===(d=(0,a.bh)("date_range_comps"))||void 0===d?void 0:d.lastDate,":search0":e};const n=(0,a.I7)(s),r=await n;r&&!r.error&&((0,a.Rz)("paystub_submayor_list",r),(0,a.Rz)("paystub_submayor_group",function(e){var t={};e.length>0?e.map((e=>{let o=e.date+"_"+e.comprobanteId;if(!t[o]){t[o]={},["date","description","entryName","comprobanteId","employeeId","document"].forEach((a=>{t[o][a]=e[a]})),t[o].amount=0,t[o].balance=0,t[o].operations=[]}e.type&&(t[o].balance=1*(0,a.Zv)(t[o].balance,2)+("debit"===e.type?1*(0,a.Zv)(e.amount,2):0),t[o].operations.push(function(e){var t;let o={};o.employeeId=null===(t=(0,a.bh)("employees_ids"))||void 0===t?void 0:t[e.employeeId],o.comprobanteId=e.comprobanteId,o.operationId=e.operationId,o.document=e.document,o.date=e.date,"credit"===e.type?(o.debit=0,o.credit=e.amount):"debit"===e.type&&(o.credit=0,o.debit=e.amount);return o}(e)))})):t=null;return t}((0,a.jQ)(r)))),t&&t()};const s=(e,t)=>(0,a.MV)("sortEmployees",[e],(()=>e&&e.sort(((e,o)=>{let a=1*e[t],i=1*o[t];return a<i?-1:a>i?1:0}))))},1e3:()=>{}}]);
//# sourceMappingURL=2218.a81a15c5.chunk.js.map