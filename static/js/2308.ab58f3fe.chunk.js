"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[2308],{62:(s,e,l)=>{l.r(e),l.d(e,{default:()=>f});var o=l(2791),i=l(2350),n=l(2647),d=l(9760),a=(l(7889),l(24)),t=l(713),r=l(4050),c=(l(1534),l(184));const v=(0,n.Jo)(),p=(0,n.PU)(),u=s=>{let{data:e,confirm:l,label:i,item:n}=s;const{modalID:a}=e,[t,r]=(0,o.useState)(1),u=s=>{(0,d.CloseModal)({id:a})};return(0,c.jsxs)("div",{style:{maxHeight:"60vh",minHeight:"28vh",width:"560px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("p",{className:"code_prod_header",children:null===n||void 0===n?void 0:n.productCode}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("p",{className:"lbl_prod_header",children:null===n||void 0===n?void 0:n.name})]}),(0,c.jsxs)("div",{className:"_dsplFlx ",style:{padding:9},children:[(0,c.jsx)("div",{children:(0,c.jsx)(v,{src:null===n||void 0===n?void 0:n.imageUrl,width:150,fontSize:[12,16]})}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsxs)("div",{className:"_dsplFlx btns_control_2cart",children:[t-1>0?(0,c.jsx)("div",{className:"iconFlx ",children:(0,c.jsx)("div",{onClick:()=>{t-1>=0&&r((s=>s-1))},children:(0,c.jsx)(p,{name:"minus",color:"#80868b",size:48})})}):(0,c.jsx)("div",{className:"iconFlx ",children:(0,c.jsx)("div",{style:{width:52}})}),(0,c.jsx)("div",{className:"iconFlx lbl_prod_amount",children:t}),(0,c.jsx)("div",{className:"iconFlx",children:(0,c.jsx)("div",{onClick:()=>{r((s=>s+1))},children:(0,c.jsx)(p,{name:"plus",color:"#80868b",size:48})})})]})]}),(0,c.jsxs)("div",{className:"_dsplFlx ",style:{padding:"1px 10px"},children:[(0,c.jsxs)("p",{className:"lbl_prod_price",children:["$",null===n||void 0===n?void 0:n.price]}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("div",{className:"iconFlx",children:(0,c.jsx)("p",{className:"group_title addBtn iconFlx",onClick:u,children:"Cancelar"})}),(0,c.jsx)("div",{className:"iconFlx",children:(0,c.jsx)("p",{className:"group_title addBtn purple iconFlx",onClick:()=>{l({productId:n.productId,amount:t,productName:n.name}),u()},children:"Agregar"})})]})]})]})};var h=l(15),m=l(6824);const b=(0,n.Vg)(),x=(0,a.Qz)(),_=(0,a.O6)(),I=((0,a.$d)(),(0,a.Y3)()),y=(0,n.Jo)(),j="coll2listprods",f=s=>{var e,l,n;let{data:a,elmId:v,updObs:p}=s;const[f,g]=(0,o.useState)(!1),[N,k]=(0,o.useState)(0),[Q,z]=(0,o.useState)(0),[R,w]=(0,o.useState)(!1),[F,C]=(0,o.useState)(128);(0,o.useEffect)((()=>{f||(g(!0),k((0,i.M5)()),(0,i.Rz)("products_list",null),(0,r.Ht)("global_accounts","global_account_params",p),S())}));const U=()=>{},B=s=>{(0,i.Rz)("products_list",null),S()},M=s=>{(0,h.OpenToast)({text:s.productName+"  added to cart",timeout:1500})},S=()=>{let s={...(0,i.bh)("products_list")};(0,i.Rz)(j,s),(async(s,e)=>{k((0,i.M5)()),w(!1)})()},q=s=>{(0,m.M9)(s)},V=s=>{let e=s.list;(0,i.eY)("export_products__"+(0,i.M5)()+".csv",e)};return(0,c.jsxs)("div",{className:"",children:[(0,c.jsxs)("div",{className:"accounts_header",children:[(0,c.jsx)("h2",{children:"Products"}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,i.I0)()?(0,c.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>{let s={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};s.content=(0,c.jsx)(x,{}),(0,d.OpenModal)(s)},children:"Agregar Producto"}):null,(0,i.bh)("profileUser").isAdmin?(0,c.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>z(!Q),children:"Cambiar Vista"}):null,(0,i.I0)()?(0,c.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>{(0,t.qT)(q)},children:"Listar Inventario"}):null,(0,i.I0)()?(0,c.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>{(0,t.qT)(V)},children:"Exportar Inventario"}):null,(0,i.I0)()?(0,c.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:s=>{let e={zIndex:450,height:"90vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,c.jsx)(I,{item:s,confirm:M}),(0,d.OpenModal)(e)},children:"Comparar Inventario"}):null]})]}),(0,c.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,c.jsx)(b,{placeholder:"Buscar ....",width:560,obs:k,fetchData:s=>{w(!0),(0,t.Ve)(S)},loading:R,change:s=>{!R&&w(!0)},callempty:B,keyFlds:"searchQry"}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("div",{className:"total_comprobante_title",children:"No de Productos:"}),(0,c.jsx)("div",{className:"total_comprobante gray",children:(0,c.jsx)("span",{children:null===(e=(0,i._2)((0,i.bh)("products_list")))||void 0===e?void 0:e.length})})]})]}),Q?(0,c.jsx)("div",{className:"products_container scollVh FlexList ",children:(0,i.bh)(j)&&(null===(l=(0,t.B8)((0,i.bh)(j),F))||void 0===l?void 0:l.map((s=>{let e=(0,i.bh)(j)[s];return(0,c.jsx)("div",{style:{padding:9},onClick:()=>(s=>{let e={zIndex:450,height:"90vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,c.jsx)(u,{item:s,confirm:M}),(0,d.OpenModal)(e)})(e),children:(0,c.jsx)(y,{src:null===e||void 0===e?void 0:e.imageUrl,width:160,lbl:null===e||void 0===e?void 0:e.name,fontSize:[12,16]},s)})})))}):(0,c.jsxs)("div",{className:"products_container scollVh",children:[(0,i.bh)(j)&&(null===(n=(0,t.B8)((0,i.bh)(j),F))||void 0===n?void 0:n.map((s=>(0,c.jsx)(_,{data:(0,i.bh)(j)[s],elmId:s,openUpdateView:U,handleRefreshAll:B,updRvw:k},s)))),(0,i.bh)(j)&&(0,i._2)((0,i.bh)(j),F).length>F?(0,c.jsxs)("div",{className:"_dsplFlx ",style:{margin:"15px 0 35px"},children:[(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>{C((s=>s+128))},children:"Cargar Mas"}),(0,c.jsx)("div",{className:"flexSpace"})]}):null]})]})}},713:(s,e,l)=>{l.d(e,{$P:()=>u,B8:()=>_,IR:()=>t,QJ:()=>p,Rd:()=>d,VI:()=>x,Ve:()=>v,WA:()=>b,ZW:()=>n,Zj:()=>h,ii:()=>c,nj:()=>m,qT:()=>a,qv:()=>r,yk:()=>i});var o=l(2350);const i=async s=>{var e,l;let i={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.scan_voucher_production};if(i.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId,limit:120},(0,o.bh)("searchVoucherQry")&&(0,o.bh)("searchVoucherQry").length>1){(0,o.bh)("searchVoucherQry").split(" ").map(((s,e)=>{s&&(i.params[":search"+e]=s.trim())}));const e=(0,o.I7)(i),l=await e;l&&((0,o.Rz)("voucher_production",l),(0,o.Rz)("vouchers_list",h((0,o.jQ)(l),"voucherId")),s&&s())}else(0,o.Rz)("vouchers_list",null),s&&s()},n=async(s,e)=>{var l,i;let n={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.get_inventory_prod};n.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,":productId":s};const d=(0,o.I7)(n),a=await d;a&&((0,o.Rz)("inv_products_list",h((0,o.jQ)(a.list),"name")),(0,o.Rz)("inv_products_stock",a.stock),e&&e())},d=async(s,e)=>{var l,i;let n={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.get_prod_stock};n.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,productId:s};const d=(0,o.I7)(n),a=await d;if(a){let l={...(0,o.bh)("products_stock")};l[s]=a.stock,(0,o.Rz)("products_stock",l),e&&e()}},a=async s=>{var e,l;let i={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prods};i.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId},i.subQuerys={},i.subQuerys.stock=1;const n=(0,o.I7)(i),d=await n;if(d){let e={},l=[],i=0;d.map((s=>{var n;if(null!==s&&void 0!==s&&null!==(n=s.inventory)&&void 0!==n&&n.qty){var d,a,t;if(i+=1*(0,o.Zv)(null===s||void 0===s||null===(d=s.inventory)||void 0===d?void 0:d.amount,2),e[s.unit])e[s.unit]+=null===s||void 0===s||null===(a=s.inventory)||void 0===a?void 0:a.qty;else e[s.unit]=null===s||void 0===s||null===(t=s.inventory)||void 0===t?void 0:t.qty;l.push({productId:s.productId,name:s.name,unit:s.unit,qty:(1*s.inventory.qty).toFixed(2),amount:(1*s.inventory.amount).toFixed(2),cost:(s.inventory.amount/s.inventory.qty*1).toFixed(2)})}})),(0,o.Ey)(s)&&s({list:h(l,"name"),total:i,units:e})}},t=async(s,e)=>{var l,i;let n={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.group_prod_stock};n.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId};const d=(0,o.I7)(n),a=await d;if(a){let l=(0,o._I)(a.comps),i=0,n=0,d=0,t=[],r=[];(0,o._2)(s).map((e=>{let c={...s[e]},v=("debit"===s[e].type?1:-1)*s[e].amount,p=1*(0,o.Zv)(v,2);if(i+=p,a.comps[s[e].comprobanteId]){c.inventory=a.comps[s[e].comprobanteId];let i=0;if((0,o._2)(a.comps[s[e].comprobanteId]).map((l=>{i=1*(0,o.Zv)(i,2)+1*(0,o.Zv)(a.comps[s[e].comprobanteId][l],2)})),i=i<0?-1*i:i,i=1*(0,o.Zv)(i,2),c.inventoryAmount=i,n+=i,p=p<0?-1*p:p,p-i!==0){let s=p-i;d+=s,r.push(c),console.log("diff",c,p,i,s)}else t.push(c);delete l[s[e].comprobanteId]}else d+=v,r.push(c)}));let c=0;(0,o._2)(l).map((s=>{let e=0;(0,o._2)(l[s]).map((i=>{e=1*(0,o.Zv)(e,2)+1*(0,o.Zv)(l[s][i],2)})),c+=e})),console.log("inventoryBack",l,"inventoryBackTotal",c),(0,o.Rz)("inv_comprobantes_compare",{hasError:r,success:t,inventoryBack:l}),(0,o.Ey)(e)&&e()}},r=async s=>{var e,l,i;let n={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.filter_search_opera};n.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId,year:(0,o.bh)("date_current_year"),":account":null===(i=(0,o.bh)("global_account_params"))||void 0===i?void 0:i.inventory.account};const d=(0,o.I7)(n),a=await d;a&&!a.error&&(0,o.Ey)(s)&&s(h((0,o.jQ)(a),"date"))},c=async s=>{var e,l;let i={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prods};i.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId};const n=(0,o.I7)(i),d=await n;d&&((0,o.Rz)("products_list",h(d,"name")),(0,o.Rz)("products_ids",(0,o.ME)((0,o.jQ)(d),"productId")),s&&s())},v=async s=>{var e,l;let i={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.search_prod};if(i.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId,limit:120},(0,o.bh)("searchQry").length>1){(0,o.bh)("searchQry").split(" ").map(((s,e)=>{s&&(i.params[":search"+e]=s.trim())}));const e=(0,o.I7)(i),l=await e;l&&((0,o.Rz)("products_list",h((0,o.jQ)(l),"code")),s&&s())}else(0,o.Rz)("products_list",null),s&&s()},p=async s=>{var e,l;let i={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_entry_invoices};i.params={businessId:null===(l=(0,o.bh)("profileUser"))||void 0===l?void 0:l.businessId};const n=(0,o.I7)(i),d=await n;d&&((0,o.Rz)("movements_list",h(d,"date")),(0,o.Rz)("movements_ids",(0,o.ME)((0,o.jQ)(d),"inventoryId")),s&&s())},u=async s=>{var e;if((null===(e=(0,o.bh)("searchMovQry"))||void 0===e?void 0:e.length)>1){var l,i;let e={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.search_inventory};e.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,":search0":(0,o.bh)("searchMovQry")};const n=(0,o.I7)(e),d=await n;d&&((0,o.Rz)("movements_list",function(s){var e={};let l=s&&(0,o._2)(s);l.length>0?l.map((l=>{let o=s[l];e[o.comprobanteId]||(e[o.comprobanteId]={},e[o.comprobanteId].amount=0,e[o.comprobanteId].document=o.document,e[o.comprobanteId].date=o.date,e[o.comprobanteId].comprobanteId=o.comprobanteId,e[o.comprobanteId].products=[]),e[o.comprobanteId].amount+=o.qty*o.price,e[o.comprobanteId].products.push({productId:o.productId,qty:o.qty,price:o.price,inventoryId:o.inventoryId})})):e=null;return e}(d)),(0,o.Rz)("movements_ids",d),s&&s())}else(0,o.Rz)("movements_list",[]),(0,o.Rz)("movements_ids",{}),s&&s()};const h=(s,e)=>(0,o.MV)("sortProducts",[s],(()=>s&&s.sort(((s,l)=>{let o=s[e],i=l[e];return o<i?-1:o>i?1:0})))),m=async(s,e)=>{var l,i;let n={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.delete_prod};n.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,productId:s};const d=(0,o.I7)(n);await d&&e&&e()},b=async(s,e)=>{var l,i;let n={...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.delete_inventory};n.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,inventoryId:s};const d=(0,o.I7)(n);await d&&e&&e()},x=async(s,e)=>{var l,i;({...null===(l=(0,o.bh)((0,o.hQ)()))||void 0===l?void 0:l.entry_invoice_acc_2}).params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,entriesInvoiceId:s}},_=(s,e)=>(0,o.MV)("rangeProdArr",[s,e],(()=>s?(0,o._2)(s).slice(0,e):[]))},7889:()=>{},1534:()=>{}}]);
//# sourceMappingURL=2308.ab58f3fe.chunk.js.map