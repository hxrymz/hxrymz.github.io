"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[3264,9760],{9760:(e,i,l)=>{l.r(i),l.d(i,{CloseModal:()=>c,OpenModal:()=>r,default:()=>n});var s=l(2791),t=l(5408),d=l(2350),o=l(184);const a="listDialog_mdh392",n=()=>{const e=(0,d.bh)("listDialog")||{};(0,t.Z)(a);let i=Object.keys(e);return(0,o.jsx)(o.Fragment,{children:i.map(((i,l)=>{let t=e[i];if(t&&t.visible){let e={};t.height&&(e.heigth=t.height),t.width,t.zIndex&&(e.zIndex=t.zIndex-1);let l={zIndex:t.zIndex},d=null,a=t.data;return t.content&&(d=s.cloneElement(t.content,{data:a})),(0,o.jsxs)("div",{className:"ltr-1kbnjow",style:e,children:[(0,o.jsx)("div",{className:"ltr-hoe9xz",children:(0,o.jsx)("div",{className:"ltr-1wao6ny",style:l,id:i,children:d})}),t.data.overlay?(0,o.jsx)("div",{className:"DialogHRMOverlay ".concat(t.visible?"active":""),onClick:()=>{var e;e=i,document.getElementsByTagName("html")[0].classList.remove("has-level-two"),c({id:e})}}):null]},i)}}))})},r=e=>{let i=(0,d.bh)("listDialog")||{},l=(0,d.M5)();i[l]||(i[l]={}),i[l].visible=!0;let s={};e.props?(s=e.props,s.modalID=l):s.modalID=l;let t=document.getElementsByTagName("body")[0];null!==t&&void 0!==t&&t.style&&(t.style.overflowY="hidden"),i[l].isView=e.isView,i[l].observeResize=e.observeResize,i[l].observeResize&&(i[l].observeInterval=setInterval((()=>{let e=document.querySelector("[dialog-key-id='".concat(l,"']")),s=e&&e.getBoundingClientRect();s&&(s.width===i[l].width&&s.height===i[l].height||(i[l].height=s.height+10,i[l].width=s.width,(0,d.Rz)("listDialog",i),(0,d.wt)(a)))}),200)),i[l].display=!0,e.zIndex&&(i[l].zIndex=e.zIndex),e.height&&(i[l].height=e.height),e.width&&(i[l].width=e.width),e.content&&(i[l].content=e.content),i[l].data=s,(0,d.Rz)("listDialog",i),(0,d.wt)(a),setTimeout((()=>{document.getElementsByTagName("html")[0].classList.add("has-level-two"),(0,d.Rz)("modalOpen",l),(0,d.wt)(a)}),125)},c=e=>{let i=(0,d.bh)("listDialog")||{},l=e.id;if(i[l]){var s,t,o;i[l].observeResize&&i[l].observeInterval&&clearInterval(i[l].observeInterval),i[l].display=!1,null===(s=i[l])||void 0===s||null===(t=s.data)||void 0===t||null===(o=t.closeEvent)||void 0===o||o.call(t),(0,d.Rz)("listDialog",i),delete i[l],document.getElementsByTagName("body")[0].style.overflowY=null,(0,d.wt)(a),setTimeout((()=>{delete i[l],document.getElementsByTagName("html")[0].classList.remove("has-level-two"),(0,d.Rz)("modalOpen",null)}),750)}}},713:(e,i,l)=>{l.d(i,{$P:()=>b,B8:()=>j,IR:()=>u,N0:()=>d,QJ:()=>m,Rd:()=>r,VI:()=>y,Ve:()=>p,WA:()=>I,ZW:()=>n,Zj:()=>x,fK:()=>o,g5:()=>t,ii:()=>h,nj:()=>_,qT:()=>c,qv:()=>v,yk:()=>a});var s=l(2350);const t={WH:"Almacen",PR:"Production",PT:"Patio"},d=async e=>{var i,l;let t={...null===(i=(0,s.bh)((0,s.hQ)()))||void 0===i?void 0:i.scan_area_location};t.params={businessId:null===(l=(0,s.bh)("profileUser"))||void 0===l?void 0:l.businessId,limit:120};const d=(0,s.I7)(t),o=await d;o?((0,s.Rz)("locations_ids",o),(0,s.Rz)("locations_list",x((0,s.jQ)(o),"areaLocationId")),e&&e()):e&&e()},o=async(e,i)=>{var l,t;let d={...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.scan_voucher_production};d.params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId,":search0":e};const o=(0,s.I7)(d),a=await o;a&&!a.error&&(0,s._2)(a)&&(0,s._2)(a).length>0?i&&i(a):i&&i(null)},a=async e=>{var i,l;let t={...null===(i=(0,s.bh)((0,s.hQ)()))||void 0===i?void 0:i.scan_voucher_production};if(t.params={businessId:null===(l=(0,s.bh)("profileUser"))||void 0===l?void 0:l.businessId,limit:120},(0,s.bh)("searchVoucherQry")&&(0,s.bh)("searchVoucherQry").length>1){(0,s.bh)("searchVoucherQry").split(" ").map(((e,i)=>{e&&(t.params[":search"+i]=e.trim())}));const i=(0,s.I7)(t),l=await i;l&&((0,s.Rz)("voucher_production",l),(0,s.Rz)("vouchers_list",x((0,s.jQ)(l),"voucherId")),e&&e())}else(0,s.Rz)("vouchers_list",null),e&&e()},n=async(e,i)=>{var l,t;let d={...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.get_inventory_prod};d.params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId,":productId":e};const o=(0,s.I7)(d),a=await o;a&&((0,s.Rz)("inv_products_list",x((0,s.jQ)(a.list),"name")),(0,s.Rz)("inv_products_stock",a.stock),i&&i())},r=async(e,i)=>{var l,t;let d={...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.get_prod_stock};d.params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId,productId:e};const o=(0,s.I7)(d),a=await o;if(a){let l={...(0,s.bh)("products_stock")};l[e]=a.stock,(0,s.Rz)("products_stock",l),i&&i()}},c=async e=>{var i,l;let t={...null===(i=(0,s.bh)((0,s.hQ)()))||void 0===i?void 0:i.all_prods};t.params={businessId:null===(l=(0,s.bh)("profileUser"))||void 0===l?void 0:l.businessId},t.subQuerys={},t.subQuerys.stock=1;const d=(0,s.I7)(t),o=await d;if(o){let i={},l=[],t=0;o.map((e=>{var d;if(null!==e&&void 0!==e&&null!==(d=e.inventory)&&void 0!==d&&d.qty){var o,a,n;if(t+=1*(0,s.Zv)(null===e||void 0===e||null===(o=e.inventory)||void 0===o?void 0:o.amount,2),i[e.unit])i[e.unit]+=null===e||void 0===e||null===(a=e.inventory)||void 0===a?void 0:a.qty;else i[e.unit]=null===e||void 0===e||null===(n=e.inventory)||void 0===n?void 0:n.qty;l.push({productId:e.productId,name:e.name,unit:e.unit,qty:(1*e.inventory.qty).toFixed(2),amount:(1*e.inventory.amount).toFixed(2),cost:(e.inventory.amount/e.inventory.qty*1).toFixed(2)})}})),(0,s.Ey)(e)&&e({list:x(l,"name"),total:t,units:i})}},u=async(e,i)=>{var l,t;let d={...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.group_prod_stock};d.params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId};const o=(0,s.I7)(d),a=await o;if(a){let l=(0,s._I)(a.comps),t=0,d=0,o=0,n=[],r=[];(0,s._2)(e).map((i=>{let c={...e[i]},u=("debit"===e[i].type?1:-1)*e[i].amount,v=1*(0,s.Zv)(u,2);if(t+=v,a.comps[e[i].comprobanteId]){c.inventory=a.comps[e[i].comprobanteId];let t=0;if((0,s._2)(a.comps[e[i].comprobanteId]).map((l=>{t=1*(0,s.Zv)(t,2)+1*(0,s.Zv)(a.comps[e[i].comprobanteId][l],2)})),t=t<0?-1*t:t,t=1*(0,s.Zv)(t,2),c.inventoryAmount=t,d+=t,v=v<0?-1*v:v,v-t!==0){let e=v-t;o+=e,r.push(c),console.log("diff",c,v,t,e)}else n.push(c);delete l[e[i].comprobanteId]}else o+=u,r.push(c)}));let c=0;(0,s._2)(l).map((e=>{let i=0;(0,s._2)(l[e]).map((t=>{i=1*(0,s.Zv)(i,2)+1*(0,s.Zv)(l[e][t],2)})),c+=i})),console.log("inventoryBack",l,"inventoryBackTotal",c),(0,s.Rz)("inv_comprobantes_compare",{hasError:r,success:n,inventoryBack:l}),(0,s.Ey)(i)&&i()}},v=async e=>{var i,l,t;let d={...null===(i=(0,s.bh)((0,s.hQ)()))||void 0===i?void 0:i.filter_search_opera};d.params={businessId:null===(l=(0,s.bh)("profileUser"))||void 0===l?void 0:l.businessId,year:(0,s.bh)("date_current_year"),":account":null===(t=(0,s.bh)("global_account_params"))||void 0===t?void 0:t.inventory.account};const o=(0,s.I7)(d),a=await o;a&&!a.error&&(0,s.Ey)(e)&&e(x((0,s.jQ)(a),"date"))},h=async e=>{var i,l;let t={...null===(i=(0,s.bh)((0,s.hQ)()))||void 0===i?void 0:i.all_prods};t.params={businessId:null===(l=(0,s.bh)("profileUser"))||void 0===l?void 0:l.businessId};const d=(0,s.I7)(t),o=await d;o&&((0,s.Rz)("products_list",x(o,"name")),(0,s.Rz)("products_ids",(0,s.ME)((0,s.jQ)(o),"productId")),e&&e())},p=async e=>{var i,l;let t={...null===(i=(0,s.bh)((0,s.hQ)()))||void 0===i?void 0:i.search_prod};if(t.params={businessId:null===(l=(0,s.bh)("profileUser"))||void 0===l?void 0:l.businessId,limit:120},(0,s.bh)("searchQry").length>1){(0,s.bh)("searchQry").split(" ").map(((e,i)=>{e&&(t.params[":search"+i]=e.trim())}));const i=(0,s.I7)(t),l=await i;l&&((0,s.Rz)("products_list",x((0,s.jQ)(l),"code")),e&&e())}else(0,s.Rz)("products_list",null),e&&e()},m=async e=>{var i,l;let t={...null===(i=(0,s.bh)((0,s.hQ)()))||void 0===i?void 0:i.all_entry_invoices};t.params={businessId:null===(l=(0,s.bh)("profileUser"))||void 0===l?void 0:l.businessId};const d=(0,s.I7)(t),o=await d;o&&((0,s.Rz)("movements_list",x(o,"date")),(0,s.Rz)("movements_ids",(0,s.ME)((0,s.jQ)(o),"inventoryId")),e&&e())},b=async e=>{var i;if((null===(i=(0,s.bh)("searchMovQry"))||void 0===i?void 0:i.length)>1){var l,t;let i={...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.search_inventory};i.params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId,":search0":(0,s.bh)("searchMovQry")};const d=(0,s.I7)(i),o=await d;o&&((0,s.Rz)("movements_list",function(e){var i={};let l=e&&(0,s._2)(e);l.length>0?l.map((l=>{let s=e[l];i[s.comprobanteId]||(i[s.comprobanteId]={},i[s.comprobanteId].amount=0,i[s.comprobanteId].document=s.document,i[s.comprobanteId].date=s.date,i[s.comprobanteId].comprobanteId=s.comprobanteId,i[s.comprobanteId].products=[]),i[s.comprobanteId].amount+=s.qty*s.price,i[s.comprobanteId].products.push({productId:s.productId,qty:s.qty,price:s.price,inventoryId:s.inventoryId})})):i=null;return i}(o)),(0,s.Rz)("movements_ids",o),e&&e())}else(0,s.Rz)("movements_list",[]),(0,s.Rz)("movements_ids",{}),e&&e()};const x=(e,i)=>(0,s.MV)("sortProducts",[e],(()=>e&&e.sort(((e,l)=>{let s=e[i],t=l[i];return s<t?-1:s>t?1:0})))),_=async(e,i)=>{var l,t;let d={...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.delete_prod};d.params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId,productId:e};const o=(0,s.I7)(d);await o&&i&&i()},I=async(e,i)=>{var l,t;let d={...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.delete_inventory};d.params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId,inventoryId:e};const o=(0,s.I7)(d);await o&&i&&i()},y=async(e,i)=>{var l,t;({...null===(l=(0,s.bh)((0,s.hQ)()))||void 0===l?void 0:l.entry_invoice_acc_2}).params={businessId:null===(t=(0,s.bh)("profileUser"))||void 0===t?void 0:t.businessId,entriesInvoiceId:e}},j=(e,i)=>(0,s.MV)("rangeProdArr",[e,i],(()=>e?(0,s._2)(e).slice(0,i):[]))},3264:(e,i,l)=>{l.r(i),l.d(i,{default:()=>N});var s=l(2791),t=l(2350),d=l(2647),o=(l(261),l(9760)),a=l(9661),n=l(184);const r=(0,d.Np)(),c=(0,d.PU)(),u=e=>{var i,l,d,o;let{updParent:a}=e;const[c,u]=(0,s.useState)(0),[v,h]=(0,s.useState)(!1),p=(e,i,l)=>{let s=(0,t.bh)("extraChargesInvoice")||{};l?(s[l]||(s[l]={}),s[l][e]=i):s[e]=i,(0,t.Rz)("extraChargesInvoice",s),u((0,t.M5)())};return(0,n.jsxs)("div",{children:[v?(0,n.jsx)("div",{className:"load_animation"}):(0,n.jsx)("div",{className:"",style:{maxWidth:130,marginLeft:7},children:(0,n.jsx)(r,{init:null===(i=(0,t.bh)("extraChargesInvoice"))||void 0===i?void 0:i.description,label:(0,t.zE)(4),width:750,updChanges:e=>p("description",e)})}),v?(0,n.jsxs)("div",{className:"_dsplFlx",children:[(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)("div",{className:"form_title",children:"Saving....."})]}):(0,n.jsxs)("div",{className:"_dsplFlx",children:[(0,n.jsx)(r,{init:null===(l=(0,t.bh)("extraChargesInvoice"))||void 0===l?void 0:l.salePrice,label:(0,t.zE)(14),width:120,type:"number",updChanges:e=>p("salePrice",e)}),(0,n.jsx)("div",{className:"flexSpace"}),null!==(d=(0,t.bh)("extraChargesInvoice"))&&void 0!==d&&d.description&&null!==(o=(0,t.bh)("extraChargesInvoice"))&&void 0!==o&&o.salePrice?(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("button",{onClick:()=>{h(!0);let e={...(0,t.bh)("extraChargesInvoice")}||{},i={...(0,t.bh)("extraChargesInvoiceList")}||{},l=(0,t.M5)();e.qty=1,i[l]=e,(0,t.Rz)("extraChargesInvoiceList",i),(0,t.Rz)("extraChargesInvoice",null),a((0,t.M5)()),setTimeout((()=>{h(!1)}),350)},children:(0,t.zE)(7)})}):null]})]})},v=e=>{var i,l;let{data:s,deleteItem:d,idKey:o}=e;null===(i=(0,t.bh)("account_ids"))||void 0===i||i[null===s||void 0===s?void 0:s.account],null===(l=(0,t.bh)("sub_account_ids"))||void 0===l||l[null===s||void 0===s?void 0:s.subAccount];return(0,n.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,n.jsx)("div",{className:"tr_bar tr_bar_80",style:{textAlign:"left"},children:null===s||void 0===s?void 0:s.description}),(0,n.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,t.Zv)(null===s||void 0===s?void 0:s.salePrice,2)}),(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)("div",{className:"icon",onClick:()=>{d(o)},children:(0,n.jsx)(c,{name:"outline_delete",color:"#c62828"})})]})},h=e=>{var i;let{updMain:l}=e;const[d,o]=(0,s.useState)(0),a=e=>{let i=(0,t.bh)("extraChargesInvoiceList")||{};delete i[e],(0,t.Rz)("extraChargesInvoiceList",i),l((0,t.M5)())};return(0,n.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,n.jsx)(u,{updParent:o}),(0,n.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,n.jsx)("div",{className:"tr_bar tr_bar_80",children:(0,t.zE)(4)}),(0,n.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,t.zE)(14)})]}),(0,t.bh)("extraChargesInvoiceList")&&(null===(i=(0,t._2)((0,t.bh)("extraChargesInvoiceList")))||void 0===i?void 0:i.map(((e,i)=>(0,n.jsx)(v,{idKey:e,data:(0,t.bh)("extraChargesInvoiceList")[e],deleteItem:a},e))))]})};var p=l(24),m=l(713);const b=(0,d.PU)(),x=(0,d.Np)(),_=(0,p.f_)(),I=(0,d.YZ)(),y=(0,a.FC)(),j=(0,p.Az)(),g="new_fatura_sale_comprobante",N=e=>{var i,l,d,a,r,c,u,v,p,m,b,y,j,N,k;let{data:w,confirm:R}=e;const[C,O]=(0,s.useState)(!1),[,M]=(0,s.useState)(0);(0,s.useEffect)((()=>{C||(O(!0),(0,t.Rz)("accountPicker",{}),M((0,t.M5)()))}));const A=(e,i,l)=>{let s=(0,t.bh)(g)||{};l?(s[l]||(s[l]={}),s[l][e]=i):s[e]=i,(0,t.Rz)(g,s),M((0,t.M5)())};let Q=null!==(i=(0,t.bh)(g))&&void 0!==i&&i.isAdvance?P((0,t.bh)("productListOnOut"),(0,t.bh)("extraChargesInvoiceList")):null===(l=(0,t.bh)(g))||void 0===l?void 0:l.totalAmount;return(0,n.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"58vh",width:"860px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,n.jsxs)("div",{className:"_dsplFlx ",children:[(0,n.jsx)("p",{className:"form_title",children:(0,t.zE)(1)}),(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:20},children:[(0,n.jsx)(I,{initvalue:null===(d=(0,t.bh)(g))||void 0===d?void 0:d.isAdvance,keyCode:57,updChange:e=>A("isAdvance",e)}),(0,n.jsx)("span",{className:"checklabel",children:"Avanzado"})]})]}),(0,n.jsxs)("div",{className:"_dsplFlx ",children:[(0,n.jsx)(_,{label:(0,t.zE)(3),init:null===(a=(0,t.bh)(g))||void 0===a?void 0:a.date,updDate:e=>A("date",e)}),(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)(x,{init:null===(r=(0,t.bh)(g))||void 0===r?void 0:r.document,label:(0,t.zE)(2),width:120,updChanges:e=>A("document",e)}),(0,n.jsx)("div",{className:"flexSpace"}),null!==(c=(0,t.bh)(g))&&void 0!==c&&c.isAdvance?(0,n.jsx)(x,{init:null===(u=(0,t.bh)(g))||void 0===u?void 0:u.hasTax,label:(0,t.zE)(16),width:120,updChanges:e=>A("hasTax",e)}):null,(0,n.jsx)("div",{className:"flexSpace"}),null!==(v=(0,t.bh)(g))&&void 0!==v&&v.isAdvance?(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"label",children:"Total"}),(0,n.jsx)("div",{className:"date2Upd",style:{marginRight:30},children:(Q||0).toFixed(2)})]}):(0,n.jsx)(x,{init:null===(p=(0,t.bh)(g))||void 0===p?void 0:p.totalAmount,label:"Monto",width:120,type:"number",updChanges:e=>A("totalAmount",e)})]}),null!==(m=(0,t.bh)(g))&&void 0!==m&&m.isAdvance?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 10px"},children:[(0,n.jsx)(f,{}),(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)(x,{init:null===(b=(0,t.bh)(g))||void 0===b?void 0:b.hasAdvancePay,label:(0,t.zE)(15),width:120,updChanges:e=>A("hasAdvancePay",e)})]}),(0,n.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)(x,{init:null===(y=(0,t.bh)(g))||void 0===y?void 0:y.description,label:(0,t.zE)(4),width:520,updChanges:e=>A("description",e)}),(0,n.jsx)("div",{className:"flexSpace"})]}),(0,n.jsx)(z,{updMain:M}),(0,n.jsx)(h,{updMain:M})]}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 10px"},children:[(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)(f,{}),(0,n.jsx)("div",{className:"flexSpace"})]}),(0,n.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 10px"},children:[(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)(x,{init:null===(j=(0,t.bh)(g))||void 0===j?void 0:j.clientName,label:"Nombe del cliente",width:420,updChanges:e=>A("clientName",e)}),(0,n.jsx)("div",{className:"flexSpace"})]})]}),(0,n.jsxs)("div",{className:"_dsplFlx ",children:[(0,n.jsx)("div",{className:"flexSpace"}),null!==(N=(0,t.bh)(g))&&void 0!==N&&N.document&&null!==(k=(0,t.bh)("customerOutPicker"))&&void 0!==k&&k.account&&Q>0?(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("button",{onClick:async()=>{var e,i,l,s,d,a;let n=(0,t.bh)(g),r=(new Date).getTime()+800;if(n.date){let e=new Date(n.date).getTime();r=e||r}n.date=r;let c=[],u=n.hasAdvancePay,v=n.hasTax,h=n.isAdvance;delete n.hasTax,delete n.hasAdvancePay;let p=0,m=0,b=[],x={...n},_=n.clientName?" "+n.clientName:"",I=(0,t.bh)("global_account_params");if(h){var y;let e=(0,t.bh)("productListOnOut")&&(0,t._2)((0,t.bh)("productListOnOut"));if(e&&(null===e||void 0===e||e.map((async(e,i)=>{let l={...(0,t.bh)("productListOnOut")[e]},s=1*l.qty*(1*l.price);p+=s,m+=s,b.push({inventoryId:(0,t.M5)(),product:l.productId,qty:1*l.qty,salePrice:1*l.salePrice,price:1*l.price,amount:s})}))),m>0){var j,N;let e={...n};e.type="credit",e.account=null===I||void 0===I||null===(j=I.inventory)||void 0===j?void 0:j.account,e.amount=m,e.operationId=(0,t.M5)(),c.push(e);let i={...n};i.type="debit",i.account=null===I||void 0===I||null===(N=I.inventory_expensess)||void 0===N?void 0:N.account,i.amount=m,i.operationId=(0,t.M5)(),c.push(i)}if(p>0&&(0,t.bh)("customerOutPicker").account){var f,z,k,P,C;let e={...n};e.type="debit",e.account=null===(f=(0,t.bh)("customerOutPicker"))||void 0===f?void 0:f.account,e.subAccount=null===(z=(0,t.bh)("customerOutPicker"))||void 0===z?void 0:z.subAccount,e.providerId=null===(k=(0,t.bh)("customerOutPicker"))||void 0===k?void 0:k.providerId,e.operationId=(0,t.M5)();let i=null===(P=(0,t.bh)("account_ids"))||void 0===P?void 0:P[null===(C=(0,t.bh)("customerOutPicker"))||void 0===C?void 0:C.account];i&&i.payOrCollect&&(e.payOrCollect=i.payOrCollect),e.amount=v?v/100*Q+1*Q:1*Q,c.push(e)}if(v){var O;let e={...n};e.type="credit",e.account=null===I||void 0===I||null===(O=I.sale_tax)||void 0===O?void 0:O.account,e.operationId=(0,t.M5)(),e.amount=Q*v/100,c.push(e)}if(null!==I&&void 0!==I&&null!==(y=I.sales_income)&&void 0!==y&&y.account){var A;let e={...n};e.type="credit",e.account=null===I||void 0===I||null===(A=I.sales_income)||void 0===A?void 0:A.account,e.operationId=(0,t.M5)(),e.amount=Q,c.push(e)}u&&(x.hasAdvancePay=1*u),v&&(x.hasTax=v/100*Q),x.extras=(0,t.bh)("extraChargesInvoiceList")}else{var E,S;Q=n.totalAmount;let e=null===(E=(0,t.bh)("providers_ids")[null===(S=(0,t.bh)("customerOutPicker"))||void 0===S?void 0:S.providerId])||void 0===E?void 0:E.name;e&&(x.description="Sale to ".concat(e).concat(_))}x.invoiceId=(0,t.M5)(),x.products=b,x.amount=1*Q,x.createdBy=null===(e=(0,t.bh)("profileUser"))||void 0===e?void 0:e.userId,x.customer={account:null===(i=(0,t.bh)("customerOutPicker"))||void 0===i?void 0:i.account,subAccount:null===(l=(0,t.bh)("customerOutPicker"))||void 0===l?void 0:l.subAccount,providerId:null===(s=(0,t.bh)("customerOutPicker"))||void 0===s?void 0:s.providerId},x.comprobantes=c;let q={...null===(d=(0,t.bh)((0,t.hQ)()))||void 0===d?void 0:d.add_invoice};q.params={businessId:null===(a=(0,t.bh)("profileUser"))||void 0===a?void 0:a.businessId},q.form=x;{const e=(0,t.I7)(q);await e;(null===w||void 0===w?void 0:w.modalID)&&(0,o.CloseModal)({id:null===w||void 0===w?void 0:w.modalID}),setTimeout((()=>{(0,t.Rz)("extraChargesInvoiceList",null),(0,t.Rz)("productListOnOut",null),(0,t.Rz)("customerOutPicker",null),(0,t.Rz)(g,null),M((0,t.M5)()),R&&R()}),400)}},children:(0,t.zE)(5)})}):null]})]})},f=e=>{var i,l;let{}=e;const[d,o]=(0,s.useState)(0);let a=null===(i=(0,t.bh)("providers_ids"))||void 0===i?void 0:i[null===(l=(0,t.bh)("customerOutPicker"))||void 0===l?void 0:l.providerId];return(0,n.jsx)("div",{children:null!==a&&void 0!==a&&a.name?(0,n.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,n.jsxs)("div",{className:" acc_dtls",children:[(0,n.jsx)("div",{className:"_dsplFlx",children:(0,n.jsx)("div",{className:"code",style:{color:"#646cff"},onClick:()=>{(0,t.Rz)("customerOutPicker",null),o((0,t.M5)())},children:null===a||void 0===a?void 0:a.name})}),(0,n.jsx)("div",{className:"flexSpace"})]})}):(0,n.jsx)(y,{placeholder:"buscar una provedor",width:320,handleClick:e=>{let i={providerId:e.providerId,account:e.account,subAccount:e.subAccount};(0,t.Rz)("customerOutPicker",i),o((0,t.M5)())}})})},z=e=>{var i,l,d,o,a,r,c,u,v,h,p,b,_,I;let{updMain:y}=e;const[g,N]=(0,s.useState)(0),f=()=>{N((0,t.M5)())};let z=null===(i=(0,t.bh)("products_ids"))||void 0===i?void 0:i[null===(l=(0,t.bh)("productPicker"))||void 0===l?void 0:l.productId];const P=(e,i,l)=>{let s=(0,t.bh)("productPicker")||{};l?(s[l]||(s[l]={}),s[l][e]=i):s[e]=i,(0,t.Rz)("productPicker",s),N((0,t.M5)())},w=e=>{let i=(0,t.bh)("productListOnOut")||{};delete i[e],(0,t.Rz)("productListOnOut",i),y((0,t.M5)())};return(0,n.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[null!==(d=(0,t.bh)("productPicker"))&&void 0!==d&&d.productId?(0,n.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,n.jsxs)("div",{className:" acc_dtls",children:[(0,n.jsxs)("div",{className:"_dsplFlx",onClick:e=>{(0,t.Rz)("productPicker",null),N((0,t.M5)())},children:[(0,n.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===z||void 0===z?void 0:z.upc_barcode}),(0,n.jsx)("div",{className:"name",children:null===z||void 0===z?void 0:z.name})]}),(0,n.jsx)("div",{className:"flexSpace"})]})}):(0,n.jsx)(j,{width:420,handleClick:e=>{let i={productId:e.productId,product:e.product,subAccount:e.subAccount};(0,t.Rz)("productPicker",i),(0,m.Rd)(e.productId,f)}}),null!==(o=(0,t.bh)("products_stock"))&&void 0!==o&&null!==(a=o[null===(r=(0,t.bh)("productPicker"))||void 0===r?void 0:r.productId])&&void 0!==a&&a.qty?(0,n.jsxs)("div",{className:"_dsplFlx ",children:[(0,n.jsx)(x,{init:null===(c=(0,t.bh)("productPicker"))||void 0===c?void 0:c.qty,label:(0,t.zE)(10),width:120,type:"number",updChanges:e=>P("qty",e)}),(0,n.jsx)("div",{style:{margin:"0 5px"}}),(0,n.jsx)(x,{init:null===(u=(0,t.bh)("productPicker"))||void 0===u?void 0:u.salePrice,label:(0,t.zE)(11),width:120,type:"number",updChanges:e=>P("salePrice",e)}),(0,n.jsx)("div",{className:"flexSpace"}),null!==(v=(0,t.bh)("productPicker"))&&void 0!==v&&v.qty&&(null===(h=(0,t.bh)("productPicker"))||void 0===h?void 0:h.qty)<=(null===(p=(0,t.bh)("products_stock"))||void 0===p||null===(b=p[null===(_=(0,t.bh)("productPicker"))||void 0===_?void 0:_.productId])||void 0===b?void 0:b.qty)?(0,n.jsx)("div",{style:{marginTop:38},children:(0,n.jsx)("button",{onClick:()=>{var e,i,l,s,d,o;let a={...(0,t.bh)("productPicker")}||{},n={...(0,t.bh)("productPicker")}||{},r={...(0,t.bh)("productListOnOut")}||{},c=a.productId,u=(null===(e=(0,t.bh)("products_stock"))||void 0===e||null===(i=e[null===(l=(0,t.bh)("productPicker"))||void 0===l?void 0:l.productId])||void 0===i?void 0:i.amount)/(null===(s=(0,t.bh)("products_stock"))||void 0===s||null===(d=s[null===(o=(0,t.bh)("productPicker"))||void 0===o?void 0:o.productId])||void 0===d?void 0:d.qty);a.price=u,r[c]=a,(0,t.Rz)("productListOnOut",r),n.productId=null,n.qty="",n.price="",(0,t.Rz)("productPicker",n),y((0,t.M5)())},children:(0,t.zE)(7)})}):null]}):null,(0,n.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,n.jsx)("div",{className:"tr_bar tr_bar_50 ",children:(0,t.zE)(8)}),(0,n.jsx)("div",{className:"tr_bar tr_bar_20",children:"Qty"}),(0,n.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,t.zE)(11)}),(0,n.jsx)("div",{className:"tr_bar tr_bar_5"})]}),(0,t.bh)("productListOnOut")&&(null===(I=(0,t._2)((0,t.bh)("productListOnOut")))||void 0===I?void 0:I.map(((e,i)=>(0,n.jsx)(k,{idKey:e,data:(0,t.bh)("productListOnOut")[e],deleteItem:w},e))))]})},k=e=>{var i;let{data:l,deleteItem:s,idKey:d}=e,o=null===(i=(0,t.bh)("products_ids"))||void 0===i?void 0:i[null===l||void 0===l?void 0:l.productId];return(0,n.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,n.jsx)("div",{className:"tr_bar tr_bar_50",children:null===o||void 0===o?void 0:o.name}),(0,n.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,t.Zv)(null===l||void 0===l?void 0:l.qty,2)}),(0,n.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,t.Zv)(null===l||void 0===l?void 0:l.salePrice,2)}),(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)("div",{className:"icon",onClick:()=>{s(d)},children:(0,n.jsx)(b,{name:"outline_delete",color:"#c62828"})})]})},P=(e,i)=>{var l,s;let d=0;return e&&(null===(l=(0,t._2)(e))||void 0===l||l.map(((i,l)=>{let s=1*e[i].salePrice*(1*e[i].qty);d=1*(0,t.Zv)(d,2)+1*(0,t.Zv)(s,2)}))),i&&(null===(s=(0,t._2)(i))||void 0===s||s.map(((e,l)=>{let s=1*i[e].salePrice*(1*i[e].qty);d=1*(0,t.Zv)(d,2)+1*(0,t.Zv)(s,2)}))),d}},261:()=>{}}]);
//# sourceMappingURL=3264.852881c2.chunk.js.map