"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[3425,9760],{9760:(e,s,o)=>{o.r(s),o.d(s,{CloseModal:()=>c,OpenModal:()=>r,default:()=>d});var l=o(2791),t=o(5408),i=o(2350),a=o(184);const n="listDialog_mdh392",d=()=>{const e=(0,i.bh)("listDialog")||{};(0,t.Z)(n);let s=Object.keys(e);return(0,a.jsx)(a.Fragment,{children:s.map(((s,o)=>{let t=e[s];if(t&&t.visible){let e={};t.height&&(e.heigth=t.height),t.width,t.zIndex&&(e.zIndex=t.zIndex-1);let o={zIndex:t.zIndex},i=null,n=t.data;return t.content&&(i=l.cloneElement(t.content,{data:n})),(0,a.jsxs)("div",{className:"ltr-1kbnjow",style:e,children:[(0,a.jsx)("div",{className:"ltr-hoe9xz",children:(0,a.jsx)("div",{className:"ltr-1wao6ny",style:o,id:s,children:i})}),t.data.overlay?(0,a.jsx)("div",{className:"DialogHRMOverlay ".concat(t.visible?"active":""),onClick:()=>{var e;e=s,document.getElementsByTagName("html")[0].classList.remove("has-level-two"),c({id:e})}}):null]},s)}}))})},r=e=>{let s=(0,i.bh)("listDialog")||{},o=(0,i.M5)();s[o]||(s[o]={}),s[o].visible=!0;let l={};e.props?(l=e.props,l.modalID=o):l.modalID=o;let t=document.getElementsByTagName("body")[0];null!==t&&void 0!==t&&t.style&&(t.style.overflowY="hidden"),s[o].isView=e.isView,s[o].observeResize=e.observeResize,s[o].observeResize&&(s[o].observeInterval=setInterval((()=>{let e=document.querySelector("[dialog-key-id='".concat(o,"']")),l=e&&e.getBoundingClientRect();l&&(l.width===s[o].width&&l.height===s[o].height||(s[o].height=l.height+10,s[o].width=l.width,(0,i.Rz)("listDialog",s),(0,i.wt)(n)))}),200)),s[o].display=!0,e.zIndex&&(s[o].zIndex=e.zIndex),e.height&&(s[o].height=e.height),e.width&&(s[o].width=e.width),e.content&&(s[o].content=e.content),s[o].data=l,(0,i.Rz)("listDialog",s),(0,i.wt)(n),setTimeout((()=>{document.getElementsByTagName("html")[0].classList.add("has-level-two"),(0,i.Rz)("modalOpen",o),(0,i.wt)(n)}),125)},c=e=>{let s=(0,i.bh)("listDialog")||{},o=e.id;if(s[o]){var l,t,a;s[o].observeResize&&s[o].observeInterval&&clearInterval(s[o].observeInterval),s[o].display=!1,null===(l=s[o])||void 0===l||null===(t=l.data)||void 0===t||null===(a=t.closeEvent)||void 0===a||a.call(t),(0,i.Rz)("listDialog",s),delete s[o],document.getElementsByTagName("body")[0].style.overflowY=null,(0,i.wt)(n),setTimeout((()=>{delete s[o],document.getElementsByTagName("html")[0].classList.remove("has-level-two"),(0,i.Rz)("modalOpen",null)}),750)}}},3425:(e,s,o)=>{o.r(s),o.d(s,{default:()=>I});var l=o(2791),t=o(2350),i=o(2647),a=o(9760),n=(o(7889),o(24)),d=o(713),r=o(4050),c=o(184);(0,i.YZ)();const v=(0,i.Np)(),u=((0,i.tL)(),(0,i.A5)()),h="new_area_location",p=e=>{var s,o;let{data:i,confirm:n}=e;const[d,r]=(0,l.useState)(!1),[p,m]=(0,l.useState)(0);(0,l.useEffect)((()=>{d||(r(!0),m((0,t.M5)()))}));const b=(e,s,o)=>{let l=(0,t.bh)(h)||{};o?(l[o]||(l[o]={}),l[o][e]=s):l[e]=s,(0,t.Rz)(h,l),m((0,t.M5)())};return(0,c.jsxs)("div",{style:{maxHeight:"80vh",width:"560px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("p",{className:"form_title",children:"Add Location"}),(0,c.jsx)("div",{className:"flexSpace"})]}),(0,c.jsx)("div",{className:"_dsplFlx spaceAround",children:(0,c.jsx)(u,{init:null===(s=(0,t.bh)(h))||void 0===s?void 0:s.areaId,lbl_empty:"Area",list:[{label:"Almacen",id:"WH"},{label:"Production",id:"PR"},{label:"Patio",id:"PT"}],onSelect:e=>b("areaId",e.id),background:"#f9f9f9",color:"var(--hrm_palette-blue-purple)",direction:"left",width:"220px"})}),(0,c.jsx)("div",{className:"_dsplFlx spaceAround",style:{marginTop:20},children:(0,c.jsx)(v,{init:null===(o=(0,t.bh)(h))||void 0===o?void 0:o.location,label:"Location",width:320,updChanges:e=>b("location",e)})}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("div",{className:"card",children:(0,c.jsx)("button",{onClick:async()=>{var e,s;let o=(0,t.bh)(h);o.areaLocationId=(0,t.M5)();let l={...null===(e=(0,t.bh)((0,t.hQ)()))||void 0===e?void 0:e.add_area_location};l.params={businessId:null===(s=(0,t.bh)("profileUser"))||void 0===s?void 0:s.businessId},l.form=o,console.log(l);const d=(0,t.I7)(l);await d&&((0,t.Rz)(h,{}),n&&n(),(null===i||void 0===i?void 0:i.modalID)&&(0,a.CloseModal)({id:null===i||void 0===i?void 0:i.modalID}))},children:"Guardar"})})]})]})},m=(0,i.Vg)(),b=(0,n.Uc)(),I=e=>{var s,o;let{data:i,elmId:n,updObs:v}=e;const[u,h]=(0,l.useState)(!1),[I,y]=(0,l.useState)(0),[_,g]=(0,l.useState)(0),[x,f]=(0,l.useState)(!1);(0,l.useEffect)((()=>{u||(h(!0),y((0,t.M5)()),(0,d.N0)(z),(0,r.Ht)("global_accounts","global_account_params",v))}));const w=()=>{},j=e=>{(0,d.N0)(z)},z=async(e,s)=>{y((0,t.M5)()),f(!1)};return(0,c.jsxs)("div",{className:"",children:[(0,c.jsxs)("div",{className:"accounts_header",children:[(0,c.jsx)("h2",{children:"Inventory and Locations"}),(0,c.jsx)("div",{className:"_dsplFlx ",children:(0,t.I0)()?(0,c.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>{let e={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,c.jsx)(p,{}),(0,a.OpenModal)(e)},children:"Add Location"}):null})]}),(0,c.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,c.jsx)(m,{placeholder:"Buscar ....",width:560,obs:y,fetchData:e=>{f(!0),(0,d.N0)(z)},loading:x,change:e=>{!x&&f(!0)},callempty:j,keyFlds:"searchLocationQry"}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("div",{className:"total_comprobante_title",children:"No de Locations:"}),(0,c.jsx)("div",{className:"total_comprobante gray",children:(0,c.jsx)("span",{children:null===(s=(0,t._2)((0,t.bh)("locations_list")))||void 0===s?void 0:s.length})})]})]}),(0,c.jsx)("div",{className:"movements_container scollVh",children:(0,t.bh)("locations_list")&&(null===(o=(0,t._2)((0,t.bh)("locations_list")))||void 0===o?void 0:o.map((e=>(0,c.jsx)(b,{data:(0,t.bh)("locations_list")[e],elmId:e,openUpdateView:w,handleRefreshAll:j},e))))})]})}},713:(e,s,o)=>{o.d(s,{$P:()=>b,B8:()=>x,IR:()=>v,N0:()=>i,QJ:()=>m,Rd:()=>r,VI:()=>g,Ve:()=>p,WA:()=>_,ZW:()=>d,Zj:()=>I,fK:()=>a,g5:()=>t,ii:()=>h,nj:()=>y,qT:()=>c,qv:()=>u,yk:()=>n});var l=o(2350);const t={WH:"Almacen",PR:"Production",PT:"Patio"},i=async e=>{var s,o;let t={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.scan_area_location};t.params={businessId:null===(o=(0,l.bh)("profileUser"))||void 0===o?void 0:o.businessId,limit:120};const i=(0,l.I7)(t),a=await i;a?((0,l.Rz)("locations_ids",a),(0,l.Rz)("locations_list",I((0,l.jQ)(a),"areaLocationId")),e&&e()):e&&e()},a=async(e,s)=>{var o,t;let i={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.scan_voucher_production};i.params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId,":search0":e};const a=(0,l.I7)(i),n=await a;n&&!n.error&&(0,l._2)(n)&&(0,l._2)(n).length>0?s&&s(n):s&&s(null)},n=async e=>{var s,o;let t={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.scan_voucher_production};if(t.params={businessId:null===(o=(0,l.bh)("profileUser"))||void 0===o?void 0:o.businessId,limit:120},(0,l.bh)("searchVoucherQry")&&(0,l.bh)("searchVoucherQry").length>1){(0,l.bh)("searchVoucherQry").split(" ").map(((e,s)=>{e&&(t.params[":search"+s]=e.trim())}));const s=(0,l.I7)(t),o=await s;o&&((0,l.Rz)("voucher_production",o),(0,l.Rz)("vouchers_list",I((0,l.jQ)(o),"voucherId")),e&&e())}else(0,l.Rz)("vouchers_list",null),e&&e()},d=async(e,s)=>{var o,t;let i={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.get_inventory_prod};i.params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId,":productId":e};const a=(0,l.I7)(i),n=await a;n&&((0,l.Rz)("inv_products_list",I((0,l.jQ)(n.list),"name")),(0,l.Rz)("inv_products_stock",n.stock),s&&s())},r=async(e,s)=>{var o,t;let i={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.get_prod_stock};i.params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId,productId:e};const a=(0,l.I7)(i),n=await a;if(n){let o={...(0,l.bh)("products_stock")};o[e]=n.stock,(0,l.Rz)("products_stock",o),s&&s()}},c=async e=>{var s,o;let t={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.all_prods};t.params={businessId:null===(o=(0,l.bh)("profileUser"))||void 0===o?void 0:o.businessId},t.subQuerys={},t.subQuerys.stock=1;const i=(0,l.I7)(t),a=await i;if(a){let s={},o=[],t=0;a.map((e=>{var i;if(null!==e&&void 0!==e&&null!==(i=e.inventory)&&void 0!==i&&i.qty){var a,n,d;if(t+=1*(0,l.Zv)(null===e||void 0===e||null===(a=e.inventory)||void 0===a?void 0:a.amount,2),s[e.unit])s[e.unit]+=null===e||void 0===e||null===(n=e.inventory)||void 0===n?void 0:n.qty;else s[e.unit]=null===e||void 0===e||null===(d=e.inventory)||void 0===d?void 0:d.qty;o.push({productId:e.productId,name:e.name,unit:e.unit,qty:(1*e.inventory.qty).toFixed(2),amount:(1*e.inventory.amount).toFixed(2),cost:(e.inventory.amount/e.inventory.qty*1).toFixed(2)})}})),(0,l.Ey)(e)&&e({list:I(o,"name"),total:t,units:s})}},v=async(e,s)=>{var o,t;let i={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.group_prod_stock};i.params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId};const a=(0,l.I7)(i),n=await a;if(n){let o=(0,l._I)(n.comps),t=0,i=0,a=0,d=[],r=[];(0,l._2)(e).map((s=>{let c={...e[s]},v=("debit"===e[s].type?1:-1)*e[s].amount,u=1*(0,l.Zv)(v,2);if(t+=u,n.comps[e[s].comprobanteId]){c.inventory=n.comps[e[s].comprobanteId];let t=0;if((0,l._2)(n.comps[e[s].comprobanteId]).map((o=>{t=1*(0,l.Zv)(t,2)+1*(0,l.Zv)(n.comps[e[s].comprobanteId][o],2)})),t=t<0?-1*t:t,t=1*(0,l.Zv)(t,2),c.inventoryAmount=t,i+=t,u=u<0?-1*u:u,u-t!==0){let e=u-t;a+=e,r.push(c),console.log("diff",c,u,t,e)}else d.push(c);delete o[e[s].comprobanteId]}else a+=v,r.push(c)}));let c=0;(0,l._2)(o).map((e=>{let s=0;(0,l._2)(o[e]).map((t=>{s=1*(0,l.Zv)(s,2)+1*(0,l.Zv)(o[e][t],2)})),c+=s})),console.log("inventoryBack",o,"inventoryBackTotal",c),(0,l.Rz)("inv_comprobantes_compare",{hasError:r,success:d,inventoryBack:o}),(0,l.Ey)(s)&&s()}},u=async e=>{var s,o,t;let i={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.filter_search_opera};i.params={businessId:null===(o=(0,l.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,l.bh)("date_current_year"),":account":null===(t=(0,l.bh)("global_account_params"))||void 0===t?void 0:t.inventory.account};const a=(0,l.I7)(i),n=await a;n&&!n.error&&(0,l.Ey)(e)&&e(I((0,l.jQ)(n),"date"))},h=async e=>{var s,o;let t={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.all_prods};t.params={businessId:null===(o=(0,l.bh)("profileUser"))||void 0===o?void 0:o.businessId};const i=(0,l.I7)(t),a=await i;a&&((0,l.Rz)("products_list",I(a,"name")),(0,l.Rz)("products_ids",(0,l.ME)((0,l.jQ)(a),"productId")),e&&e())},p=async e=>{var s,o;let t={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.search_prod};if(t.params={businessId:null===(o=(0,l.bh)("profileUser"))||void 0===o?void 0:o.businessId,limit:120},(0,l.bh)("searchQry").length>1){(0,l.bh)("searchQry").split(" ").map(((e,s)=>{e&&(t.params[":search"+s]=e.trim())}));const s=(0,l.I7)(t),o=await s;o&&((0,l.Rz)("products_list",I((0,l.jQ)(o),"code")),e&&e())}else(0,l.Rz)("products_list",null),e&&e()},m=async e=>{var s,o;let t={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.all_entry_invoices};t.params={businessId:null===(o=(0,l.bh)("profileUser"))||void 0===o?void 0:o.businessId};const i=(0,l.I7)(t),a=await i;a&&((0,l.Rz)("movements_list",I(a,"date")),(0,l.Rz)("movements_ids",(0,l.ME)((0,l.jQ)(a),"inventoryId")),e&&e())},b=async e=>{var s;if((null===(s=(0,l.bh)("searchMovQry"))||void 0===s?void 0:s.length)>1){var o,t;let s={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.search_inventory};s.params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId,":search0":(0,l.bh)("searchMovQry")};const i=(0,l.I7)(s),a=await i;a&&((0,l.Rz)("movements_list",function(e){var s={};let o=e&&(0,l._2)(e);o.length>0?o.map((o=>{let l=e[o];s[l.comprobanteId]||(s[l.comprobanteId]={},s[l.comprobanteId].amount=0,s[l.comprobanteId].document=l.document,s[l.comprobanteId].date=l.date,s[l.comprobanteId].comprobanteId=l.comprobanteId,s[l.comprobanteId].products=[]),s[l.comprobanteId].amount+=l.qty*l.price,s[l.comprobanteId].products.push({productId:l.productId,qty:l.qty,price:l.price,inventoryId:l.inventoryId})})):s=null;return s}(a)),(0,l.Rz)("movements_ids",a),e&&e())}else(0,l.Rz)("movements_list",[]),(0,l.Rz)("movements_ids",{}),e&&e()};const I=(e,s)=>(0,l.MV)("sortProducts",[e],(()=>e&&e.sort(((e,o)=>{let l=e[s],t=o[s];return l<t?-1:l>t?1:0})))),y=async(e,s)=>{var o,t;let i={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.delete_prod};i.params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId,productId:e};const a=(0,l.I7)(i);await a&&s&&s()},_=async(e,s)=>{var o,t;let i={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.delete_inventory};i.params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId,inventoryId:e};const a=(0,l.I7)(i);await a&&s&&s()},g=async(e,s)=>{var o,t;({...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.entry_invoice_acc_2}).params={businessId:null===(t=(0,l.bh)("profileUser"))||void 0===t?void 0:t.businessId,entriesInvoiceId:e}},x=(e,s)=>(0,l.MV)("rangeProdArr",[e,s],(()=>e?(0,l._2)(e).slice(0,s):[]))},7889:()=>{}}]);
//# sourceMappingURL=3425.294dafc9.chunk.js.map