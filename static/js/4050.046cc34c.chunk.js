"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[4050],{4050:(e,t,o)=>{o.d(t,{EK:()=>A,Ht:()=>y,Jy:()=>c,K_:()=>u,Pe:()=>l,S:()=>M,T7:()=>p,TP:()=>h,Y1:()=>v,ZX:()=>d,_0:()=>i,bs:()=>I,eK:()=>r,fp:()=>Q,h1:()=>_,i_:()=>f,k4:()=>C,rs:()=>b,y1:()=>z});var n=o(2350),a=o(15);const r=async e=>{var t,o;let r={...null===(t=(0,n.bh)((0,n.hQ)()))||void 0===t?void 0:t.calc_sub_myr};r.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,n.bh)("date_current_year")};const i=(0,n.I7)(r),d=await i;d&&((0,n.Rz)("accounts_summary_by_months",d.summary),(0,n.Rz)("accounts_summary_by_docs",d.summaryByDoc),(0,a.OpenToast)({text:"Accounts Summary Updated",timeout:3500}),u(e))},u=async e=>{var t,o;let a={...null===(t=(0,n.bh)((0,n.hQ)()))||void 0===t?void 0:t.get_sub_bal_myr};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,n.bh)("date_current_year")};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("accounts_summary_by_months",u.summary),(0,n.Rz)("accounts_summary_by_docs",u.summaryByDoc),e&&e(u))},i=async e=>{var t,o;let a={...null===(t=(0,n.bh)((0,n.hQ)()))||void 0===t?void 0:t.all_accounts};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,n.bh)("date_current_year")};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("account_list",m(u,"code")),(0,n.Rz)("account_ids",(0,n.ME)(u,"accountId")),e&&e())},d=async e=>{var t,o;let a={...null===(t=(0,n.bh)((0,n.hQ)()))||void 0===t?void 0:t.all_sub_account};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,n.bh)("date_current_year")};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("sub_account_list",v(u,"subAccount")),(0,n.Rz)("sub_account_group",function(e,t){t=t||"id";var o={};e.length>0?e.map((e=>{e.subAccount&&(o[e[t]]||(o[e[t]]=[]),o[e[t]].push(e))})):o=null;return o}(u,"accountId")),(0,n.Rz)("sub_account_ids",(0,n.ME)(u,"sub_accountId")),i(),e&&e())},l=async e=>{var t,o;let a={...null===(t=(0,n.bh)((0,n.hQ)()))||void 0===t?void 0:t.all_bank_bUp};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,n.bh)("date_current_year")};const r=(0,n.I7)(a),u=await r;if(u){let t={},o=[],a=0;(u&&u.sort(((e,t)=>{let o=e.status,n=t.status;return o<n?a?-1:1:o>n?a?1:-1:0}))).map((e=>{let n=e.date+"_"+e.amount+"_"+e.checkOrSlip;t[n]||(o.push(e),t[n]=1)})),(0,n.Rz)("ourBank",v(o,"date")),(0,n.Rz)("ourBank_ids",(0,n.ME)(o,"bankRecordId"));let r=s(o,(0,n.bh)("submayor_list"));(0,n.Rz)("ourBank_filtered",r),e&&e()}},s=(e,t)=>{let o=[],a={...t},r=[],u=(0,n.bh)("date_range_submayor"),i={...(0,n.bh)("submayor_list")},d={},l={};for(let n in e){let t=e[n];t.date>=(null===u||void 0===u?void 0:u.initDate)&&t.date<=(null===u||void 0===u?void 0:u.lastDate)&&(t.linkId&&9===t.status?(r.push(t),d[t.linkId]?l[t.bankRecordId]=t:(d[t.linkId]=1,i[t.linkId]&&delete i[t.linkId]),delete a[t.linkId]):o.push(t))}let s=[],c=[];for(let n in i){0!==1*i[n].amount?s.push(i[n]):c.push(i[n])}return{pending:v(o,"date"),verified:v(r,"date"),sub_mayor:S((0,n.jQ)(a),"date"),verified_duplicatedLink:l,bankSubLeft:s,bankSubLeft_wZr:c}};const c=async e=>{var t,o;let a={...null===(t=(0,n.bh)((0,n.hQ)()))||void 0===t?void 0:t.search_account};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search":(0,n.bh)("searchQry"),year:(0,n.bh)("date_current_year")};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("account_list",m((0,n.jQ)(u),"code")),e&&e())},b=async(e,t)=>{var o,a,r,u;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.filter_search_opera};i.params={businessId:null===(a=(0,n.bh)("profileUser"))||void 0===a?void 0:a.businessId,year:(0,n.bh)("date_current_year"),":account":null===e||void 0===e?void 0:e.account,":date1":null===(r=(0,n.bh)("date_range_submayor"))||void 0===r?void 0:r.initDate,":date2":null===(u=(0,n.bh)("date_range_submayor"))||void 0===u?void 0:u.lastDate},null!==e&&void 0!==e&&e.subAccount&&(i.params[":subAccount"]=null===e||void 0===e?void 0:e.subAccount);const d=(0,n.I7)(i),l=await d;l&&!l.error&&((0,n.Rz)("submayor_list",l),(0,n.Rz)("submayor_group",function(e,t){var o={operations:[]};let a=e&&(0,n._2)(e);a.length>0?a.map((t=>{let a=e[t];a.type&&o.operations.push(function(e){var t,o;let a={},r=null===(t=(0,n.bh)("account_ids"))||void 0===t?void 0:t[e.account];a.account=r,a.sub_account=null===(o=(0,n.bh)("sub_account_ids"))||void 0===o?void 0:o[e.subAccount],a.comprobanteId=e.comprobanteId,a.operationId=e.operationId,a.document=e.document,a.description=e.description,a.date=e.date,"credit"===e.type?(a.debit=0,a.credit=e.amount):"debit"===e.type&&(a.credit=0,a.debit=e.amount);return a}(a))})):o=null;return o}(l))),t&&t()};const m=(e,t)=>(0,n.MV)("sortAccounts",[e,t],(()=>e&&e.sort(((e,o)=>{let n=1*e[t],a=1*o[t];return n<a?-1:n>a?1:0})))),v=(e,t)=>(0,n.MV)("sortSubAccounts",[e],(()=>e&&e.sort(((e,o)=>{let n=1*e[t],a=1*o[t];return n<a?-1:n>a?1:0})))),_=e=>(0,n.MV)("sortComprobantesByDate",[e],(()=>{let t="date";return e.sort(((e,o)=>{let n=e[t],a=o[t];return n<a?-1:n>a?1:0}))})),p=(e,t,o,a)=>(0,n.MV)("calcSubmayor",[e,t,o,a],(()=>{var a,r;let u="date",i=new Date(null===(a=(0,n.bh)("date_range_submayor"))||void 0===a?void 0:a.initDate).getMonth();const d=M(i,{account:t,subAccount:o},"calcSubmayor");let l=null===(r=(0,n.bh)("account_ids"))||void 0===r?void 0:r[t],s=d||0;null===l||void 0===l||l.type;let c=e&&e.sort(((e,t)=>{let o=e[u],n=t[u];return o<n?-1:o>n?1:0}));return c.map(((e,t)=>((e,t)=>{var o;let n={...e},a=0;return a="credit"===(null===e||void 0===e||null===(o=e.account)||void 0===o?void 0:o.type)?1*n.credit-1*n.debit:1*n.debit-1*n.credit,n.saldo=1*s+a,s=n.saldo,n})(e)))}));const h=async e=>{var t;let o={...null===(t=(0,n.bh)((0,n.hQ)()))||void 0===t?void 0:t.get_balance_general_param};const a=(0,n.I7)(o),r=await a;r&&!r.error&&((0,n.Rz)("balance_general_param",null===r||void 0===r?void 0:r.general),(0,n.Rz)("result_sheet_params",null===r||void 0===r?void 0:r.result),(0,n.Rz)("balance_general_upd_flds",null===r||void 0===r?void 0:r.general_flds),(0,n.Rz)("result_sheet_upd_flds",null===r||void 0===r?void 0:r.result_flds)),e&&e()},y=async(e,t,o)=>{var a,r;let u={...null===(a=(0,n.bh)((0,n.hQ)()))||void 0===a?void 0:a.find_balances};u.params={businessId:null===(r=(0,n.bh)("profileUser"))||void 0===r?void 0:r.businessId,":type":e,year:(0,n.bh)("date_current_year")};const i=(0,n.I7)(u),d=await i;if(d&&!d.error){let e=d[(0,n._2)(d)[0]];(0,n.Rz)(t,e),(0,n.Rz)(t+"_bck",{...e})}o&&o()},I=async()=>{let e={},t=[];return(0,n.bh)("sub_account_list").map((o=>{var a;let r=null===(a=(0,n.bh)("account_ids"))||void 0===a?void 0:a[o.accountId],u=o.subAccount?o.accountId+"_"+o.sub_accountId:o.accountId;if(e[u])return{};{var i;let a=new Date(null===(i=(0,n.bh)("date_range_submayor"))||void 0===i?void 0:i.initDate).getMonth()+1,d=M(a,{account:u}),l={cuenta:r.code+"",nombre:r.name,sub_cuenta:o.subAccount?o.subAccount:"",nombre_sub_cuenta:o.subAccount?o.subAccountName:"",saldo:d||0,type:r.type};return e[u]=1,t.push(l),l}})),O(t,"cuenta")};function f(e,t,o){return e.map((e=>({date:(0,n.Gv)(e.date),document:e.document,comprobante:e.comprobanteId,description:e.description,debito:e.debit,credito:e.credit,saldo:e.saldo})))}const k=e=>{let t={};for(let o in e)t[o]=e[o];return t},D=(e,t,o)=>(0,n.MV)("sortAmountWDate",[e,t,o],(()=>e&&e.sort(((e,n)=>{let a=t(e),r=t(n),u=o(e),i=o(n);if(a==r){if(u<i)return-1;if(u>i)return 1}return a<r?-1:a>r?1:0})))),g=e=>e.date?1*e.date:999999999999,w=e=>e.amount?1*e.amount:999999999999,R=e=>1*e.amount<0?-1*e.amount:1*e.amount,A=()=>{let e=(0,n.bh)("ourBank_filtered"),t=(0,n.jQ)((0,n.bh)("submayor_list")),o=D(t,w,g),a=D(e.verified,R,g),r=0;for(let u in a){let e=a[u],t=1*u+1*r,i=o[t];if(i){let a=1*e.amount<0?-1*e.amount:1*e.amount,u=null!==i&&void 0!==i&&i.amount?1*i.amount:0;if(a!==u){(0,n.wL)(a,u),(0,n.wL)(i);let e=o[t+1];a===(null!==e&&void 0!==e&&e.amount?1*e.amount:0)&&(r+=1)}}}},z=(e,t)=>{let o=(0,n.bh)("ourBank_filtered"),a=o.sub_mayor,r=k(a),u=k(o.pending),i={},d={},l={},s={},c=a,b=u;const m=e=>{if(i[e.comprobantId]||(i[e.comprobantId]=e),d[e.comprobantId])return delete d[e.comprobantId],1},v=e=>{if(!d[e.comprobantId])return d[e.comprobantId]=e,1},_=(e,t)=>{for(let a in r){var o,n;let u=r[a],i=1*e.amount,d=u.amount*(i<0?-1:1);if(l[""+t])break;let c=null===(o=u.document)||void 0===o?void 0:o.trim(),b=null===(n=e.checkOrSlip)||void 0===n?void 0:n.trim();if(b&&c===b&&d===i){l[""+t]=""+a,s[""+a]=""+t,m(u),delete r[a];break}if(d===i){l[""+t]=""+a,s[""+a]=""+t,m(u),delete r[a];break}v(u)}};for(let n in b){let e=b[n];e.checkOrSlip&&_(e,n)}for(let n in b){_(b[n],n)}let p=[];for(let n in b){let e=b[n];l[n]?(e.comprobanteId=c[l[n]].comprobanteId,e.document=c[l[n]].document,e.operationId=c[l[n]].operationId,p.push(e)):(e.comprobanteId="",e.document="",e.operationId="",p.push(e))}return{ready:p,cmpbNotInBank:d}},O=(e,t)=>e&&e.sort(((e,o)=>{let n=e[t],a=o[t];return n<a?-1:n>a?1:0})),S=(e,t)=>e&&e.sort(((e,o)=>{let a=(0,n.Vd)(e[t]),r=(0,n.Vd)(o[t]);return a<r?-1:a>r?1:0})),P=e=>{let t={...e};var o,n,a,r,u,i;(t.hasOwnProperty("Date")&&(t.date=new Date(t.Date).getTime()+65e3,t.dateDDMMYYYY=t.Date,delete t.Date),t.hasOwnProperty("Posting Date")&&(t.date=t["Posting Date"],delete t["Posting Date"]),t.hasOwnProperty("Check Number")||t.hasOwnProperty('"Check Number"'))&&(t.checkOrSlip=null===(o=t["Check Number"])||void 0===o?void 0:o.trim(),delete t["Check Number"]);t.hasOwnProperty('"Check Number"')&&(t.checkOrSlip=null===(n=t['"Check Number"'])||void 0===n?void 0:n.trim(),delete t['"Check Number"']);t.hasOwnProperty("Check or Slip #")&&(t.checkOrSlip=null===(a=t["Check or Slip #"])||void 0===a?void 0:a.trim(),delete t["Check or Slip #"]);(t.hasOwnProperty("Amount")&&(t.amount=1*t.Amount,delete t.Amount),t.hasOwnProperty("Documento")&&(t.document=t.Documento.trim(),delete t.Documento),t.hasOwnProperty("Description"))&&(t.description=null===(r=t.Description)||void 0===r||null===(u=r.split('"'))||void 0===u||null===(i=u.join(""))||void 0===i?void 0:i.trim(),delete t.Description);return t},M=(e,t,o)=>(0,n.MV)("getPrevBalance",[e,t,o],(()=>{var o;let a=t.account;t.subAccount&&(a=t.account+"_"+t.subAccount);let r=null===(o=(0,n.bh)("accounts_summary_by_months"))||void 0===o?void 0:o[a],u=e-1,i=0;if((0,n.UE)(null===r||void 0===r?void 0:r[u])){let t=0;Array.from(Array(e).keys()).map((e=>{let o=(0,n.Zv)(r[e],2);t=1*t+1*o})),i=t}return i})),C=(e,t)=>{let o=[],a={},r=[],u=(0,n.bh)("date_range_submayor");for(let n in t){let e=t[n];e.date>=(null===u||void 0===u?void 0:u.initDate)&&e.date<=(null===u||void 0===u?void 0:u.lastDate)&&r.push(e)}for(let i in e){let t=P(e[i]);if(t.date){let e=!1;for(let o in r){let n=r[o];a[n.bankRecordId]||n.description!==t.description||n.amount!==t.amount||n.checkOrSlip!==t.checkOrSlip||(e=!0,a[n.bankRecordId]=1)}e||(t.bankRecordId=(0,n.M5)(),o.push(t))}}return o},Q=(e,t)=>{(0,n.DF)(e,U,t)},U=async(e,t,o,a)=>{const r=(0,n.I7)(e),u=await r;if(u)return a&&o.length-1===t&&a(),u}}}]);
//# sourceMappingURL=4050.046cc34c.chunk.js.map