"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[4050],{4050:(t,e,o)=>{o.d(e,{EK:()=>A,Ht:()=>y,Jy:()=>c,K_:()=>u,Pe:()=>l,S:()=>M,T7:()=>h,TP:()=>_,Y1:()=>v,ZX:()=>d,_0:()=>i,bs:()=>I,eK:()=>r,fp:()=>Q,h1:()=>p,i_:()=>f,k4:()=>C,rs:()=>b,y1:()=>z});var n=o(2350),a=o(15);const r=async t=>{var e,o;let r={...null===(e=(0,n.bh)((0,n.hQ)()))||void 0===e?void 0:e.calc_sub_myr};r.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,n.bh)("date_current_year")};const i=(0,n.I7)(r),d=await i;d&&((0,n.Rz)("accounts_summary_by_months",d.summary),(0,a.OpenToast)({text:"Accounts Summary Updated",timeout:3500}),u(t))},u=async t=>{var e,o;let a={...null===(e=(0,n.bh)((0,n.hQ)()))||void 0===e?void 0:e.get_sub_bal_myr};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,n.bh)("date_current_year")};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("accounts_summary_by_months",u.summary),t&&t(u))},i=async t=>{var e,o;let a={...null===(e=(0,n.bh)((0,n.hQ)()))||void 0===e?void 0:e.all_accounts};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("account_list",m(u,"code")),(0,n.Rz)("account_ids",(0,n.ME)(u,"accountId")),t&&t())},d=async t=>{var e,o;let a={...null===(e=(0,n.bh)((0,n.hQ)()))||void 0===e?void 0:e.all_sub_account};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("sub_account_list",v(u,"subAccount")),(0,n.Rz)("sub_account_group",function(t,e){e=e||"id";var o={};t.length>0?t.map((t=>{t.subAccount&&(o[t[e]]||(o[t[e]]=[]),o[t[e]].push(t))})):o=null;return o}(u,"accountId")),(0,n.Rz)("sub_account_ids",(0,n.ME)(u,"sub_accountId")),i(),t&&t())},l=async t=>{var e,o;let a={...null===(e=(0,n.bh)((0,n.hQ)()))||void 0===e?void 0:e.all_bank_bUp};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId};const r=(0,n.I7)(a),u=await r;if(u){let e={},o=[],a=0;(u&&u.sort(((t,e)=>{let o=t.status,n=e.status;return o<n?a?-1:1:o>n?a?1:-1:0}))).map((t=>{let n=t.date+"_"+t.amount+"_"+t.checkOrSlip;e[n]||(o.push(t),e[n]=1)})),(0,n.Rz)("ourBank",v(o,"date")),(0,n.Rz)("ourBank_ids",(0,n.ME)(o,"bankRecordId"));let r=s(o,(0,n.bh)("submayor_list"));(0,n.Rz)("ourBank_filtered",r),t&&t()}},s=(t,e)=>{let o=[],a={...e},r=[],u=(0,n.bh)("date_range_submayor"),i={...(0,n.bh)("submayor_list")},d={},l={};for(let n in t){let e=t[n];e.date>=(null===u||void 0===u?void 0:u.initDate)&&e.date<=(null===u||void 0===u?void 0:u.lastDate)&&(e.linkId&&9===e.status?(r.push(e),d[e.linkId]?l[e.bankRecordId]=e:(d[e.linkId]=1,i[e.linkId]&&delete i[e.linkId]),delete a[e.linkId]):o.push(e))}let s=[],c=[];for(let n in i){0!==1*i[n].amount?s.push(i[n]):c.push(i[n])}return{pending:v(o,"date"),verified:v(r,"date"),sub_mayor:S((0,n.jQ)(a),"date"),verified_duplicatedLink:l,bankSubLeft:s,bankSubLeft_wZr:c}};const c=async t=>{var e,o;let a={...null===(e=(0,n.bh)((0,n.hQ)()))||void 0===e?void 0:e.search_account};a.params={businessId:null===(o=(0,n.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search":(0,n.bh)("searchQry")};const r=(0,n.I7)(a),u=await r;u&&((0,n.Rz)("account_list",m((0,n.jQ)(u),"code")),t&&t())},b=async(t,e)=>{var o,a,r,u;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.filter_search_opera};i.params={businessId:null===(a=(0,n.bh)("profileUser"))||void 0===a?void 0:a.businessId,year:(0,n.bh)("date_current_year"),":account":null===t||void 0===t?void 0:t.account,":subAccount":null===t||void 0===t?void 0:t.subAccount,":date1":null===(r=(0,n.bh)("date_range_submayor"))||void 0===r?void 0:r.initDate,":date2":null===(u=(0,n.bh)("date_range_submayor"))||void 0===u?void 0:u.lastDate};const d=(0,n.I7)(i),l=await d;l&&!l.error&&((0,n.Rz)("submayor_list",l),(0,n.Rz)("submayor_group",function(t,e){var o={operations:[]};let a=t&&(0,n._2)(t);a.length>0?a.map((e=>{let a=t[e];a.type&&o.operations.push(function(t){var e,o;let a={};a.account=null===(e=(0,n.bh)("account_ids"))||void 0===e?void 0:e[t.account],a.sub_account=null===(o=(0,n.bh)("sub_account_ids"))||void 0===o?void 0:o[t.subAccount],a.comprobanteId=t.comprobanteId,a.operationId=t.operationId,a.document=t.document,a.description=t.description,a.date=t.date,"credit"===t.type?(a.debit=0,a.credit=t.amount):"debit"===t.type&&(a.credit=0,a.debit=t.amount);return a}(a))})):o=null;return o}(l))),e&&e()};const m=(t,e)=>(0,n.MV)("sortAccounts",[t,e],(()=>t&&t.sort(((t,o)=>{let n=1*t[e],a=1*o[e];return n<a?-1:n>a?1:0})))),v=(t,e)=>(0,n.MV)("sortSubAccounts",[t],(()=>t&&t.sort(((t,o)=>{let n=1*t[e],a=1*o[e];return n<a?-1:n>a?1:0})))),p=t=>(0,n.MV)("sortComprobantesByDate",[t],(()=>{let e="date";return t.sort(((t,o)=>{let n=t[e],a=o[e];return n<a?-1:n>a?1:0}))})),h=(t,e,o,a)=>(0,n.MV)("calcSubmayor",[t,e,o,a],(()=>{var a,r;let u="date",i=new Date(null===(a=(0,n.bh)("date_range_submayor"))||void 0===a?void 0:a.initDate).getMonth();const d=M(i,{account:e,subAccount:o},"calcSubmayor");let l=null===(r=(0,n.bh)("account_ids"))||void 0===r?void 0:r[e],s=d||0;"credit"===(null===l||void 0===l?void 0:l.type)&&(s*=-1);let c=t&&t.sort(((t,e)=>{let o=t[u],n=e[u];return o<n?-1:o>n?1:0}));return c.map((t=>(t=>{var e;let o={...t};return"credit"===(null===t||void 0===t||null===(e=t.account)||void 0===e?void 0:e.type)?o.saldo=1*s+(1*o.credit-1*o.debit):o.saldo=1*s+(1*o.debit-1*o.credit),s=o.saldo,o})(t)))}));const _=async t=>{var e;let o={...null===(e=(0,n.bh)((0,n.hQ)()))||void 0===e?void 0:e.get_balance_general_param};const a=(0,n.I7)(o),r=await a;r&&!r.error&&((0,n.Rz)("balance_general_param",null===r||void 0===r?void 0:r.general),(0,n.Rz)("result_sheet_params",null===r||void 0===r?void 0:r.result),(0,n.Rz)("balance_general_upd_flds",null===r||void 0===r?void 0:r.general_flds),(0,n.Rz)("result_sheet_upd_flds",null===r||void 0===r?void 0:r.result_flds)),t&&t()},y=async(t,e,o)=>{var a,r;let u={...null===(a=(0,n.bh)((0,n.hQ)()))||void 0===a?void 0:a.find_balances};u.params={businessId:null===(r=(0,n.bh)("profileUser"))||void 0===r?void 0:r.businessId,":type":t};const i=(0,n.I7)(u),d=await i;if(d&&!d.error){let t=d[(0,n._2)(d)[0]];(0,n.Rz)(e,t),(0,n.Rz)(e+"_bck",{...t})}o&&o()},I=async()=>{let t={},e=[];return(0,n.bh)("sub_account_list").map((o=>{var a;let r=null===(a=(0,n.bh)("account_ids"))||void 0===a?void 0:a[o.accountId],u=o.subAccount?o.accountId+"_"+o.sub_accountId:o.accountId;if(t[u])return{};{var i;let a=new Date(null===(i=(0,n.bh)("date_range_submayor"))||void 0===i?void 0:i.initDate).getMonth()+1,d=M(a,{account:u}),l={cuenta:r.code+"",nombre:r.name,sub_cuenta:o.subAccount?o.subAccount:"",nombre_sub_cuenta:o.subAccount?o.subAccountName:"",saldo:d||0,type:r.type};return t[u]=1,e.push(l),l}})),O(e,"cuenta")};function f(t,e,o){return t.map((t=>({date:(0,n.Gv)(t.date),document:t.document,comprobante:t.comprobanteId,description:t.description,debito:t.debit,credito:t.credit,saldo:t.saldo})))}const k=t=>{let e={};for(let o in t)e[o]=t[o];return e},D=(t,e,o)=>(0,n.MV)("sortAmountWDate",[t,e,o],(()=>t&&t.sort(((t,n)=>{let a=e(t),r=e(n),u=o(t),i=o(n);if(a==r){if(u<i)return-1;if(u>i)return 1}return a<r?-1:a>r?1:0})))),g=t=>t.date?1*t.date:999999999999,w=t=>t.amount?1*t.amount:999999999999,R=t=>1*t.amount<0?-1*t.amount:1*t.amount,A=()=>{let t=(0,n.bh)("ourBank_filtered"),e=(0,n.jQ)((0,n.bh)("submayor_list")),o=D(e,w,g),a=D(t.verified,R,g),r=0;for(let u in a){let t=a[u],e=1*u+1*r,i=o[e];if(i){let a=1*t.amount<0?-1*t.amount:1*t.amount,u=null!==i&&void 0!==i&&i.amount?1*i.amount:0;if(a!==u){(0,n.wL)(a,u),(0,n.wL)(i);let t=o[e+1];a===(null!==t&&void 0!==t&&t.amount?1*t.amount:0)&&(r+=1)}}}},z=(t,e)=>{let o=(0,n.bh)("ourBank_filtered"),a=o.sub_mayor,r=k(a),u=k(o.pending),i={},d={},l={},s={},c=a,b=u;const m=t=>{if(i[t.comprobantId]||(i[t.comprobantId]=t),d[t.comprobantId])return delete d[t.comprobantId],1},v=t=>{if(!d[t.comprobantId])return d[t.comprobantId]=t,1},p=(t,e)=>{for(let a in r){var o,n;let u=r[a],i=1*t.amount,d=u.amount*(i<0?-1:1);if(l[""+e])break;let c=null===(o=u.document)||void 0===o?void 0:o.trim(),b=null===(n=t.checkOrSlip)||void 0===n?void 0:n.trim();if(b&&c===b&&d===i){l[""+e]=""+a,s[""+a]=""+e,m(u),delete r[a];break}if(d===i){l[""+e]=""+a,s[""+a]=""+e,m(u),delete r[a];break}v(u)}};for(let n in b){let t=b[n];t.checkOrSlip&&p(t,n)}for(let n in b){p(b[n],n)}let h=[];for(let n in b){let t=b[n];l[n]?(t.comprobanteId=c[l[n]].comprobanteId,t.document=c[l[n]].document,t.operationId=c[l[n]].operationId,h.push(t)):(t.comprobanteId="",t.document="",t.operationId="",h.push(t))}return{ready:h,cmpbNotInBank:d}},O=(t,e)=>t&&t.sort(((t,o)=>{let n=t[e],a=o[e];return n<a?-1:n>a?1:0})),S=(t,e)=>t&&t.sort(((t,o)=>{let a=(0,n.Vd)(t[e]),r=(0,n.Vd)(o[e]);return a<r?-1:a>r?1:0})),P=t=>{let e={...t};var o,n,a,r,u,i;(e.hasOwnProperty("Date")&&(e.date=new Date(e.Date).getTime()+65e3,e.dateDDMMYYYY=e.Date,delete e.Date),e.hasOwnProperty("Posting Date")&&(e.date=e["Posting Date"],delete e["Posting Date"]),e.hasOwnProperty("Check Number")||e.hasOwnProperty('"Check Number"'))&&(e.checkOrSlip=null===(o=e["Check Number"])||void 0===o?void 0:o.trim(),delete e["Check Number"]);e.hasOwnProperty('"Check Number"')&&(e.checkOrSlip=null===(n=e['"Check Number"'])||void 0===n?void 0:n.trim(),delete e['"Check Number"']);e.hasOwnProperty("Check or Slip #")&&(e.checkOrSlip=null===(a=e["Check or Slip #"])||void 0===a?void 0:a.trim(),delete e["Check or Slip #"]);(e.hasOwnProperty("Amount")&&(e.amount=1*e.Amount,delete e.Amount),e.hasOwnProperty("Documento")&&(e.document=e.Documento.trim(),delete e.Documento),e.hasOwnProperty("Description"))&&(e.description=null===(r=e.Description)||void 0===r||null===(u=r.split('"'))||void 0===u||null===(i=u.join(""))||void 0===i?void 0:i.trim(),delete e.Description);return e},M=(t,e,o)=>(0,n.MV)("getPrevBalance",[t,e,o],(()=>{var o;let a=e.account;e.subAccount&&(a=e.account+"_"+e.subAccount);let r=null===(o=(0,n.bh)("accounts_summary_by_months"))||void 0===o?void 0:o[a],u=t-1,i=0;if((0,n.UE)(null===r||void 0===r?void 0:r[u])){let e=0;Array.from(Array(t).keys()).map((t=>{let o=(0,n.Zv)(r[t],2);e=1*e+1*o})),i=e}return i})),C=(t,e)=>{let o=[],a={},r=[],u=(0,n.bh)("date_range_submayor");for(let n in e){let t=e[n];t.date>=(null===u||void 0===u?void 0:u.initDate)&&t.date<=(null===u||void 0===u?void 0:u.lastDate)&&r.push(t)}for(let i in t){let e=P(t[i]);if(e.date){let t=!1;for(let o in r){let n=r[o];a[n.bankRecordId]||n.description!==e.description||n.amount!==e.amount||n.checkOrSlip!==e.checkOrSlip||(t=!0,a[n.bankRecordId]=1)}t||(e.bankRecordId=(0,n.M5)(),o.push(e))}}return o},Q=(t,e)=>{(0,n.DF)(t,U,e)},U=async(t,e,o,a)=>{const r=(0,n.I7)(t),u=await r;if(u)return a&&o.length-1===e&&a(),u}}}]);
//# sourceMappingURL=4050.27a17767.chunk.js.map