"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[4493],{7852:(e,s,o)=>{o.d(s,{Z:()=>n});o(2791),o(1534);var i=o(9760),l=o(184);const n=e=>{let{data:s,confirm:o,handleClick:n,close:d}=e;const{modalID:t}=s;return(0,l.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"18vh",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,l.jsxs)("div",{className:"_dsplFlx ",children:[(0,l.jsx)("p",{className:"form_title",style:{color:"var(--hrm_palette-static-brand-red"},children:"Lo sentimos"}),(0,l.jsx)("div",{className:"flexSpace"})]}),(0,l.jsx)("div",{className:"_dsplFlx ",children:(0,l.jsx)("span",{children:"no tiene acceso a esta operacion"})}),(0,l.jsxs)("div",{className:"_dsplFlx ",style:{padding:"5px 10px"},children:[(0,l.jsx)("div",{className:"flexSpace"}),(0,l.jsx)("p",{className:"group_title addBtn blue",onClick:()=>{(0,i.CloseModal)({id:t})},children:"OK"})]})]})}},4493:(e,s,o)=>{o.r(s),o.d(s,{default:()=>y});var i=o(2791),l=o(2350),n=(o(7889),o(24)),d=o(9760),t=o(713),a=o(2647),r=o(8779),c=o(7852),v=o(6824),u=o(4622),p=o(7709),m=o(184);const h=(0,a.PU)(),b=(0,n.AA)(),I=((0,n.P3)(),(0,a.tW)()),_="new_product_entry_comprobante",y=e=>{var s,o;let{data:n,elmId:a,handleRefreshAll:y}=e;const[x,f]=(0,i.useState)(!1),[j,g]=(0,i.useState)(0),[N,Q]=(0,i.useState)(!1);(0,i.useEffect)((()=>{x||(f(!0),g((0,l.M5)()))}));const k=()=>{},w=()=>{};(0,t.Zj)(null===(s=(0,l.bh)("sub_product_group"))||void 0===s?void 0:s[n.productId],"subProduct");return(0,m.jsxs)("div",{className:"item_acc",children:[(0,m.jsxs)("div",{className:"_dsplFlx item_box product_header",children:[(0,m.jsxs)("div",{className:"_dsplFlx",children:[(0,m.jsx)("div",{className:"code centerBx",onClick:()=>(async()=>{if((0,l.I0)()){(0,l.Rz)(_,n),(0,l.Rz)(_+"_bck",JSON.parse(JSON.stringify(n))),(0,l.Rz)("productListOnVoucherCmp",n.products);let e={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,m.jsx)(b,{confirm:k,updateView:!0}),(0,d.OpenModal)(e)}})(),children:null===n||void 0===n?void 0:n.invoice}),(0,m.jsx)("div",{className:"name centerBx",children:null===n||void 0===n?void 0:n.clientName})]}),(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("div",{className:" addSbAcc purple centerBx",onClick:()=>(async()=>{Q(!0),(0,l.Rz)("bluePrint",null);let e=n||{},s={invoice:null===e||void 0===e?void 0:e.invoice,date:null===e||void 0===e?void 0:e.date,clientAddress:null===e||void 0===e?void 0:e.clientAddress,clientName:null===e||void 0===e?void 0:e.clientName,products:[]},o=(new Date).getTime()+800;if(s.date){o=new Date(s.date).getTime()||o}s.date=o;const i=n.products.map((async e=>{var o,i;let n=null===(o=(0,l.bh)("products_ids"))||void 0===o?void 0:o[null===e||void 0===e?void 0:e.productId],d={};if(d.productName=null===n||void 0===n?void 0:n.name,d.qty=1*(null===e||void 0===e?void 0:e.qty),null!==e&&void 0!==e&&null!==(i=e.bluePrint)&&void 0!==i&&i.type){var t;let s=document.getElementById(e.productId+"_"+(null===e||void 0===e||null===(t=e.bluePrint)||void 0===t?void 0:t.type)),o=await u.YM(s);d.profile=null===e||void 0===e?void 0:e.profile,d.pngId=o}s.products.push(d)}));await Promise.all(i);let d=await(0,v.jD)(s);Q(!1),window.open(d)})(),children:N?(0,m.jsxs)("div",{className:"icon_compr _dsplFlx centerBx",children:[(0,m.jsx)("div",{className:"lbl_saving ",children:"generating report ..."}),(0,m.jsx)(I,{stroke:"var(--partial-success)",size:24,strokeW:8})]}):(0,m.jsx)("div",{children:"Print"})}),(0,l.I0)()?(0,m.jsx)("div",{className:"icon",style:{marginLeft:19},onClick:()=>{let e=(0,l.bh)("lastTimeCallModal")||0;if((0,l.I0)()){if(Date.now()>e){(0,l.Rz)("lastTimeCallModal",Date.now()+320);let e={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};e.content=(0,m.jsx)(r.Z,{label:"Eliminar Voucher",confirm:w,item:n}),(0,d.OpenModal)(e)}}else{let e={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};e.content=(0,m.jsx)(c.Z,{}),(0,d.OpenModal)(e)}},children:(0,m.jsx)(h,{name:"outline_delete",color:"#c62828"})}):null]}),(0,m.jsx)("div",{className:"rndImghidde",children:n.products&&(null===(o=n.products)||void 0===o?void 0:o.map(((e,s)=>{var o,i;const l={LL:(0,m.jsx)(p.gY,{item:e,svDm:null===e||void 0===e?void 0:e.bluePrint,addBlPr:()=>{},profile:null===e||void 0===e?void 0:e.profile},s+"_"+(null===e||void 0===e?void 0:e.productId)),U:(0,m.jsx)(p.Xu,{item:e,svDm:null===e||void 0===e?void 0:e.bluePrint,addBlPr:()=>{},profile:null===e||void 0===e?void 0:e.profile},s+"_"+(null===e||void 0===e?void 0:e.productId))};return null!==e&&void 0!==e&&null!==(o=e.bluePrint)&&void 0!==o&&o.type?l[null===e||void 0===e||null===(i=e.bluePrint)||void 0===i?void 0:i.type]:null})))})]})}},8779:(e,s,o)=>{o.d(s,{Z:()=>n});o(2791),o(1534);var i=o(9760),l=o(184);const n=e=>{let{data:s,confirm:o,label:n,close:d}=e;const{modalID:t}=s,a=e=>{(0,i.CloseModal)({id:t})};return(0,l.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"28vh",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,l.jsxs)("div",{className:"_dsplFlx ",children:[(0,l.jsx)("p",{className:"form_title",children:n}),(0,l.jsx)("div",{className:"flexSpace"})]}),(0,l.jsx)("div",{className:"_dsplFlx ",children:(0,l.jsx)("span",{children:"Una vez eliminado no podra ser recuperado"})}),(0,l.jsxs)("div",{className:"_dsplFlx ",style:{padding:"15px 10px"},children:[(0,l.jsx)("div",{className:"flexSpace"}),(0,l.jsx)("p",{className:"group_title addBtn",onClick:a,children:"Cancelar"}),(0,l.jsx)("p",{className:"group_title addBtn red",onClick:()=>{o(),a()},children:"Eliminar"})]})]})}},713:(e,s,o)=>{o.d(s,{$P:()=>p,B8:()=>_,IR:()=>a,QJ:()=>u,Rd:()=>d,VI:()=>I,Ve:()=>v,WA:()=>b,ZW:()=>n,Zj:()=>m,ii:()=>c,nj:()=>h,qT:()=>t,qv:()=>r,yk:()=>l});var i=o(2350);const l=async e=>{var s,o;let l={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.scan_voucher_production};if(l.params={businessId:null===(o=(0,i.bh)("profileUser"))||void 0===o?void 0:o.businessId,limit:120},(0,i.bh)("searchVoucherQry")&&(0,i.bh)("searchVoucherQry").length>1){(0,i.bh)("searchVoucherQry").split(" ").map(((e,s)=>{e&&(l.params[":search"+s]=e.trim())}));const s=(0,i.I7)(l),o=await s;o&&((0,i.Rz)("voucher_production",o),(0,i.Rz)("vouchers_list",m((0,i.jQ)(o),"voucherId")),e&&e())}else(0,i.Rz)("vouchers_list",null),e&&e()},n=async(e,s)=>{var o,l;let n={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.get_inventory_prod};n.params={businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,":productId":e};const d=(0,i.I7)(n),t=await d;t&&((0,i.Rz)("inv_products_list",m((0,i.jQ)(t.list),"name")),(0,i.Rz)("inv_products_stock",t.stock),s&&s())},d=async(e,s)=>{var o,l;let n={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.get_prod_stock};n.params={businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,productId:e};const d=(0,i.I7)(n),t=await d;if(t){let o={...(0,i.bh)("products_stock")};o[e]=t.stock,(0,i.Rz)("products_stock",o),s&&s()}},t=async e=>{var s,o;let l={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.all_prods};l.params={businessId:null===(o=(0,i.bh)("profileUser"))||void 0===o?void 0:o.businessId},l.subQuerys={},l.subQuerys.stock=1;const n=(0,i.I7)(l),d=await n;if(d){let s={},o=[],l=0;d.map((e=>{var n;if(null!==e&&void 0!==e&&null!==(n=e.inventory)&&void 0!==n&&n.qty){var d,t,a;if(l+=1*(0,i.Zv)(null===e||void 0===e||null===(d=e.inventory)||void 0===d?void 0:d.amount,2),s[e.unit])s[e.unit]+=null===e||void 0===e||null===(t=e.inventory)||void 0===t?void 0:t.qty;else s[e.unit]=null===e||void 0===e||null===(a=e.inventory)||void 0===a?void 0:a.qty;o.push({productId:e.productId,name:e.name,unit:e.unit,qty:(1*e.inventory.qty).toFixed(2),amount:(1*e.inventory.amount).toFixed(2),cost:(e.inventory.amount/e.inventory.qty*1).toFixed(2)})}})),(0,i.Ey)(e)&&e({list:m(o,"name"),total:l,units:s})}},a=async(e,s)=>{var o,l;let n={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.group_prod_stock};n.params={businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId};const d=(0,i.I7)(n),t=await d;if(t){let o=(0,i._I)(t.comps),l=0,n=0,d=0,a=[],r=[];(0,i._2)(e).map((s=>{let c={...e[s]},v=("debit"===e[s].type?1:-1)*e[s].amount,u=1*(0,i.Zv)(v,2);if(l+=u,t.comps[e[s].comprobanteId]){c.inventory=t.comps[e[s].comprobanteId];let l=0;if((0,i._2)(t.comps[e[s].comprobanteId]).map((o=>{l=1*(0,i.Zv)(l,2)+1*(0,i.Zv)(t.comps[e[s].comprobanteId][o],2)})),l=l<0?-1*l:l,l=1*(0,i.Zv)(l,2),c.inventoryAmount=l,n+=l,u=u<0?-1*u:u,u-l!==0){let e=u-l;d+=e,r.push(c),console.log("diff",c,u,l,e)}else a.push(c);delete o[e[s].comprobanteId]}else d+=v,r.push(c)}));let c=0;(0,i._2)(o).map((e=>{let s=0;(0,i._2)(o[e]).map((l=>{s=1*(0,i.Zv)(s,2)+1*(0,i.Zv)(o[e][l],2)})),c+=s})),console.log("inventoryBack",o,"inventoryBackTotal",c),(0,i.Rz)("inv_comprobantes_compare",{hasError:r,success:a,inventoryBack:o}),(0,i.Ey)(s)&&s()}},r=async e=>{var s,o,l;let n={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.filter_search_opera};n.params={businessId:null===(o=(0,i.bh)("profileUser"))||void 0===o?void 0:o.businessId,year:(0,i.bh)("date_current_year"),":account":null===(l=(0,i.bh)("global_account_params"))||void 0===l?void 0:l.inventory.account};const d=(0,i.I7)(n),t=await d;t&&!t.error&&(0,i.Ey)(e)&&e(m((0,i.jQ)(t),"date"))},c=async e=>{var s,o;let l={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.all_prods};l.params={businessId:null===(o=(0,i.bh)("profileUser"))||void 0===o?void 0:o.businessId};const n=(0,i.I7)(l),d=await n;d&&((0,i.Rz)("products_list",m(d,"name")),(0,i.Rz)("products_ids",(0,i.ME)((0,i.jQ)(d),"productId")),e&&e())},v=async e=>{var s,o;let l={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.search_prod};if(l.params={businessId:null===(o=(0,i.bh)("profileUser"))||void 0===o?void 0:o.businessId,limit:120},(0,i.bh)("searchQry").length>1){(0,i.bh)("searchQry").split(" ").map(((e,s)=>{e&&(l.params[":search"+s]=e.trim())}));const s=(0,i.I7)(l),o=await s;o&&((0,i.Rz)("products_list",m((0,i.jQ)(o),"code")),e&&e())}else(0,i.Rz)("products_list",null),e&&e()},u=async e=>{var s,o;let l={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.all_entry_invoices};l.params={businessId:null===(o=(0,i.bh)("profileUser"))||void 0===o?void 0:o.businessId};const n=(0,i.I7)(l),d=await n;d&&((0,i.Rz)("movements_list",m(d,"date")),(0,i.Rz)("movements_ids",(0,i.ME)((0,i.jQ)(d),"inventoryId")),e&&e())},p=async e=>{var s;if((null===(s=(0,i.bh)("searchMovQry"))||void 0===s?void 0:s.length)>1){var o,l;let s={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.search_inventory};s.params={businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,":search0":(0,i.bh)("searchMovQry")};const n=(0,i.I7)(s),d=await n;d&&((0,i.Rz)("movements_list",function(e){var s={};let o=e&&(0,i._2)(e);o.length>0?o.map((o=>{let i=e[o];s[i.comprobanteId]||(s[i.comprobanteId]={},s[i.comprobanteId].amount=0,s[i.comprobanteId].document=i.document,s[i.comprobanteId].date=i.date,s[i.comprobanteId].comprobanteId=i.comprobanteId,s[i.comprobanteId].products=[]),s[i.comprobanteId].amount+=i.qty*i.price,s[i.comprobanteId].products.push({productId:i.productId,qty:i.qty,price:i.price,inventoryId:i.inventoryId})})):s=null;return s}(d)),(0,i.Rz)("movements_ids",d),e&&e())}else(0,i.Rz)("movements_list",[]),(0,i.Rz)("movements_ids",{}),e&&e()};const m=(e,s)=>(0,i.MV)("sortProducts",[e],(()=>e&&e.sort(((e,o)=>{let i=e[s],l=o[s];return i<l?-1:i>l?1:0})))),h=async(e,s)=>{var o,l;let n={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.delete_prod};n.params={businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,productId:e};const d=(0,i.I7)(n);await d&&s&&s()},b=async(e,s)=>{var o,l;let n={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.delete_inventory};n.params={businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,inventoryId:e};const d=(0,i.I7)(n);await d&&s&&s()},I=async(e,s)=>{var o,l;({...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.entry_invoice_acc_2}).params={businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,entriesInvoiceId:e}},_=(e,s)=>(0,i.MV)("rangeProdArr",[e,s],(()=>e?(0,i._2)(e).slice(0,s):[]))}}]);
//# sourceMappingURL=4493.17c3f353.chunk.js.map