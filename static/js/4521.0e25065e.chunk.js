"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[4521],{4521:(e,o,s)=>{s.r(o),s.d(o,{default:()=>a});var n=s(2791),i=s(2350),t=s(2647),r=(s(1534),s(713)),d=s(184);const l=(0,t.kp)(),a=e=>{var o;let{handleClick:s}=e;const[t,a]=(0,n.useState)(!1),[u,v]=(0,n.useState)(0),[p,h]=(0,n.useState)(!1),[m,b]=(0,n.useState)([]),I=(0,n.useRef)();(0,n.useEffect)((()=>{t||(a(!0),(0,r.ii)(_),v((0,i.M5)()))}));const _=e=>{v((0,i.M5)())},y=(e,o)=>{s(e,o),I.current.clearTx()};return(0,d.jsx)("div",{children:(0,d.jsx)(l,{placeholder:(0,i.zE)(12),width:420,fetchData:e=>{b(function(e,o){let s=o.toLowerCase();var n=[];e.length>0&&e.map((e=>{var o,i,t,r,d;((null===(o=e.name)||void 0===o||null===(i=o.toLowerCase())||void 0===i?void 0:i.indexOf(s))>=0||(null===(t=e.upc_barcode)||void 0===t||null===(r=t.toString())||void 0===r||null===(d=r.toLowerCase())||void 0===d?void 0:d.indexOf(s))>=0)&&n.push(e)}));return n}((0,i.bh)("products_list"),e)),p&&h(!1)},loading:p,change:e=>{!p&&h(!0)},callempty:e=>{b([]),p&&h(!1)},ref:I,children:(0,d.jsx)("div",{className:"",children:m&&(null===(o=(0,i._2)(m))||void 0===o?void 0:o.map((e=>(0,d.jsx)(c,{data:m[e],elmId:e,selectItem:y},e))))})})})},c=e=>{let{data:o,selectItem:s}=e;return(0,d.jsx)("div",{className:"item_acc",children:(0,d.jsx)("div",{className:"_dsplFlx item_box account_header",children:(0,d.jsx)("div",{className:"_dsplFlx",onClick:()=>s(o,null),children:(0,d.jsx)("div",{className:"code",children:null===o||void 0===o?void 0:o.name})})})})}},713:(e,o,s)=>{s.d(o,{$P:()=>h,B8:()=>y,IR:()=>a,QJ:()=>p,Rd:()=>d,VI:()=>_,Ve:()=>v,WA:()=>I,ZW:()=>r,Zj:()=>m,fK:()=>i,ii:()=>u,nj:()=>b,qT:()=>l,qv:()=>c,yk:()=>t});var n=s(2350);const i=async(e,o)=>{var s,i;let t={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.scan_voucher_production};t.params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId,":search0":e};const r=(0,n.I7)(t),d=await r;d&&!d.error&&(0,n._2)(d)&&(0,n._2)(d).length>0?o&&o(d):o&&o(null)},t=async e=>{var o,s;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.scan_voucher_production};if(i.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId,limit:120},(0,n.bh)("searchVoucherQry")&&(0,n.bh)("searchVoucherQry").length>1){(0,n.bh)("searchVoucherQry").split(" ").map(((e,o)=>{e&&(i.params[":search"+o]=e.trim())}));const o=(0,n.I7)(i),s=await o;s&&((0,n.Rz)("voucher_production",s),(0,n.Rz)("vouchers_list",m((0,n.jQ)(s),"voucherId")),e&&e())}else(0,n.Rz)("vouchers_list",null),e&&e()},r=async(e,o)=>{var s,i;let t={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.get_inventory_prod};t.params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId,":productId":e};const r=(0,n.I7)(t),d=await r;d&&((0,n.Rz)("inv_products_list",m((0,n.jQ)(d.list),"name")),(0,n.Rz)("inv_products_stock",d.stock),o&&o())},d=async(e,o)=>{var s,i;let t={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.get_prod_stock};t.params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId,productId:e};const r=(0,n.I7)(t),d=await r;if(d){let s={...(0,n.bh)("products_stock")};s[e]=d.stock,(0,n.Rz)("products_stock",s),o&&o()}},l=async e=>{var o,s;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.all_prods};i.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId},i.subQuerys={},i.subQuerys.stock=1;const t=(0,n.I7)(i),r=await t;if(r){let o={},s=[],i=0;r.map((e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.inventory)&&void 0!==t&&t.qty){var r,d,l;if(i+=1*(0,n.Zv)(null===e||void 0===e||null===(r=e.inventory)||void 0===r?void 0:r.amount,2),o[e.unit])o[e.unit]+=null===e||void 0===e||null===(d=e.inventory)||void 0===d?void 0:d.qty;else o[e.unit]=null===e||void 0===e||null===(l=e.inventory)||void 0===l?void 0:l.qty;s.push({productId:e.productId,name:e.name,unit:e.unit,qty:(1*e.inventory.qty).toFixed(2),amount:(1*e.inventory.amount).toFixed(2),cost:(e.inventory.amount/e.inventory.qty*1).toFixed(2)})}})),(0,n.Ey)(e)&&e({list:m(s,"name"),total:i,units:o})}},a=async(e,o)=>{var s,i;let t={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.group_prod_stock};t.params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId};const r=(0,n.I7)(t),d=await r;if(d){let s=(0,n._I)(d.comps),i=0,t=0,r=0,l=[],a=[];(0,n._2)(e).map((o=>{let c={...e[o]},u=("debit"===e[o].type?1:-1)*e[o].amount,v=1*(0,n.Zv)(u,2);if(i+=v,d.comps[e[o].comprobanteId]){c.inventory=d.comps[e[o].comprobanteId];let i=0;if((0,n._2)(d.comps[e[o].comprobanteId]).map((s=>{i=1*(0,n.Zv)(i,2)+1*(0,n.Zv)(d.comps[e[o].comprobanteId][s],2)})),i=i<0?-1*i:i,i=1*(0,n.Zv)(i,2),c.inventoryAmount=i,t+=i,v=v<0?-1*v:v,v-i!==0){let e=v-i;r+=e,a.push(c),console.log("diff",c,v,i,e)}else l.push(c);delete s[e[o].comprobanteId]}else r+=u,a.push(c)}));let c=0;(0,n._2)(s).map((e=>{let o=0;(0,n._2)(s[e]).map((i=>{o=1*(0,n.Zv)(o,2)+1*(0,n.Zv)(s[e][i],2)})),c+=o})),console.log("inventoryBack",s,"inventoryBackTotal",c),(0,n.Rz)("inv_comprobantes_compare",{hasError:a,success:l,inventoryBack:s}),(0,n.Ey)(o)&&o()}},c=async e=>{var o,s,i;let t={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.filter_search_opera};t.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId,year:(0,n.bh)("date_current_year"),":account":null===(i=(0,n.bh)("global_account_params"))||void 0===i?void 0:i.inventory.account};const r=(0,n.I7)(t),d=await r;d&&!d.error&&(0,n.Ey)(e)&&e(m((0,n.jQ)(d),"date"))},u=async e=>{var o,s;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.all_prods};i.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId};const t=(0,n.I7)(i),r=await t;r&&((0,n.Rz)("products_list",m(r,"name")),(0,n.Rz)("products_ids",(0,n.ME)((0,n.jQ)(r),"productId")),e&&e())},v=async e=>{var o,s;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.search_prod};if(i.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId,limit:120},(0,n.bh)("searchQry").length>1){(0,n.bh)("searchQry").split(" ").map(((e,o)=>{e&&(i.params[":search"+o]=e.trim())}));const o=(0,n.I7)(i),s=await o;s&&((0,n.Rz)("products_list",m((0,n.jQ)(s),"code")),e&&e())}else(0,n.Rz)("products_list",null),e&&e()},p=async e=>{var o,s;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.all_entry_invoices};i.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId};const t=(0,n.I7)(i),r=await t;r&&((0,n.Rz)("movements_list",m(r,"date")),(0,n.Rz)("movements_ids",(0,n.ME)((0,n.jQ)(r),"inventoryId")),e&&e())},h=async e=>{var o;if((null===(o=(0,n.bh)("searchMovQry"))||void 0===o?void 0:o.length)>1){var s,i;let o={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.search_inventory};o.params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId,":search0":(0,n.bh)("searchMovQry")};const t=(0,n.I7)(o),r=await t;r&&((0,n.Rz)("movements_list",function(e){var o={};let s=e&&(0,n._2)(e);s.length>0?s.map((s=>{let n=e[s];o[n.comprobanteId]||(o[n.comprobanteId]={},o[n.comprobanteId].amount=0,o[n.comprobanteId].document=n.document,o[n.comprobanteId].date=n.date,o[n.comprobanteId].comprobanteId=n.comprobanteId,o[n.comprobanteId].products=[]),o[n.comprobanteId].amount+=n.qty*n.price,o[n.comprobanteId].products.push({productId:n.productId,qty:n.qty,price:n.price,inventoryId:n.inventoryId})})):o=null;return o}(r)),(0,n.Rz)("movements_ids",r),e&&e())}else(0,n.Rz)("movements_list",[]),(0,n.Rz)("movements_ids",{}),e&&e()};const m=(e,o)=>(0,n.MV)("sortProducts",[e],(()=>e&&e.sort(((e,s)=>{let n=e[o],i=s[o];return n<i?-1:n>i?1:0})))),b=async(e,o)=>{var s,i;let t={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.delete_prod};t.params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId,productId:e};const r=(0,n.I7)(t);await r&&o&&o()},I=async(e,o)=>{var s,i;let t={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.delete_inventory};t.params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId,inventoryId:e};const r=(0,n.I7)(t);await r&&o&&o()},_=async(e,o)=>{var s,i;({...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.entry_invoice_acc_2}).params={businessId:null===(i=(0,n.bh)("profileUser"))||void 0===i?void 0:i.businessId,entriesInvoiceId:e}},y=(e,o)=>(0,n.MV)("rangeProdArr",[e,o],(()=>e?(0,n._2)(e).slice(0,o):[]))},1534:()=>{}}]);
//# sourceMappingURL=4521.0e25065e.chunk.js.map