"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[4521],{4521:(e,o,s)=>{s.r(o),s.d(o,{default:()=>a});var n=s(2791),t=s(2350),i=s(2647),r=(s(1534),s(713)),d=s(184);const l=(0,i.kp)(),a=e=>{var o;let{handleClick:s}=e;const[i,a]=(0,n.useState)(!1),[u,v]=(0,n.useState)(0),[p,h]=(0,n.useState)(!1),[m,b]=(0,n.useState)([]),I=(0,n.useRef)();(0,n.useEffect)((()=>{i||(a(!0),(0,r.ii)(y),v((0,t.M5)()))}));const y=e=>{v((0,t.M5)())},_=(e,o)=>{s(e,o),I.current.clearTx()};return(0,d.jsx)("div",{children:(0,d.jsx)(l,{placeholder:(0,t.zE)(12),width:420,fetchData:e=>{b(function(e,o){let s=o.toLowerCase();var n=[];e.length>0&&e.map((e=>{var o,t,i,r,d;((null===(o=e.name)||void 0===o||null===(t=o.toLowerCase())||void 0===t?void 0:t.indexOf(s))>=0||(null===(i=e.upc_barcode)||void 0===i||null===(r=i.toString())||void 0===r||null===(d=r.toLowerCase())||void 0===d?void 0:d.indexOf(s))>=0)&&n.push(e)}));return n}((0,t.bh)("products_list"),e)),p&&h(!1)},loading:p,change:e=>{!p&&h(!0)},callempty:e=>{b([]),p&&h(!1)},ref:I,children:(0,d.jsx)("div",{className:"",children:m&&(null===(o=(0,t._2)(m))||void 0===o?void 0:o.map((e=>(0,d.jsx)(c,{data:m[e],elmId:e,selectItem:_},e))))})})})},c=e=>{let{data:o,selectItem:s}=e;return(0,d.jsx)("div",{className:"item_acc",children:(0,d.jsx)("div",{className:"_dsplFlx item_box account_header",children:(0,d.jsx)("div",{className:"_dsplFlx",onClick:()=>s(o,null),children:(0,d.jsx)("div",{className:"code",children:null===o||void 0===o?void 0:o.name})})})})}},713:(e,o,s)=>{s.d(o,{$P:()=>p,B8:()=>y,IR:()=>l,QJ:()=>v,Rd:()=>r,VI:()=>I,Ve:()=>u,WA:()=>b,ZW:()=>i,Zj:()=>h,ii:()=>c,nj:()=>m,qT:()=>d,qv:()=>a,yk:()=>t});var n=s(2350);const t=async e=>{var o,s;let t={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.scan_voucher_production};if(t.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId,limit:120},(0,n.bh)("searchVoucherQry")&&(0,n.bh)("searchVoucherQry").length>1){(0,n.bh)("searchVoucherQry").split(" ").map(((e,o)=>{e&&(t.params[":search"+o]=e.trim())}));const o=(0,n.I7)(t),s=await o;s&&((0,n.Rz)("voucher_production",s),(0,n.Rz)("vouchers_list",h((0,n.jQ)(s),"voucherId")),e&&e())}else(0,n.Rz)("vouchers_list",null),e&&e()},i=async(e,o)=>{var s,t;let i={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.get_inventory_prod};i.params={businessId:null===(t=(0,n.bh)("profileUser"))||void 0===t?void 0:t.businessId,":productId":e};const r=(0,n.I7)(i),d=await r;d&&((0,n.Rz)("inv_products_list",h((0,n.jQ)(d.list),"name")),(0,n.Rz)("inv_products_stock",d.stock),o&&o())},r=async(e,o)=>{var s,t;let i={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.get_prod_stock};i.params={businessId:null===(t=(0,n.bh)("profileUser"))||void 0===t?void 0:t.businessId,productId:e};const r=(0,n.I7)(i),d=await r;if(d){let s={...(0,n.bh)("products_stock")};s[e]=d.stock,(0,n.Rz)("products_stock",s),o&&o()}},d=async e=>{var o,s;let t={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.all_prods};t.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId},t.subQuerys={},t.subQuerys.stock=1;const i=(0,n.I7)(t),r=await i;if(r){let o={},s=[],t=0;r.map((e=>{var i;if(null!==e&&void 0!==e&&null!==(i=e.inventory)&&void 0!==i&&i.qty){var r,d,l;if(t+=1*(0,n.Zv)(null===e||void 0===e||null===(r=e.inventory)||void 0===r?void 0:r.amount,2),o[e.unit])o[e.unit]+=null===e||void 0===e||null===(d=e.inventory)||void 0===d?void 0:d.qty;else o[e.unit]=null===e||void 0===e||null===(l=e.inventory)||void 0===l?void 0:l.qty;s.push({productId:e.productId,name:e.name,unit:e.unit,qty:(1*e.inventory.qty).toFixed(2),amount:(1*e.inventory.amount).toFixed(2),cost:(e.inventory.amount/e.inventory.qty*1).toFixed(2)})}})),(0,n.Ey)(e)&&e({list:h(s,"name"),total:t,units:o})}},l=async(e,o)=>{var s,t;let i={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.group_prod_stock};i.params={businessId:null===(t=(0,n.bh)("profileUser"))||void 0===t?void 0:t.businessId};const r=(0,n.I7)(i),d=await r;if(d){let s=(0,n._I)(d.comps),t=0,i=0,r=0,l=[],a=[];(0,n._2)(e).map((o=>{let c={...e[o]},u=("debit"===e[o].type?1:-1)*e[o].amount,v=1*(0,n.Zv)(u,2);if(t+=v,d.comps[e[o].comprobanteId]){c.inventory=d.comps[e[o].comprobanteId];let t=0;if((0,n._2)(d.comps[e[o].comprobanteId]).map((s=>{t=1*(0,n.Zv)(t,2)+1*(0,n.Zv)(d.comps[e[o].comprobanteId][s],2)})),t=t<0?-1*t:t,t=1*(0,n.Zv)(t,2),c.inventoryAmount=t,i+=t,v=v<0?-1*v:v,v-t!==0){let e=v-t;r+=e,a.push(c),console.log("diff",c,v,t,e)}else l.push(c);delete s[e[o].comprobanteId]}else r+=u,a.push(c)}));let c=0;(0,n._2)(s).map((e=>{let o=0;(0,n._2)(s[e]).map((t=>{o=1*(0,n.Zv)(o,2)+1*(0,n.Zv)(s[e][t],2)})),c+=o})),console.log("inventoryBack",s,"inventoryBackTotal",c),(0,n.Rz)("inv_comprobantes_compare",{hasError:a,success:l,inventoryBack:s}),(0,n.Ey)(o)&&o()}},a=async e=>{var o,s,t;let i={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.filter_search_opera};i.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId,year:(0,n.bh)("date_current_year"),":account":null===(t=(0,n.bh)("global_account_params"))||void 0===t?void 0:t.inventory.account};const r=(0,n.I7)(i),d=await r;d&&!d.error&&(0,n.Ey)(e)&&e(h((0,n.jQ)(d),"date"))},c=async e=>{var o,s;let t={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.all_prods};t.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId};const i=(0,n.I7)(t),r=await i;r&&((0,n.Rz)("products_list",h(r,"name")),(0,n.Rz)("products_ids",(0,n.ME)((0,n.jQ)(r),"productId")),e&&e())},u=async e=>{var o,s;let t={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.search_prod};if(t.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId,limit:120},(0,n.bh)("searchQry").length>1){(0,n.bh)("searchQry").split(" ").map(((e,o)=>{e&&(t.params[":search"+o]=e.trim())}));const o=(0,n.I7)(t),s=await o;s&&((0,n.Rz)("products_list",h((0,n.jQ)(s),"code")),e&&e())}else(0,n.Rz)("products_list",null),e&&e()},v=async e=>{var o,s;let t={...null===(o=(0,n.bh)((0,n.hQ)()))||void 0===o?void 0:o.all_entry_invoices};t.params={businessId:null===(s=(0,n.bh)("profileUser"))||void 0===s?void 0:s.businessId};const i=(0,n.I7)(t),r=await i;r&&((0,n.Rz)("movements_list",h(r,"date")),(0,n.Rz)("movements_ids",(0,n.ME)((0,n.jQ)(r),"inventoryId")),e&&e())},p=async e=>{var o;if((null===(o=(0,n.bh)("searchMovQry"))||void 0===o?void 0:o.length)>1){var s,t;let o={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.search_inventory};o.params={businessId:null===(t=(0,n.bh)("profileUser"))||void 0===t?void 0:t.businessId,":search0":(0,n.bh)("searchMovQry")};const i=(0,n.I7)(o),r=await i;r&&((0,n.Rz)("movements_list",function(e){var o={};let s=e&&(0,n._2)(e);s.length>0?s.map((s=>{let n=e[s];o[n.comprobanteId]||(o[n.comprobanteId]={},o[n.comprobanteId].amount=0,o[n.comprobanteId].document=n.document,o[n.comprobanteId].date=n.date,o[n.comprobanteId].comprobanteId=n.comprobanteId,o[n.comprobanteId].products=[]),o[n.comprobanteId].amount+=n.qty*n.price,o[n.comprobanteId].products.push({productId:n.productId,qty:n.qty,price:n.price,inventoryId:n.inventoryId})})):o=null;return o}(r)),(0,n.Rz)("movements_ids",r),e&&e())}else(0,n.Rz)("movements_list",[]),(0,n.Rz)("movements_ids",{}),e&&e()};const h=(e,o)=>(0,n.MV)("sortProducts",[e],(()=>e&&e.sort(((e,s)=>{let n=e[o],t=s[o];return n<t?-1:n>t?1:0})))),m=async(e,o)=>{var s,t;let i={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.delete_prod};i.params={businessId:null===(t=(0,n.bh)("profileUser"))||void 0===t?void 0:t.businessId,productId:e};const r=(0,n.I7)(i);await r&&o&&o()},b=async(e,o)=>{var s,t;let i={...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.delete_inventory};i.params={businessId:null===(t=(0,n.bh)("profileUser"))||void 0===t?void 0:t.businessId,inventoryId:e};const r=(0,n.I7)(i);await r&&o&&o()},I=async(e,o)=>{var s,t;({...null===(s=(0,n.bh)((0,n.hQ)()))||void 0===s?void 0:s.entry_invoice_acc_2}).params={businessId:null===(t=(0,n.bh)("profileUser"))||void 0===t?void 0:t.businessId,entriesInvoiceId:e}},y=(e,o)=>(0,n.MV)("rangeProdArr",[e,o],(()=>e?(0,n._2)(e).slice(0,o):[]))},1534:()=>{}}]);
//# sourceMappingURL=4521.fe3a7df1.chunk.js.map