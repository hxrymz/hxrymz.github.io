"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[481],{481:(e,i,s)=>{s.r(i),s.d(i,{default:()=>j});var l=s(2791),d=s(2350),n=(s(3971),s(9760)),o=s(6496),a=s(2647),c=(s(261),s(184));const t=e=>{let{data:i,confirm:s,handleClick:l,close:d}=e;const{modalID:o}=i,a=e=>{(0,n.CloseModal)({id:o})};return(0,c.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"28vh",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("p",{className:"form_title",children:"Eliminar Invoice"}),(0,c.jsx)("div",{className:"flexSpace"})]}),(0,c.jsx)("div",{className:"_dsplFlx ",children:(0,c.jsx)("span",{children:"Una vez eliminado no podra ser recuperado"})}),(0,c.jsxs)("div",{className:"_dsplFlx ",style:{padding:"15px 10px"},children:[(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("p",{className:"group_title addBtn",onClick:a,children:"Cancelar"}),(0,c.jsx)("p",{className:"group_title addBtn red",onClick:()=>{s(),a()},children:"Eliminar"})]})]})},r=e=>{let{data:i,confirm:s,handleClick:l,close:d}=e;const{modalID:o}=i;return(0,c.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"18vh",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("p",{className:"form_title",style:{color:"var(--hrm_palette-static-brand-red"},children:"Lo sentimos"}),(0,c.jsx)("div",{className:"flexSpace"})]}),(0,c.jsx)("div",{className:"_dsplFlx ",children:(0,c.jsx)("span",{children:"no tiene acceso a esta operacion"})}),(0,c.jsxs)("div",{className:"_dsplFlx ",style:{padding:"5px 10px"},children:[(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("p",{className:"group_title addBtn blue",onClick:()=>{(0,n.CloseModal)({id:o})},children:"OK"})]})]})};var v=s(5986),m=s(24),u=s(713);const p=e=>{let{data:i,invoice:s}=e;const{modalID:l}=i;return(0,c.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"18vh",width:"520px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("p",{className:"form_title",style:{color:"var(--hrm_palette-static-brand-red"},children:"Lo sentimos"}),(0,c.jsx)("div",{className:"flexSpace"})]}),(0,c.jsxs)("div",{className:"_dsplFlx invoice_id_voucher",children:[(0,c.jsx)("h5",{children:"ya existe un Voucher associado con el invoice"}),(0,c.jsx)("h4",{children:s})]}),(0,c.jsxs)("div",{className:"_dsplFlx ",style:{padding:"5px 10px"},children:[(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("p",{className:"group_title addBtn blue",onClick:()=>{(0,n.CloseModal)({id:l})},children:"OK"})]})]})},h=(0,a.PU)(),x=(0,v.DY)(),b=(0,m.AA)(),_=(0,a.Np)(),f="updDocInvoice",j=e=>{var i,s;let{data:a,index:v,handleRefreshAll:m,show:j}=e;const[I,g]=(0,l.useState)(!1),[N,y]=(0,l.useState)(0),[C,w]=(0,l.useState)(0);if((0,l.useEffect)((()=>{I||(g(!0),y((0,d.M5)()))})),!j)return null;const k=()=>{y((0,d.M5)())},S=()=>{(0,o.p9)(k)},z=()=>{(0,o.jB)(null===a||void 0===a?void 0:a.invoiceId,m)},M=e=>{let i={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};if(e)i.content=(0,c.jsx)(p,{invoice:null===a||void 0===a?void 0:a.document.trim()});else{let e=null===a||void 0===a?void 0:a.description.split("Sale to ")[1];(0,d.Rz)("new_voucher",{invoice:null===a||void 0===a?void 0:a.document.trim(),invoiceId:null===a||void 0===a?void 0:a.invoiceId.trim(),clientName:e.trim()}),i.content=(0,c.jsx)(b,{})}(0,n.OpenModal)(i)};return(0,c.jsx)("div",{className:"item_acc ".concat(v),children:(0,c.jsxs)("div",{className:"_dsplFlx item_box invoice_header",children:[(0,c.jsx)("div",{className:"name",children:(0,d.sJ)(null===a||void 0===a?void 0:a.date)}),(0,c.jsx)("div",{className:"code",style:{marginLeft:15},onClick:()=>{w(!C)},children:null===a||void 0===a?void 0:a.document}),C?(0,c.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)(_,{init:(0,d.bh)(f),label:(0,d.zE)(2),width:520,updChanges:e=>(0,d.Rz)(f,e),onEnter:async e=>{var i,s;let l={...null===(i=(0,d.bh)((0,d.hQ)()))||void 0===i?void 0:i.upd_invoice};l.params={businessId:null===(s=(0,d.bh)("profileUser"))||void 0===s?void 0:s.businessId,invoiceId:null===a||void 0===a?void 0:a.invoiceId},l.data2update={document:e}}}),(0,c.jsx)("div",{className:"flexSpace"})]}):null,(0,c.jsx)("div",{className:"description",style:{marginLeft:15},children:null===a||void 0===a?void 0:a.description}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsx)("div",{className:"flexSpace"}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[null!==(i=(0,d.Ch)()[(0,d.bh)("date_current_year")])&&void 0!==i&&i.isClosed?null:(0,c.jsx)("div",{className:" addSbAcc purple",onClick:()=>{(0,u.fK)(null===a||void 0===a?void 0:a.document.trim(),M)},children:"add Voucher"}),(0,c.jsx)("div",{className:" addSbAcc purple",onClick:()=>(e=>{let i={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};i.content=(0,c.jsx)(x,{confirm:S,item:a}),(0,n.OpenModal)(i)})(),children:"See Details"})]}),(0,c.jsxs)("div",{className:"name hideOnHover",children:["$",(1*(null===a||void 0===a?void 0:a.amount)).toFixed(2)]}),(0,d.I0)()?null!==(s=(0,d.Ch)()[(0,d.bh)("date_current_year")])&&void 0!==s&&s.isClosed?null:(0,c.jsx)("div",{className:"icon",style:{marginLeft:19,zIndex:10},onClick:()=>{let e=(0,d.bh)("lastTimeCallModal")||0;if((0,d.I0)()){if(Date.now()>e){(0,d.Rz)("lastTimeCallModal",Date.now()+320);let e={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};e.content=(0,c.jsx)(t,{confirm:z,item:a}),(0,n.OpenModal)(e)}}else{let e={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};e.content=(0,c.jsx)(r,{}),(0,n.OpenModal)(e)}},children:(0,c.jsx)(h,{name:"outline_delete",color:"#c62828"})}):null]})})}},6496:(e,i,s)=>{s.d(i,{S$:()=>c,_3:()=>n,c_:()=>v,jB:()=>a,p9:()=>d});var l=s(2350);const d=async e=>{let i=(0,l.bh)("getall_invoice_last")||0;if(Date.now()>i){var s,d;(0,l.Rz)("getall_invoice_last",Date.now()+190);let i={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.all_invoices};i.params={businessId:null===(d=(0,l.bh)("profileUser"))||void 0===d?void 0:d.businessId};const n=(0,l.I7)(i),a=await n;a&&((0,l.Rz)("invoices_list",o(a,"document")),(0,l.Rz)("invoices_ids",(0,l.ME)((0,l.jQ)(a),"document")),e&&e())}},n=async e=>{var i,s;let d={...null===(i=(0,l.bh)((0,l.hQ)()))||void 0===i?void 0:i.search_invoice};d.params={businessId:null===(s=(0,l.bh)("profileUser"))||void 0===s?void 0:s.businessId,":search":(0,l.bh)("searchQry")};const n=(0,l.I7)(d),a=await n;a&&((0,l.Rz)("invoices_list",o((0,l.jQ)(a),"document")),e&&e())},o=(e,i,s)=>(0,l.MV)("sortInvoices",[e],(()=>e&&e.sort(((e,l)=>{let d=e[i],n=l[i];return d<n?s?-1:1:d>n?s?1:-1:0})))),a=async(e,i)=>{var s,d;let n={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.delete_invoice};n.params={businessId:null===(d=(0,l.bh)("profileUser"))||void 0===d?void 0:d.businessId,invoiceId:e};const o=(0,l.I7)(n);await o&&i&&i()},c=async e=>{var i,s;let d={...null===(i=(0,l.bh)((0,l.hQ)()))||void 0===i?void 0:i.all_invoices};d.params={businessId:null===(s=(0,l.bh)("profileUser"))||void 0===s?void 0:s.businessId};const n=(0,l.I7)(d),o=await n;o&&((0,l.Rz)("invoiceCmp",o),t("SSJsgB2uUqcuoagD",(()=>{t("v5MkYLwPAbgci3wW",(()=>{let i=r();(0,l.Rz)("invoiceCmpDocs",i),e&&e()}))})))},t=async(e,i)=>{var s,d;let n={...null===(s=(0,l.bh)((0,l.hQ)()))||void 0===s?void 0:s.filter_search_opera};n.params={businessId:null===(d=(0,l.bh)("profileUser"))||void 0===d?void 0:d.businessId,year:(0,l.bh)("date_current_year"),":account":e};const o=(0,l.I7)(n),a=await o;a&&!a.error?((0,l.Rz)("invoiceCmp"+e,a),i&&i()):i&&i()},r=()=>{let e=(0,l.bh)("invoiceCmp"),i=(0,l.bh)("invoiceCmpSSJsgB2uUqcuoagD"),s=(0,l.bh)("invoiceCmpv5MkYLwPAbgci3wW"),d={};return(0,l._2)(e).map((i=>{let s=e[i].document.trim();var l,n;d[s]||(d[s]={document:s,invoiceId:null===(l=e[i])||void 0===l?void 0:l.invoiceId,invoiceLinkConfirmed:null===(n=e[i])||void 0===n?void 0:n.invoiceLinkConfirmed,amount:0,saldo:0,hasAnticipo:0,cc_c:0,cc_d:0,comprobanteIds:{}});d[s].amount+=e[i].amount,d[s].saldo+=1*e[i].amount,d[s].date=e[i].date})),(0,l._2)(i).map((e=>{var s,l,n;let o=i[e].document.trim();d[o]||(d[o]={document:o,amount:0,saldo:0,hasAnticipo:0,cc_c:0,cc_d:0,comprobanteIds:{}}),d[o].cc_d+="debit"===(null===(s=i[e])||void 0===s?void 0:s.type)?1*i[e].amount:0,d[o].cc_c+="credit"===(null===(l=i[e])||void 0===l?void 0:l.type)?1*i[e].amount:0,d[o].saldo+="credit"===(null===(n=i[e])||void 0===n?void 0:n.type)?-1*i[e].amount:0,d[o].comprobanteIds[i[e].comprobanteId]={date:i[e].date,description:i[e].description}})),(0,l._2)(s).map((e=>{var i,l;let n=s[e].document.trim();n.indexOf("A-")>=0&&(n=n.split("A-")[1]),d[n]||(d[n]={document:n,amount:0,hasAnticipo:0,cc_c:0,cc_d:0,saldo:0,comprobanteIds:{}}),d[n].hasAnticipo+="credit"===(null===(i=s[e])||void 0===i?void 0:i.type)?1*s[e].amount:-1*s[e].amount,d[n].saldo+=-1*("credit"===(null===(l=s[e])||void 0===l?void 0:l.type)?1*s[e].amount:-1*s[e].amount),d[n].comprobanteIds[s[e].comprobanteId]={date:s[e].date,description:s[e].description}})),d},v=e=>{let i=[],s=(0,l._U)((0,l.bh)("invoices_list"),"document");(0,l.sO)(e)&&(e=JSON.parse(e)),console.log({docM:s}),e.map((e=>{let d={...e},n=new Date("05/14/2024").getTime();if(d.date>n&&(d.invoiceId=(0,l.M5)(),d.invoiceLinkConfirmed&&d.amount&&d.document&&!s[d.document])){var o,a;let e={...null===(o=(0,l.bh)((0,l.hQ)()))||void 0===o?void 0:o.add_invoice};e.params={businessId:null===(a=(0,l.bh)("profileUser"))||void 0===a?void 0:a.businessId},e.form=d,i.push(e)}})),(0,l.DF)(i,m)},m=async e=>{const i=(0,l.I7)(e),s=await i;if(s)return s}},3971:()=>{},261:()=>{}}]);
//# sourceMappingURL=481.9c74efb0.chunk.js.map