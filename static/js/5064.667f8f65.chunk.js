"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[5064],{5064:(e,l,d)=>{d.r(l),d.d(l,{default:()=>x});var i=d(2791),t=d(2350),a=d(2647),o=(d(4719),d(9661)),s=d(9760),n=d(24),r=(d(3728),d(7689)),c=d(184);const u=(0,a.Np)(),v=(0,a.JC)(),m=(0,o.Uk)(),p=(0,o.LZ)(),h=(0,o.FC)(),b=(0,n.f_)(),_="entry_operation_comprobante",x=e=>{var l,d,a,o,n,v,x,f,g,C,F,w,A,k,R;let{data:O,confirm:T,item:z}=e;const[M,D]=(0,i.useState)(!1),[S,E]=(0,i.useState)(0),K=(0,r.s0)();(0,i.useEffect)((()=>{if(!M){D(!0),(0,t.Rz)("accountPicker",{}),U("description",z.name),U("customerId",null),U("providerId",null);let e=z.accountsToParameterize;(0,t.Rz)("multi_params",e),E((0,t.M5)())}}));const U=(e,l,d)=>{let i=(0,t.bh)(_)||{};d?(i[d]||(i[d]={}),i[d][e]=l):i[e]=l,(0,t.Rz)(_,i),E((0,t.M5)())},q=async()=>{var e,l,d,i,a,o;let n={...(0,t.bh)(_)};n.date?n.date=new Date(n.date).getTime():n.date=(new Date).getTime()+800;let r=await(0,t.fN)(n.date);n.document=null===(e=n.document)||void 0===e?void 0:e.trim();let c=[],u={date:n.date,comprobanteId:r,description:n.description,businessId:null===(l=(0,t.bh)("profileUser"))||void 0===l?void 0:l.businessId,year:new Date(n.date).getFullYear()};if(delete n.date,(0,t.bh)("multi_params")&&(null===(d=(0,t._2)((0,t.bh)("multi_params")))||void 0===d||d.map((async(e,l)=>{let d=(0,t.bh)("multi_params")[e];if(!isNaN(1*d.amount)&&1*d.amount>0){var i;let e={};e.document=n.document,"recurrent"===(null===z||void 0===z?void 0:z.extra)&&(e.document=d.document),e.account=d.account,e.subAccount=d.subAccount,e.type=d.type,e.amount=1*d.amount,e.operationId=(0,t.M5)(),delete e.providerId;let l=null===(i=(0,t.bh)("account_ids"))||void 0===i?void 0:i[d.account];l.payOrCollect&&(e.payOrCollect=l.payOrCollect),c.push(e)}}))),"provider"===(null===z||void 0===z?void 0:z.extra)&&null!==(i=(0,t.bh)(_))&&void 0!==i&&i.providerId){var v;let e={};e.document=n.document,e.type="credit";let l=(0,t.bh)("providers_ids")[(0,t.bh)(_).providerId];e.account=l.account,e.subAccount=l.subAccount,e.amount=I((0,t.bh)("multi_params")),e.operationId=(0,t.M5)();let d=null===(v=(0,t.bh)("account_ids"))||void 0===v?void 0:v[l.account];d.payOrCollect&&(e.payOrCollect=d.payOrCollect),c.push(e)}if("customer"===(null===z||void 0===z?void 0:z.extra)&&null!==(a=(0,t.bh)(_))&&void 0!==a&&a.customerId){var m;let e={type:"debit"};e.document=n.document;let l=(0,t.bh)("providers_ids")[(0,t.bh)(_).customerId];e.account=l.account,e.subAccount=l.subAccount,e.amount=-1*I((0,t.bh)("multi_params")),e.operationId=(0,t.M5)();let d=null===(m=(0,t.bh)("account_ids"))||void 0===m?void 0:m[l.account];d.payOrCollect&&(e.payOrCollect=d.payOrCollect),c.push(e)}let p={...null===(o=(0,t.bh)((0,t.hQ)()))||void 0===o?void 0:o.add_multi_opera};p.params=u,p.form=c;const h=(0,t.I7)(p);await h&&setTimeout((()=>{(0,t.Rz)("multi_params",null),(0,t.Rz)(_,null),(null===O||void 0===O?void 0:O.modalID)&&(0,s.CloseModal)({id:null===O||void 0===O?void 0:O.modalID}),K({pathname:"/accounting-ledger",search:"?cId=".concat(r)})}),400)};let Q=("provider"===(null===z||void 0===z?void 0:z.extra)&&(null===(l=(0,t.bh)(_))||void 0===l?void 0:l.providerId)||"customer"===(null===z||void 0===z?void 0:z.extra)&&(null===(d=(0,t.bh)(_))||void 0===d?void 0:d.customerId))&&0!==I((0,t.bh)("multi_params")),P="recurrent"===(null===z||void 0===z?void 0:z.extra)||(null===(a=(0,t.bh)(_))||void 0===a?void 0:a.document);return(0,c.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"960px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("p",{className:"form_title",children:"Asiento Manual"}),(0,c.jsx)("div",{className:"flexSpace"})]}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)(b,{init:null===(o=(0,t.bh)(_))||void 0===o?void 0:o.date,updDate:e=>U("date",e)}),(0,c.jsx)("div",{className:"flexSpace"}),"recurrent"===(null===z||void 0===z?void 0:z.extra)?null:(0,c.jsx)(u,{init:null===(n=(0,t.bh)(_))||void 0===n?void 0:n.document,label:"Documento",width:120,updChanges:e=>U("document",e)})]}),(0,c.jsx)(u,{init:null===(v=(0,t.bh)(_))||void 0===v?void 0:v.description,label:"Descripcion",width:520,updChanges:e=>U("description",e)}),"employee"===(null===z||void 0===z?void 0:z.extra)?(0,c.jsx)("div",{className:"extra_container",children:null!==(x=(0,t.bh)(_))&&void 0!==x&&x.employeeId?(0,c.jsxs)("div",{className:"_dsplFlx",children:[(0,c.jsx)("div",{className:"employee_title",style:{color:"#646cff",cursor:"pointer"},onClick:()=>U("employeeId",null),children:"Empleado:"}),(0,c.jsx)("div",{className:"employee_name",children:null===(f=(0,t.bh)("employees_ids")[(0,t.bh)(_).employeeId])||void 0===f?void 0:f.name})]}):(0,c.jsx)(m,{width:420,handleClick:e=>U("employeeId",e)})}):null,"provider"===(null===z||void 0===z?void 0:z.extra)?(0,c.jsx)("div",{className:"extra_container",children:null!==(g=(0,t.bh)(_))&&void 0!==g&&g.providerId?(0,c.jsxs)("div",{className:"_dsplFlx",children:[(0,c.jsx)("div",{className:"employee_title",style:{color:"#646cff",cursor:"pointer"},onClick:()=>U("providerId",null),children:"Provedor:"}),(0,c.jsx)("div",{className:"employee_name",children:null===(C=(0,t.bh)("providers_ids")[(0,t.bh)(_).providerId])||void 0===C?void 0:C.name})]}):(0,c.jsx)(p,{width:420,handleClick:e=>U("providerId",null===e||void 0===e?void 0:e.providerId)})}):null,"customer"===(null===z||void 0===z?void 0:z.extra)?(0,c.jsx)("div",{className:"extra_container",children:null!==(F=(0,t.bh)(_))&&void 0!==F&&F.customerId?(0,c.jsxs)("div",{className:"_dsplFlx",children:[(0,c.jsx)("div",{className:"employee_title",style:{color:"#646cff",cursor:"pointer"},onClick:()=>U("customerId",null),children:"Cliente:"}),(0,c.jsx)("div",{className:"employee_name",children:null===(w=(0,t.bh)("providers_ids")[(0,t.bh)(_).customerId])||void 0===w?void 0:w.name})]}):(0,c.jsx)(h,{width:420,handleClick:e=>U("customerId",null===e||void 0===e?void 0:e.providerId)})}):null,(0,c.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,c.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,c.jsx)("div",{className:"tr_bar_25",children:"Cuenta"}),(0,c.jsx)("div",{className:"tr_bar_25",children:"Sub Cuenta"}),(0,c.jsx)("div",{className:"tr_bar_25",children:"recurrent"===(null===z||void 0===z?void 0:z.extra)?"Documento":""}),(0,c.jsx)("div",{className:"tr_bar_25",children:"Importe"})]}),null!==(A=(0,t.bh)(_))&&void 0!==A&&A.customerId?(0,c.jsx)(j,{idKey:(0,t.bh)(_).customerId,data:(0,t.bh)("providers_ids")[(0,t.bh)(_).customerId],total:I((0,t.bh)("multi_params")),type:"debit"}):null,(0,t.bh)("multi_params")&&(null===(k=(0,t._2)((0,t.bh)("multi_params")))||void 0===k?void 0:k.map(((e,l)=>(0,c.jsx)(y,{idKey:e,data:(0,t.bh)("multi_params")[e],updObs:E,isRecurrent:"recurrent"===(null===z||void 0===z?void 0:z.extra)},e)))),null!==(R=(0,t.bh)(_))&&void 0!==R&&R.providerId?(0,c.jsx)(j,{idKey:(0,t.bh)(_).providerId,data:(0,t.bh)("providers_ids")[(0,t.bh)(_).providerId],total:I((0,t.bh)("multi_params")),type:"credit"}):null]}),(0,c.jsxs)("div",{className:"_dsplFlx ",children:[(0,c.jsx)("div",{className:"flexSpace"}),P&&(Q||N((0,t.bh)("multi_params")))?(0,c.jsx)("div",{className:"card",children:(0,c.jsx)("button",{className:"group_title addBtn purple",onClick:q,children:"Guardar"})}):null]})]})},y=e=>{var l,d;let{data:a,updObs:o,idKey:s,isRecurrent:n}=e;const[r,m]=(0,i.useState)(0),p=(e,l,d)=>{let i=(0,t.bh)("multi_params")||{};d?(i[d]||(i[d]={}),i[d][e]=l):i[e]=l,(0,t.Rz)("multi_params",i)};let h=null===(l=(0,t.bh)("account_ids"))||void 0===l?void 0:l[null===a||void 0===a?void 0:a.account],b=null===(d=(0,t.bh)("sub_account_ids"))||void 0===d?void 0:d[null===a||void 0===a?void 0:a.subAccount];return(0,c.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,c.jsx)("div",{className:"tr_bar_25",style:{marginTop:10,fontWeight:600,color:"debit"===a.type?"#009688":"#c62828"},children:(0,c.jsx)(v,{data:h,color:"debit"===a.type?"#009688":"#c62828",labelField:"code",infoField:"name"})}),(0,c.jsx)("div",{className:"tr_bar_25",style:{marginTop:10},children:(0,c.jsx)(v,{data:b,color:"debit"===a.type?"#009688":"#c62828",labelField:"subAccount",infoField:"subAccountName"})}),(0,c.jsx)("div",{className:"tr_bar_25",style:{marginTop:10},children:n?(0,c.jsx)(u,{width:120,init:null===a||void 0===a?void 0:a.document,updChanges:e=>{p("document",e,s),o((0,t.M5)())}}):null}),(0,c.jsx)("div",{className:"tr_bar_25",children:(0,c.jsx)(u,{init:r,type:"number",width:80,init:null===a||void 0===a?void 0:a.amount,updChanges:e=>{p("amount",e,s),o((0,t.M5)())}})})]})},j=e=>{var l,d;let{data:a,idKey:o,total:s,type:n}=e;const[r,u]=(0,i.useState)(0);let m=null===(l=(0,t.bh)("account_ids"))||void 0===l?void 0:l[null===a||void 0===a?void 0:a.account],p=null===(d=(0,t.bh)("sub_account_ids"))||void 0===d?void 0:d[null===a||void 0===a?void 0:a.subAccount];return(0,c.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,c.jsx)("div",{className:"tr_bar_25",style:{marginTop:10,fontWeight:600,color:"debit"===n?"#009688":"#c62828"},children:(0,c.jsx)(v,{data:m,color:"debit"===n?"#009688":"#c62828",labelField:"code",infoField:"name"})}),(0,c.jsx)("div",{className:"tr_bar_25",style:{marginTop:10},children:(0,c.jsx)(v,{data:p,color:"debit"===n?"#009688":"#c62828",labelField:"subAccount",infoField:"subAccountName"})}),(0,c.jsx)("div",{className:"tr_bar_25",style:{marginTop:10}}),(0,c.jsx)("div",{className:"tr_bar_25",style:{marginTop:10},children:(0,c.jsx)("div",{className:"total_cntra",children:s*("debit"===n?-1:1).toFixed(2)})})]})},I=e=>{let l=0,d=e&&(0,t._2)(e);return d&&(null===d||void 0===d||d.map(((d,i)=>{let t=e[d],a=l.toFixed(2),o=null!==t&&void 0!==t&&t.amount?"debit"===(null===t||void 0===t?void 0:t.type)?parseFloat(t.amount):-1*parseFloat(t.amount):0;l=o+parseFloat(a)}))),l},N=e=>{let l=0,d=e&&(0,t._2)(e);return d&&(null===d||void 0===d||d.map(((d,i)=>{let t=e[d],a=l.toFixed(2),o=null!==t&&void 0!==t&&t.amount?"debit"===(null===t||void 0===t?void 0:t.type)?parseFloat(t.amount):-1*parseFloat(t.amount):0;l=o+parseFloat(a)}))),d&&(null===d||void 0===d?void 0:d.length)>0&&0===l}},3728:(e,l,d)=>{d.d(l,{NA:()=>s,g5:()=>o,ph:()=>t,yq:()=>a});var i=d(2350);const t=async e=>{var l,d;let t=null===(l=(0,i.bh)((0,i.hQ)()))||void 0===l?void 0:l.all_entries;t.params={businessId:null===(d=(0,i.bh)("profileUser"))||void 0===d?void 0:d.businessId};const a=(0,i.I7)(t),o=await a;o&&((0,i.Rz)("entries_list",o),(0,i.Rz)("entries_ids",(0,i.ME)(o,"accountingEntryId")),e&&e())},a=async e=>{var l,d;let t=null===(l=(0,i.bh)((0,i.hQ)()))||void 0===l?void 0:l.search_entries;t.params={businessId:null===(d=(0,i.bh)("profileUser"))||void 0===d?void 0:d.businessId,":search":(0,i.bh)("search_entry_qry")};const a=(0,i.I7)(t),o=await a;o&&((0,i.Rz)("entries_list",o),e&&e())},o=async(e,l)=>{var d,t;let a=null===(d=(0,i.bh)((0,i.hQ)()))||void 0===d?void 0:d.delete_entries;a.params={businessId:null===(t=(0,i.bh)("profileUser"))||void 0===t?void 0:t.businessId,accountingEntryId:e};const o=(0,i.I7)(a);await o&&l&&l()},s=async e=>{const l=(0,i.I7)({query:"getLastSequence"}),d=await l;if(d)return d}},4719:()=>{}}]);
//# sourceMappingURL=5064.667f8f65.chunk.js.map