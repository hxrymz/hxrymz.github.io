"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[5195,5194],{5195:(e,l,i)=>{i.r(l),i.d(l,{default:()=>I});var d=i(2791),s=i(2350),a=i(2647),t=(i(1839),i(9760)),c=i(9661),r=i(184);const o=(0,a.Np)(),n=(0,a.PU)(),u=e=>{var l,i,a,t;let{updParent:c}=e;const[n,u]=(0,d.useState)(0),[v,h]=(0,d.useState)(!1),p=(e,l,i)=>{let d=(0,s.bh)("extraChargesInvoice")||{};i?(d[i]||(d[i]={}),d[i][e]=l):d[e]=l,(0,s.Rz)("extraChargesInvoice",d),u((0,s.M5)())};return(0,r.jsxs)("div",{children:[v?(0,r.jsx)("div",{className:"load_animation"}):(0,r.jsx)("div",{className:"",style:{maxWidth:130,marginLeft:7},children:(0,r.jsx)(o,{init:null===(l=(0,s.bh)("extraChargesInvoice"))||void 0===l?void 0:l.description,label:(0,s.zE)(4),width:750,updChanges:e=>p("description",e)})}),v?(0,r.jsxs)("div",{className:"_dsplFlx",children:[(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)("div",{className:"form_title",children:"Saving....."})]}):(0,r.jsxs)("div",{className:"_dsplFlx",children:[(0,r.jsx)(o,{init:null===(i=(0,s.bh)("extraChargesInvoice"))||void 0===i?void 0:i.salePrice,label:(0,s.zE)(14),width:120,type:"number",updChanges:e=>p("salePrice",e)}),(0,r.jsx)("div",{className:"flexSpace"}),null!==(a=(0,s.bh)("extraChargesInvoice"))&&void 0!==a&&a.description&&null!==(t=(0,s.bh)("extraChargesInvoice"))&&void 0!==t&&t.salePrice?(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("button",{onClick:()=>{h(!0);let e={...(0,s.bh)("extraChargesInvoice")}||{},l={...(0,s.bh)("extraChargesInvoiceList")}||{},i=(0,s.M5)();e.qty=1,l[i]=e,(0,s.Rz)("extraChargesInvoiceList",l),(0,s.Rz)("extraChargesInvoice",null),c((0,s.M5)()),setTimeout((()=>{h(!1)}),350)},children:(0,s.zE)(7)})}):null]})]})},v=e=>{var l,i;let{data:d,deleteItem:a,idKey:t}=e;null===(l=(0,s.bh)("account_ids"))||void 0===l||l[null===d||void 0===d?void 0:d.account],null===(i=(0,s.bh)("sub_account_ids"))||void 0===i||i[null===d||void 0===d?void 0:d.subAccount];return(0,r.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,r.jsx)("div",{className:"tr_bar tr_bar_80",style:{textAlign:"left"},children:null===d||void 0===d?void 0:d.description}),(0,r.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,s.Zv)(null===d||void 0===d?void 0:d.salePrice,2)}),(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)("div",{className:"icon",onClick:()=>{a(t)},children:(0,r.jsx)(n,{name:"outline_delete",color:"#c62828"})})]})},h=e=>{var l;let{updMain:i}=e;const[a,t]=(0,d.useState)(0),c=e=>{let l=(0,s.bh)("extraChargesInvoiceList")||{};delete l[e],(0,s.Rz)("extraChargesInvoiceList",l),i((0,s.M5)())};return(0,r.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,r.jsx)(u,{updParent:t}),(0,r.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,r.jsx)("div",{className:"tr_bar tr_bar_80",children:(0,s.zE)(4)}),(0,r.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,s.zE)(14)})]}),(0,s.bh)("extraChargesInvoiceList")&&(null===(l=(0,s._2)((0,s.bh)("extraChargesInvoiceList")))||void 0===l?void 0:l.map(((e,l)=>(0,r.jsx)(v,{idKey:e,data:(0,s.bh)("extraChargesInvoiceList")[e],deleteItem:c},e))))]})};var p=i(24),x=i(713);const m=(0,a.PU)(),b=(0,a.Np)(),j=(0,p.f_)(),_=(0,a.YZ)(),N=(0,c.FC)(),y=(0,p.Az)(),g="new_fatura_sale_comprobante",I=e=>{var l,i,a,c,o,n,u,v,p,x,m,N,y,I,f;let{data:O,confirm:z}=e;const[A,M]=(0,d.useState)(!1),[,S]=(0,d.useState)(0);(0,d.useEffect)((()=>{A||(M(!0),(0,s.Rz)("accountPicker",{}),S((0,s.M5)()))}));const L=(e,l,i)=>{let d=(0,s.bh)(g)||{};i?(d[i]||(d[i]={}),d[i][e]=l):d[e]=l,(0,s.Rz)(g,d),S((0,s.M5)())};let F=null!==(l=(0,s.bh)(g))&&void 0!==l&&l.isAdvance?C((0,s.bh)("productListOnOut"),(0,s.bh)("extraChargesInvoiceList")):null===(i=(0,s.bh)(g))||void 0===i?void 0:i.totalAmount;return(0,r.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"58vh",width:"860px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,r.jsxs)("div",{className:"_dsplFlx ",children:[(0,r.jsx)("p",{className:"form_title",children:(0,s.zE)(1)}),(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:20},children:[(0,r.jsx)(_,{initvalue:null===(a=(0,s.bh)(g))||void 0===a?void 0:a.isAdvance,keyCode:57,updChange:e=>L("isAdvance",e)}),(0,r.jsx)("span",{className:"checklabel",children:"Avanzado"})]})]}),(0,r.jsxs)("div",{className:"_dsplFlx ",children:[(0,r.jsx)(j,{label:(0,s.zE)(3),init:null===(c=(0,s.bh)(g))||void 0===c?void 0:c.date,updDate:e=>L("date",e)}),(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)(b,{init:null===(o=(0,s.bh)(g))||void 0===o?void 0:o.document,label:(0,s.zE)(2),width:120,updChanges:e=>L("document",e)}),(0,r.jsx)("div",{className:"flexSpace"}),null!==(n=(0,s.bh)(g))&&void 0!==n&&n.isAdvance?(0,r.jsx)(b,{init:null===(u=(0,s.bh)(g))||void 0===u?void 0:u.hasTax,label:(0,s.zE)(16),width:120,updChanges:e=>L("hasTax",e)}):null,(0,r.jsx)("div",{className:"flexSpace"}),null!==(v=(0,s.bh)(g))&&void 0!==v&&v.isAdvance?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"label",children:"Total"}),(0,r.jsx)("div",{className:"date2Upd",style:{marginRight:30},children:(F||0).toFixed(2)})]}):(0,r.jsx)(b,{init:null===(p=(0,s.bh)(g))||void 0===p?void 0:p.totalAmount,label:"Monto",width:120,type:"number",updChanges:e=>L("totalAmount",e)})]}),null!==(x=(0,s.bh)(g))&&void 0!==x&&x.isAdvance?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 10px"},children:[(0,r.jsx)(k,{}),(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)(b,{init:null===(m=(0,s.bh)(g))||void 0===m?void 0:m.hasAdvancePay,label:(0,s.zE)(15),width:120,updChanges:e=>L("hasAdvancePay",e)})]}),(0,r.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:[(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)(b,{init:null===(N=(0,s.bh)(g))||void 0===N?void 0:N.description,label:(0,s.zE)(4),width:520,updChanges:e=>L("description",e)}),(0,r.jsx)("div",{className:"flexSpace"})]}),(0,r.jsx)(P,{updMain:S}),(0,r.jsx)(h,{updMain:S})]}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 10px"},children:[(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)(k,{}),(0,r.jsx)("div",{className:"flexSpace"})]}),(0,r.jsxs)("div",{className:"_dsplFlx ",style:{margin:"18px 10px"},children:[(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)(b,{init:null===(y=(0,s.bh)(g))||void 0===y?void 0:y.clientName,label:"Nombe del cliente",width:420,updChanges:e=>L("clientName",e)}),(0,r.jsx)("div",{className:"flexSpace"})]})]}),(0,r.jsxs)("div",{className:"_dsplFlx ",children:[(0,r.jsx)("div",{className:"flexSpace"}),null!==(I=(0,s.bh)(g))&&void 0!==I&&I.document&&null!==(f=(0,s.bh)("customerOutPicker"))&&void 0!==f&&f.account&&F>0?(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("button",{onClick:async()=>{var e,l,i,d,a,c;let r=(0,s.bh)(g),o=(new Date).getTime()+800;if(r.date){let e=new Date(r.date).getTime();o=e||o}r.date=o;let n=[],u=r.hasAdvancePay,v=r.hasTax,h=r.isAdvance;delete r.hasTax,delete r.hasAdvancePay;let p=0,x=0,m=[],b={...r},j=r.clientName?" "+r.clientName:"",_=(0,s.bh)("global_account_params");if(h){var N;let e=(0,s.bh)("productListOnOut")&&(0,s._2)((0,s.bh)("productListOnOut"));if(e&&(null===e||void 0===e||e.map((async(e,l)=>{let i={...(0,s.bh)("productListOnOut")[e]},d=1*i.qty*(1*i.price);p+=d,x+=d,m.push({inventoryId:(0,s.M5)(),product:i.productId,qty:1*i.qty,salePrice:1*i.salePrice,price:1*i.price,amount:d})}))),x>0){var y,I;let e={...r};e.type="credit",e.account=null===_||void 0===_||null===(y=_.inventory)||void 0===y?void 0:y.account,e.amount=x,e.operationId=(0,s.M5)(),n.push(e);let l={...r};l.type="debit",l.account=null===_||void 0===_||null===(I=_.inventory_expensess)||void 0===I?void 0:I.account,l.amount=x,l.operationId=(0,s.M5)(),n.push(l)}if(p>0&&(0,s.bh)("customerOutPicker").account){var k,P,f,C,A;let e={...r};e.type="debit",e.account=null===(k=(0,s.bh)("customerOutPicker"))||void 0===k?void 0:k.account,e.subAccount=null===(P=(0,s.bh)("customerOutPicker"))||void 0===P?void 0:P.subAccount,e.providerId=null===(f=(0,s.bh)("customerOutPicker"))||void 0===f?void 0:f.providerId,e.operationId=(0,s.M5)();let l=null===(C=(0,s.bh)("account_ids"))||void 0===C?void 0:C[null===(A=(0,s.bh)("customerOutPicker"))||void 0===A?void 0:A.account];l&&l.payOrCollect&&(e.payOrCollect=l.payOrCollect),e.amount=v?v/100*F+1*F:1*F,n.push(e)}if(v){var M;let e={...r};e.type="credit",e.account=null===_||void 0===_||null===(M=_.sale_tax)||void 0===M?void 0:M.account,e.operationId=(0,s.M5)(),e.amount=F*v/100,n.push(e)}if(null!==_&&void 0!==_&&null!==(N=_.sales_income)&&void 0!==N&&N.account){var L;let e={...r};e.type="credit",e.account=null===_||void 0===_||null===(L=_.sales_income)||void 0===L?void 0:L.account,e.operationId=(0,s.M5)(),e.amount=F,n.push(e)}u&&(b.hasAdvancePay=1*u),v&&(b.hasTax=v/100*F),b.extras=(0,s.bh)("extraChargesInvoiceList")}else{var R,w;F=r.totalAmount;let e=null===(R=(0,s.bh)("providers_ids")[null===(w=(0,s.bh)("customerOutPicker"))||void 0===w?void 0:w.providerId])||void 0===R?void 0:R.name;e&&(b.description="".concat(e," - ").concat(j))}b.invoiceId=(0,s.M5)(),b.products=m,b.amount=1*F,b.createdBy=null===(e=(0,s.bh)("profileUser"))||void 0===e?void 0:e.userId,b.customer={account:null===(l=(0,s.bh)("customerOutPicker"))||void 0===l?void 0:l.account,subAccount:null===(i=(0,s.bh)("customerOutPicker"))||void 0===i?void 0:i.subAccount,providerId:null===(d=(0,s.bh)("customerOutPicker"))||void 0===d?void 0:d.providerId},b.comprobantes=n;let E={...null===(a=(0,s.bh)((0,s.hQ)()))||void 0===a?void 0:a.add_invoice};E.params={businessId:null===(c=(0,s.bh)("profileUser"))||void 0===c?void 0:c.businessId,year:(0,s.bh)("date_current_year")},E.form=b;{const e=(0,s.I7)(E);await e;(null===O||void 0===O?void 0:O.modalID)&&(0,t.CloseModal)({id:null===O||void 0===O?void 0:O.modalID}),setTimeout((()=>{(0,s.Rz)("extraChargesInvoiceList",null),(0,s.Rz)("productListOnOut",null),(0,s.Rz)("customerOutPicker",null),(0,s.Rz)(g,null),S((0,s.M5)()),z&&z()}),400)}},children:(0,s.zE)(5)})}):null]})]})},k=e=>{var l,i;let{}=e;const[a,t]=(0,d.useState)(0);let c=null===(l=(0,s.bh)("providers_ids"))||void 0===l?void 0:l[null===(i=(0,s.bh)("customerOutPicker"))||void 0===i?void 0:i.providerId];return(0,r.jsx)("div",{children:null!==c&&void 0!==c&&c.name?(0,r.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,r.jsxs)("div",{className:" acc_dtls",children:[(0,r.jsx)("div",{className:"_dsplFlx",children:(0,r.jsx)("div",{className:"code",style:{color:"#646cff"},onClick:()=>{(0,s.Rz)("customerOutPicker",null),t((0,s.M5)())},children:null===c||void 0===c?void 0:c.name})}),(0,r.jsx)("div",{className:"flexSpace"})]})}):(0,r.jsx)(N,{placeholder:"buscar una provedor",width:320,handleClick:e=>{let l={providerId:e.providerId,account:e.account,subAccount:e.subAccount};(0,s.Rz)("customerOutPicker",l),t((0,s.M5)())}})})},P=e=>{var l,i,a,t,c,o,n,u,v,h,p,m,j,_;let{updMain:N}=e;const[g,I]=(0,d.useState)(0),k=()=>{I((0,s.M5)())};let P=null===(l=(0,s.bh)("products_ids"))||void 0===l?void 0:l[null===(i=(0,s.bh)("productPicker"))||void 0===i?void 0:i.productId];const C=(e,l,i)=>{let d=(0,s.bh)("productPicker")||{};i?(d[i]||(d[i]={}),d[i][e]=l):d[e]=l,(0,s.Rz)("productPicker",d),I((0,s.M5)())},O=e=>{let l=(0,s.bh)("productListOnOut")||{};delete l[e],(0,s.Rz)("productListOnOut",l),N((0,s.M5)())};return(0,r.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[null!==(a=(0,s.bh)("productPicker"))&&void 0!==a&&a.productId?(0,r.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,r.jsxs)("div",{className:" acc_dtls",children:[(0,r.jsxs)("div",{className:"_dsplFlx",onClick:e=>{(0,s.Rz)("productPicker",null),I((0,s.M5)())},children:[(0,r.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===P||void 0===P?void 0:P.upc_barcode}),(0,r.jsx)("div",{className:"name",children:null===P||void 0===P?void 0:P.name})]}),(0,r.jsx)("div",{className:"flexSpace"})]})}):(0,r.jsx)(y,{width:420,handleClick:e=>{let l={productId:e.productId,product:e.product,subAccount:e.subAccount};(0,s.Rz)("productPicker",l),(0,x.Rd)(e.productId,k)}}),null!==(t=(0,s.bh)("products_stock"))&&void 0!==t&&null!==(c=t[null===(o=(0,s.bh)("productPicker"))||void 0===o?void 0:o.productId])&&void 0!==c&&c.qty?(0,r.jsxs)("div",{className:"_dsplFlx ",children:[(0,r.jsx)(b,{init:null===(n=(0,s.bh)("productPicker"))||void 0===n?void 0:n.qty,label:(0,s.zE)(10),width:120,type:"number",updChanges:e=>C("qty",e)}),(0,r.jsx)("div",{style:{margin:"0 5px"}}),(0,r.jsx)(b,{init:null===(u=(0,s.bh)("productPicker"))||void 0===u?void 0:u.salePrice,label:(0,s.zE)(11),width:120,type:"number",updChanges:e=>C("salePrice",e)}),(0,r.jsx)("div",{className:"flexSpace"}),null!==(v=(0,s.bh)("productPicker"))&&void 0!==v&&v.qty&&(null===(h=(0,s.bh)("productPicker"))||void 0===h?void 0:h.qty)<=(null===(p=(0,s.bh)("products_stock"))||void 0===p||null===(m=p[null===(j=(0,s.bh)("productPicker"))||void 0===j?void 0:j.productId])||void 0===m?void 0:m.qty)?(0,r.jsx)("div",{style:{marginTop:38},children:(0,r.jsx)("button",{onClick:()=>{var e,l,i,d,a,t;let c={...(0,s.bh)("productPicker")}||{},r={...(0,s.bh)("productPicker")}||{},o={...(0,s.bh)("productListOnOut")}||{},n=c.productId,u=(null===(e=(0,s.bh)("products_stock"))||void 0===e||null===(l=e[null===(i=(0,s.bh)("productPicker"))||void 0===i?void 0:i.productId])||void 0===l?void 0:l.amount)/(null===(d=(0,s.bh)("products_stock"))||void 0===d||null===(a=d[null===(t=(0,s.bh)("productPicker"))||void 0===t?void 0:t.productId])||void 0===a?void 0:a.qty);c.price=u,o[n]=c,(0,s.Rz)("productListOnOut",o),r.productId=null,r.qty="",r.price="",(0,s.Rz)("productPicker",r),N((0,s.M5)())},children:(0,s.zE)(7)})}):null]}):null,(0,r.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,r.jsx)("div",{className:"tr_bar tr_bar_50 ",children:(0,s.zE)(8)}),(0,r.jsx)("div",{className:"tr_bar tr_bar_20",children:"Qty"}),(0,r.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,s.zE)(11)}),(0,r.jsx)("div",{className:"tr_bar tr_bar_5"})]}),(0,s.bh)("productListOnOut")&&(null===(_=(0,s._2)((0,s.bh)("productListOnOut")))||void 0===_?void 0:_.map(((e,l)=>(0,r.jsx)(f,{idKey:e,data:(0,s.bh)("productListOnOut")[e],deleteItem:O},e))))]})},f=e=>{var l;let{data:i,deleteItem:d,idKey:a}=e,t=null===(l=(0,s.bh)("products_ids"))||void 0===l?void 0:l[null===i||void 0===i?void 0:i.productId];return(0,r.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,r.jsx)("div",{className:"tr_bar tr_bar_50",children:null===t||void 0===t?void 0:t.name}),(0,r.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,s.Zv)(null===i||void 0===i?void 0:i.qty,2)}),(0,r.jsx)("div",{className:"tr_bar tr_bar_20",children:(0,s.Zv)(null===i||void 0===i?void 0:i.salePrice,2)}),(0,r.jsx)("div",{className:"flexSpace"}),(0,r.jsx)("div",{className:"icon",onClick:()=>{d(a)},children:(0,r.jsx)(m,{name:"outline_delete",color:"#c62828"})})]})},C=(e,l)=>{var i,d;let a=0;return e&&(null===(i=(0,s._2)(e))||void 0===i||i.map(((l,i)=>{let d=1*e[l].salePrice*(1*e[l].qty);a=1*(0,s.Zv)(a,2)+1*(0,s.Zv)(d,2)}))),l&&(null===(d=(0,s._2)(l))||void 0===d||d.map(((e,i)=>{let d=1*l[e].salePrice*(1*l[e].qty);a=1*(0,s.Zv)(a,2)+1*(0,s.Zv)(d,2)}))),a}},1839:()=>{}}]);
//# sourceMappingURL=5195.334b76fd.chunk.js.map