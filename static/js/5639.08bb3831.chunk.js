"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[5639,9760],{9760:(l,e,o)=>{o.r(e),o.d(e,{CloseModal:()=>u,OpenModal:()=>s,default:()=>n});var d=o(2791),i=o(5408),a=o(2350),t=o(184);const c="listDialog_mdh392",n=()=>{const l=(0,a.bh)("listDialog")||{};(0,i.Z)(c);let e=Object.keys(l);return(0,t.jsx)(t.Fragment,{children:e.map(((e,o)=>{let i=l[e];if(i&&i.visible){let l={};i.height&&(l.heigth=i.height),i.width,i.zIndex&&(l.zIndex=i.zIndex-1);let o={zIndex:i.zIndex},a=null,c=i.data;return i.content&&(a=d.cloneElement(i.content,{data:c})),(0,t.jsxs)("div",{className:"ltr-1kbnjow",style:l,children:[(0,t.jsx)("div",{className:"ltr-hoe9xz",children:(0,t.jsx)("div",{className:"ltr-1wao6ny",style:o,id:e,children:a})}),i.data.overlay?(0,t.jsx)("div",{className:"DialogHRMOverlay ".concat(i.visible?"active":""),onClick:()=>{var l;l=e,document.getElementsByTagName("html")[0].classList.remove("has-level-two"),u({id:l})}}):null]},e)}}))})},s=l=>{let e=(0,a.bh)("listDialog")||{},o=(0,a.M5)();e[o]||(e[o]={}),e[o].visible=!0;let d={};l.props?(d=l.props,d.modalID=o):d.modalID=o;let i=document.getElementsByTagName("body")[0];null!==i&&void 0!==i&&i.style&&(i.style.overflowY="hidden"),e[o].isView=l.isView,e[o].observeResize=l.observeResize,e[o].observeResize&&(e[o].observeInterval=setInterval((()=>{let l=document.querySelector("[dialog-key-id='".concat(o,"']")),d=l&&l.getBoundingClientRect();d&&(d.width===e[o].width&&d.height===e[o].height||(e[o].height=d.height+10,e[o].width=d.width,(0,a.Rz)("listDialog",e),(0,a.wt)(c)))}),200)),e[o].display=!0,l.zIndex&&(e[o].zIndex=l.zIndex),l.height&&(e[o].height=l.height),l.width&&(e[o].width=l.width),l.content&&(e[o].content=l.content),e[o].data=d,(0,a.Rz)("listDialog",e),(0,a.wt)(c),setTimeout((()=>{document.getElementsByTagName("html")[0].classList.add("has-level-two"),(0,a.Rz)("modalOpen",o),(0,a.wt)(c)}),125)},u=l=>{let e=(0,a.bh)("listDialog")||{},o=l.id;if(e[o]){var d,i,t;e[o].observeResize&&e[o].observeInterval&&clearInterval(e[o].observeInterval),e[o].display=!1,null===(d=e[o])||void 0===d||null===(i=d.data)||void 0===i||null===(t=i.closeEvent)||void 0===t||t.call(i),(0,a.Rz)("listDialog",e),delete e[o],document.getElementsByTagName("body")[0].style.overflowY=null,(0,a.wt)(c),setTimeout((()=>{delete e[o],document.getElementsByTagName("html")[0].classList.remove("has-level-two"),(0,a.Rz)("modalOpen",null)}),750)}}},5639:(l,e,o)=>{o.r(e),o.d(e,{default:()=>I});var d=o(2791),i=o(2350),a=o(2647),t=(o(6021),o(9760)),c=o(1232),n=o(9661),s=o(7689),u=o(24),r=o(3990),v=o(4050),m=o(184);const b=(0,a.PU)(),h=(0,a.Np)(),_=(0,n.FC)(),p=(0,u.f_)(),x=(0,a.JC)(),j="new_multi_collect_prov",y="Acc2MPay",N="multi_collect_by_prov_Doc",g="collect_by_docM",f="multi_collect_2S",A="extraAccountListOnCollect",I=l=>{var e,o,a,c,n,u,b,_,x,I,w;let{data:k,confirm:D}=l;const F=(0,d.useRef)(!1),[,M]=(0,d.useState)(0),S=(0,s.s0)();(0,d.useEffect)((()=>{F.current||(F.current=!0,(0,v.Ht)("global_accounts","global_account_params",P),(0,i.Rz)("PamentMethodAccount",null),(0,i.Rz)(f,null),(0,i.Rz)(g,null),(0,i.Rz)(N,null),(0,i.Rz)("accountPicker",{}),M((0,i.M5)()))}));const P=()=>{M((0,i.M5)())},T=(l,e,o)=>{let d=(0,i.bh)(j)||{};o?(d[o]||(d[o]={}),d[o][l]=e):d[l]=e,(0,i.Rz)(j,d),M((0,i.M5)())},B=()=>{let l={...(0,i.bh)(N)}||{},e={...(0,i.bh)(f)}||{};(0,i._2)(l).map((o=>{var d,a;let t=(null===(d=(0,i.bh)(y))||void 0===d?void 0:d.account)+"_"+(null===(a=(0,i.bh)(y))||void 0===a?void 0:a.subAccount)+"_"+o,c={...(0,i.bh)(y)};e[t]={},e[t].amount=1*l[o],e[t].document=o,e[t].type="credit",e[t].account=null===c||void 0===c?void 0:c.account,e[t].subAccount=null===c||void 0===c?void 0:c.subAccount,e[t].customerId=null===c||void 0===c?void 0:c.customerId})),(0,i.Rz)(f,e),(0,i.Rz)(N,null),(0,i.Rz)(y,null),M((0,i.M5)())};let O=null===(e=(0,i.bh)("global_account_params"))||void 0===e?void 0:e.cash_bank;return(0,m.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"720px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("p",{className:"form_title",children:"Registrando Cobro"}),(0,m.jsx)("div",{className:"flexSpace"})]}),(0,m.jsxs)("div",{className:"_dsplFlx",children:[(0,m.jsx)("div",{className:"flexSpace"}),null!==O&&void 0!==O&&O.account?(0,m.jsxs)("div",{className:" acc_dtls",children:[(0,m.jsxs)("div",{className:"_dsplFlx",children:[(0,m.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===(o=(0,i.bh)("account_ids"))||void 0===o||null===(a=o[null===O||void 0===O?void 0:O.account])||void 0===a?void 0:a.code}),(0,m.jsx)("div",{className:"name",children:null===(c=(0,i.bh)("account_ids"))||void 0===c||null===(n=c[null===O||void 0===O?void 0:O.account])||void 0===n?void 0:n.name})]}),(0,m.jsx)("div",{className:"flexSpace"})]}):null]}),(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)(p,{init:null===(u=(0,i.bh)(j))||void 0===u?void 0:u.date,updDate:l=>T("date",l)}),(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)(h,{init:null===(b=(0,i.bh)(j))||void 0===b?void 0:b.paymentDocument,label:"Documento de Cobro",width:200,updChanges:l=>T("paymentDocument",l)})]}),(0,m.jsx)(h,{init:null===(_=(0,i.bh)(j))||void 0===_?void 0:_.description,label:"Descripcion",width:520,updChanges:l=>T("description",l)}),(0,m.jsxs)("div",{className:" _dsplFlx",children:[(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{let l={zIndex:450,height:"93vh",props:{minHeight:"1vh",overlay:!0}};l.content=(0,m.jsx)(z,{updObs:M,confirm:B}),(0,t.OpenModal)(l)},children:"Clientes"})]}),(0,i.bh)(f)&&(0,i._2)((0,i.bh)(f)).length>0?(0,m.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Cuenta"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Sub Cuenta"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Documento"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Balance"})]}),(0,m.jsx)(R,{data:{account:null===O||void 0===O?void 0:O.account,amount:C((0,i.bh)(f)),type:"debit",document:null===(x=(0,i.bh)(j))||void 0===x?void 0:x.paymentDocument},updObs:M}),(0,i.bh)(f)&&(null===(I=(0,i._2)((0,i.bh)(f)))||void 0===I?void 0:I.map(((l,e)=>(0,m.jsx)(R,{idKey:l,data:(0,i.bh)(f)[l],updObs:M},l))))]}):null,(0,m.jsx)(r.Z,{collectionName:A}),null!==(w=(0,i.bh)(j))&&void 0!==w&&w.paymentDocument&&(C((0,i.bh)(f))>0||C((0,i.bh)("multi_collect_anticipo_by_doc"))>0||C((0,i.bh)(A))>0)?(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("div",{className:"card",children:(0,m.jsx)("button",{onClick:async()=>{var l,e,o;let d=(0,i.bh)(j)||{},a=[];d.date?d.date=new Date(d.date).getTime():d.date=(new Date).getTime()+800;let c=await(0,i.fN)(d.date),n="",s=0,u={date:d.date,comprobanteId:c,description:d.description,businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,year:new Date(d.date).getFullYear()};delete d.date;let r=(0,i.bh)("multi_collect_anticipo_by_doc")&&(0,i._2)((0,i.bh)("multi_collect_anticipo_by_doc"));r&&(null===r||void 0===r||r.map(((l,e)=>{let o=(0,i.bh)("multi_collect_anticipo_by_doc")[l];if(o){let l={};l.document=null===o||void 0===o?void 0:o.document,l.account=null===o||void 0===o?void 0:o.account,l.subAccount=null===o||void 0===o?void 0:o.subAccount,l.type=null===o||void 0===o?void 0:o.type,l.amount=null===o||void 0===o?void 0:o.amount,l.operationId=(0,i.M5)(),a.push(l)}let t={...d};t.document=null===o||void 0===o?void 0:o.documentRefer,t.account=null===o||void 0===o?void 0:o.accountRef,t.subAccount=null===o||void 0===o?void 0:o.sub_accountRef,t.type="credit",t.amount=null===o||void 0===o?void 0:o.amount,t.operationId=(0,i.M5)(),a.push(t)})));let v=(0,i.bh)(f)&&(0,i._2)((0,i.bh)(f));v&&(null===v||void 0===v||v.map(((l,e)=>{let o={...d},t=(0,i.bh)(f)[l];o.document=null===t||void 0===t?void 0:t.document,n+=(null===t||void 0===t?void 0:t.document)+" ; ",o.account=null===t||void 0===t?void 0:t.account,o.subAccount=null===t||void 0===t?void 0:t.subAccount,o.providerId=null===t||void 0===t?void 0:t.providerId,o.customerId=null===t||void 0===t?void 0:t.customerId,o.type=null===t||void 0===t?void 0:t.type,o.amount=null===t||void 0===t?void 0:t.amount,o.collectOrCollect="collect",o.operationId=(0,i.M5)(),a.push(o)})));let m=(0,i.bh)(A)&&(0,i._2)((0,i.bh)(A)),b=null===(e=(0,i.bh)("global_account_params"))||void 0===e?void 0:e.cash_bank;if(m&&(null===m||void 0===m||m.map(((l,e)=>{let o={...d},t=(0,i.bh)(A)[l];t.document?o.document=t.document:o.document=o.paymentDocument,o.account=null===t||void 0===t?void 0:t.account,o.subAccount=null===t||void 0===t?void 0:t.subAccount,o.type=null===t||void 0===t?void 0:t.type,o.amount=null===t||void 0===t?void 0:t.amount,o.operationId=(0,i.M5)(),a.push(o);let c={...d};null!==t&&void 0!==t&&t.deducefromBank?"debit"===(null===t||void 0===t?void 0:t.type)&&(s-=1*(null===t||void 0===t?void 0:t.amount)):"debit"===(null===t||void 0===t?void 0:t.type)?(c.document=c.paymentDocument,c.paymentDocument=n,c.account=null===b||void 0===b?void 0:b.account,c.type="credit"===(null===t||void 0===t?void 0:t.type)?"debit":"credit",c.amount=1*(null===t||void 0===t?void 0:t.amount),c.operationId=(0,i.M5)(),a.push(c)):"credit"===(null===t||void 0===t?void 0:t.type)&&(s+=1*(null===t||void 0===t?void 0:t.amount))}))),1*C((0,i.bh)(f))+s>0){var h;let l=C((0,i.bh)(f)),e={...d};e.document=e.paymentDocument,e.paymentDocument=n,e.account=null===b||void 0===b?void 0:b.account;let o=null===(h=(0,i.bh)("account_ids"))||void 0===h?void 0:h[e.account];o.collectOrCollect&&(e.collectOrCollect=o.collectOrCollect),e.type="debit",e.amount=1*l+s,e.operationId=(0,i.M5)(),a.push(e)}let _={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.add_multi_opera};_.params=u,_.form=a;const p=(0,i.I7)(_);await p&&setTimeout((()=>{(0,i.Rz)(N,null),(0,i.Rz)(j,null),(0,i.Rz)(m,null),(0,i.Rz)("multi_collect_anticipo_by_doc",null),(null===k||void 0===k?void 0:k.modalID)&&(0,t.CloseModal)({id:null===k||void 0===k?void 0:k.modalID}),S({pathname:"/accounting-ledger",search:"?cId=".concat(c)})}),400)},children:"Guardar"})})]}):null]})},R=l=>{var e,o;let{data:d}=l;return 1*(null===d||void 0===d?void 0:d.amount)===0?null:(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_25",style:{marginTop:10},children:(0,m.jsx)(x,{data:null===(e=(0,i.bh)("account_ids"))||void 0===e?void 0:e[null===d||void 0===d?void 0:d.account],color:"debit"===d.type?"#009688":"#c62828",labelField:"code",infoField:"name"})}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",style:{marginTop:10},children:null!==d&&void 0!==d&&d.subAccount?(0,m.jsx)(x,{data:null===(o=(0,i.bh)("sub_account_ids"))||void 0===o?void 0:o[null===d||void 0===d?void 0:d.subAccount],color:"debit"===d.type?"#009688":"#c62828",labelField:"subAccount",infoField:"subAccountName"}):null}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",style:{marginTop:10},children:null===d||void 0===d?void 0:d.document}),(0,m.jsxs)("div",{className:"tr_bar  tr_bar_25",style:{marginTop:10},children:["$",(1*(null===d||void 0===d?void 0:d.amount)).toFixed(2)]})]})},z=l=>{var e,o,a,n,s,u,r,v,b,h,p,x,j,N,f;let{data:A,confirm:I}=l;const[R,z]=(0,d.useState)(0),C=()=>{var l,e,o,d;let a=null===(l=(0,i.bh)("sub_account_ids"))||void 0===l?void 0:l[null===(e=(0,i.bh)(y))||void 0===e?void 0:e.subAccount];(0,c.pj)(null===(o=(0,i.bh)("global_account_params"))||void 0===o||null===(d=o.advance_collections)||void 0===d?void 0:d.account,a.subAccount,D)},D=l=>{var e,o;let d={account:null===(e=(0,i.bh)("global_account_params"))||void 0===e||null===(o=e.advance_collections)||void 0===o?void 0:o.account,subAccount:null===l||void 0===l?void 0:l.sub_accountId};(0,i.Rz)("advance_collections",d),(0,c.nr)(d,F)},F=()=>{z((0,i.M5)())};return(0,m.jsxs)("div",{style:{maxHeight:"92vh",minHeight:"90vh",width:"720px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("p",{className:"form_title",children:"Cobros por Clientes"}),(0,m.jsx)("div",{className:"flexSpace"})]}),(0,m.jsx)("div",{style:{margin:"18px 0"},children:null!==(e=(0,i.bh)(y))&&void 0!==e&&e.account?(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:" acc_dtls",children:[(0,m.jsxs)("div",{className:"_dsplFlx",children:[(0,m.jsx)("div",{className:"code",style:{color:"#646cff"},onClick:()=>{(0,i.Rz)(y,null),z((0,i.M5)())},children:null===(o=(0,i.bh)("account_ids"))||void 0===o||null===(a=o[null===(n=(0,i.bh)(y))||void 0===n?void 0:n.account])||void 0===a?void 0:a.code}),(0,m.jsx)("div",{className:"name",children:null===(s=(0,i.bh)("account_ids"))||void 0===s||null===(u=s[null===(r=(0,i.bh)(y))||void 0===r?void 0:r.account])||void 0===u?void 0:u.name})]}),(0,m.jsx)("div",{className:"flexSpace"}),null!==(v=(0,i.bh)(y))&&void 0!==v&&v.subAccount?(0,m.jsxs)("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[(0,m.jsx)("div",{className:"code",children:null===(b=(0,i.bh)("sub_account_ids"))||void 0===b||null===(h=b[null===(p=(0,i.bh)(y))||void 0===p?void 0:p.subAccount])||void 0===h?void 0:h.subAccount}),(0,m.jsx)("div",{className:"name",children:null===(x=(0,i.bh)("sub_account_ids"))||void 0===x||null===(j=x[null===(N=(0,i.bh)(y))||void 0===N?void 0:N.subAccount])||void 0===j?void 0:j.subAccountName})]}):null]}),(0,m.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Documento"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_20",children:"Balance"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_5"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Por Pagar"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_20",children:"Anticipo"})]}),(0,i.bh)(g)&&(null===(f=(0,i._2)((0,i.bh)(g)))||void 0===f?void 0:f.map(((l,e)=>(0,m.jsx)(k,{idKey:l,data:(0,i.bh)(g)[l],updObs:z},l))))]})]}):(0,m.jsx)(_,{placeholder:"buscar un provedor",width:420,handleClick:l=>{let e={account:null===l||void 0===l?void 0:l.account,subAccount:null===l||void 0===l?void 0:l.subAccount,customerId:null===l||void 0===l?void 0:l.customerId};(0,i.Rz)(y,e),(0,c.i7)(e,C)}})}),w((0,i.bh)(g))?(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{I&&I(),(null===A||void 0===A?void 0:A.modalID)&&(0,t.CloseModal)({id:null===A||void 0===A?void 0:A.modalID})},children:"Guardar"})]}):null]})},C=l=>{var e;let o=0;return l&&(null===(e=(0,i._2)(l))||void 0===e||e.map(((e,d)=>{var a;o+=1*(0,i.Zv)(null===(a=l[e])||void 0===a?void 0:a.amount,2)}))),o},w=l=>{let e=l&&(0,i._2)(l),o=(0,i.bh)(N),d=!0;return e&&(null===e||void 0===e||e.map(((e,a)=>{var t,c,n;let s=l[e],u=(null===(t=(0,i.bh)(y))||void 0===t?void 0:t.account)+"_"+(null===(c=(0,i.bh)(y))||void 0===c?void 0:c.subAccount)+"_"+s.document,r={...(0,i.bh)("multi_collect_anticipo_by_doc")},v=null===r||void 0===r||null===(n=r[u])||void 0===n?void 0:n.amount,m=v||0,b=(0,i.Zv)(1*(null===s||void 0===s?void 0:s.amount)-1*m,2),h=(0,i.Zv)(1*(null===o||void 0===o?void 0:o[s.document]),2);h&&h-b>0&&(d=!1)}))),d},k=l=>{var e,o,a;let{data:c,updObs:n,idKey:s}=l;const[u,r]=(0,d.useState)(0),[v,_]=(0,d.useState)(0);let p=(null===(e=(0,i.bh)(y))||void 0===e?void 0:e.account)+"_"+(null===(o=(0,i.bh)(y))||void 0===o?void 0:o.subAccount)+"_"+c.document,x={...(0,i.bh)("multi_collect_anticipo_by_doc")},j=null===x||void 0===x||null===(a=x[p])||void 0===a?void 0:a.amount,g=j?1*j:0;const f=l=>{_((0,i.M5)())},A=(l,e,o)=>{let d=(0,i.bh)(N)||{};o?(d[o]||(d[o]={}),d[o][l]=e):d[l]=e,(0,i.Rz)(N,d)};return 1*(null===c||void 0===c?void 0:c.amount)===0?null:(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,m.jsx)("div",{className:" tr_bar_25",style:{marginTop:10},children:null===c||void 0===c?void 0:c.document}),(0,m.jsxs)("div",{className:" tr_bar_20",style:{marginTop:10},children:["$",(1*(null===c||void 0===c?void 0:c.amount)-g).toFixed(2)]}),(0,m.jsx)("div",{className:"tr_bar_5",style:{marginTop:10},children:u>(null===c||void 0===c?void 0:c.amount)-g?(0,m.jsx)("div",{className:"icon",children:(0,m.jsx)(b,{name:"alert",color:"#c62828"})}):null}),(0,m.jsx)("div",{className:" tr_bar_25",children:(0,m.jsx)(h,{init:u,type:"number",width:120,updChanges:l=>{return r(e=l),A(null===c||void 0===c?void 0:c.document,e),void n((0,i.M5)());var e}})}),(0,m.jsx)("div",{className:" tr_bar_20",style:{marginTop:10},onClick:()=>{let l={zIndex:450,height:"93vh",props:{minHeight:"1vh",overlay:!0}};l.content=(0,m.jsx)(D,{confirm:f,item:c}),(0,t.OpenModal)(l)},children:null===g||void 0===g?void 0:g.toFixed(2)})]})},D=l=>{var e;let{data:o,confirm:a,item:c}=l;const[n,s]=(0,d.useState)(""),u=l=>{a&&a(l),(null===o||void 0===o?void 0:o.modalID)&&(0,t.CloseModal)({id:null===o||void 0===o?void 0:o.modalID})};return(0,m.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"660px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("p",{className:"form_title",children:"Anticipos por Clientes"}),(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("p",{className:"group_title addBtn",onClick:()=>(()=>{var l,e;let d={...(0,i.bh)("multi_collect_anticipo_by_doc")}||{};delete d[(null===(l=(0,i.bh)(y))||void 0===l?void 0:l.account)+"_"+(null===(e=(0,i.bh)(y))||void 0===e?void 0:e.subAccount)+"_"+c.document],(0,i.Rz)("multi_collect_anticipo_by_doc",d),a&&a(0),(null===o||void 0===o?void 0:o.modalID)&&(0,t.CloseModal)({id:null===o||void 0===o?void 0:o.modalID})})(),children:"Borrar"})]}),(0,m.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,m.jsx)("div",{className:"tr_bar_40 tex_left",children:"Cliente"}),(0,m.jsx)("div",{className:"tr_bar_20",children:"Balance"}),(0,m.jsx)("div",{className:"tr_bar_5"}),(0,m.jsx)("div",{className:"tr_bar_25",children:"Amount"}),(0,m.jsx)("div",{className:"tr_bar_10"})]}),(0,m.jsx)("div",{className:"accounts_container ",children:(0,i.bh)("toPay_by_doc")&&(null===(e=(0,i._2)((0,i.bh)("toPay_by_doc")))||void 0===e?void 0:e.map(((l,e)=>{let o=(0,i.bh)("toPay_by_doc")[l];return 0===1*(null===o||void 0===o?void 0:o.amount)?null:(0,m.jsx)(F,{document:c.document,itm:o,activeDoc:n,updDoc:s,closeModal:u},o.document+"_"+e)})))})]})]})},F=l=>{let{itm:e,closeModal:o,activeDoc:a,updDoc:t,document:c}=l;const[n,s]=(0,d.useState)(0);let u=M(e.document,{...(0,i.bh)("multi_collect_anticipo_by_doc")});return(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar",style:{margin:"2px 0"},children:[(0,m.jsx)("div",{className:"tr_bar_40 tex_left",style:{marginTop:10,color:a===e.document?"var(--hrm_palette-blue-purple)":""},onClick:()=>{t(e.document),s(0)},children:e.document}),(0,m.jsxs)("div",{className:"tr_bar_20",style:{marginTop:10},children:["$",(1*(null===e||void 0===e?void 0:e.amount)-1*u).toFixed(2)]}),(0,m.jsx)("div",{className:"tr_bar_5",style:{marginTop:10},children:n>(null===e||void 0===e?void 0:e.amount)?(0,m.jsx)("div",{className:"icon",children:(0,m.jsx)(b,{name:"alert",color:"#c62828"})}):null}),(0,m.jsx)("div",{className:"tr_bar_25",children:a===e.document?(0,m.jsx)(h,{init:n,type:"number",width:80,updChanges:l=>s(1*l)}):null}),(0,m.jsx)("div",{className:"tr_bar_10",style:{marginTop:10,marginLeft:9},children:a===e.document&&n<=1*(null===e||void 0===e?void 0:e.amount)?(0,m.jsx)("div",{className:"icon",onClick:()=>(l=>{var d,a,t,s;let u={...(0,i.bh)("multi_collect_anticipo_by_doc")}||{},r=(null===(d=(0,i.bh)(y))||void 0===d?void 0:d.account)+"_"+(null===(a=(0,i.bh)(y))||void 0===a?void 0:a.subAccount)+"_"+c,v={...(0,i.bh)("advance_collections")};v.document=e.document,v.documentRefer=c,v.amount=1*n,v.type="debit",v.description=l.description,v.accountRef=null===(t=(0,i.bh)(y))||void 0===t?void 0:t.account,v.sub_accountRef=null===(s=(0,i.bh)(y))||void 0===s?void 0:s.subAccount,u[r]=v,(0,i.Rz)("multi_collect_anticipo_by_doc",u),o(1*n)})(e),children:(0,m.jsx)(b,{name:"add",color:"var(--hrm_palette-blue-purple)"})}):null})]})},M=(l,e)=>{var o;let d=0;return e&&(null===(o=(0,i._2)(e))||void 0===o||o.map(((o,a)=>{var t,c;l===(null===(t=e[o])||void 0===t?void 0:t.document)&&(d+=1*(0,i.Zv)(null===(c=e[o])||void 0===c?void 0:c.amount,2))}))),d}},3990:(l,e,o)=>{o.d(e,{Z:()=>p});var d=o(2791),i=o(2350),a=o(2647),t=(o(6021),o(9760)),c=o(9661),n=o(184);const s=(0,a.PU)(),u=(0,a.Np)(),r=(0,c.a)(),v=(0,a.JC)(),m=(0,a.tL)(),b=(0,a.YZ)(),h=l=>{var e,o,a,c,s,v,h,_,p;let{data:x,collectionName:j,confirm:y}=l;const[,N]=(0,d.useState)(0);let g=null===(e=(0,i.bh)("account_ids"))||void 0===e?void 0:e[null===(o=(0,i.bh)("extraAccountPicker"))||void 0===o?void 0:o.account],f=null===(a=(0,i.bh)("sub_account_ids"))||void 0===a?void 0:a[null===(c=(0,i.bh)("extraAccountPicker"))||void 0===c?void 0:c.subAccount];const A=(l,e,o)=>{let d=(0,i.bh)("extraAccountPicker")||{};o?(d[o]||(d[o]={}),d[o][l]=e):d[l]=e,(0,i.Rz)("extraAccountPicker",d),N((0,i.M5)())};return(0,n.jsxs)("div",{style:{maxHeight:"80vh",width:"560px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,n.jsxs)("div",{className:"_dsplFlx ",children:[(0,n.jsx)("p",{className:"form_title",children:"Agregar gastos extras"}),(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:20},children:[(0,n.jsx)(b,{initvalue:null===(s=(0,i.bh)("extraAccountPicker"))||void 0===s?void 0:s.deducefromBank,keyCode:57,updChange:l=>A("deducefromBank",l)}),(0,n.jsx)("span",{className:"checklabel",children:"Deducir del Banco"})]})]}),null!==(v=(0,i.bh)("extraAccountPicker"))&&void 0!==v&&v.account?(0,n.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,n.jsxs)("div",{className:" acc_dtls",children:[(0,n.jsxs)("div",{className:"_dsplFlx",onClick:()=>{(0,i.Rz)("extraAccountPicker",null),N((0,i.M5)())},children:[(0,n.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===g||void 0===g?void 0:g.upc_barcode}),(0,n.jsx)("div",{className:"name",children:null===g||void 0===g?void 0:g.name})]}),f?(0,n.jsxs)("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[(0,n.jsx)("div",{className:"code",children:null===f||void 0===f?void 0:f.subAccount}),(0,n.jsx)("div",{className:"name",children:null===f||void 0===f?void 0:f.subAccountName})]}):null,(0,n.jsx)("div",{className:"flexSpace"})]})}):(0,n.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,n.jsx)(r,{width:420,handleClick:(l,e)=>{let o={account:l,subAccount:e};(0,i.Rz)("extraAccountPicker",o),N((0,i.M5)())}})}),(0,n.jsxs)("div",{className:"_dsplFlx spaceAround flxWrp",style:{marginLeft:7},children:[(0,n.jsxs)("div",{className:"_dsplFlx ",style:{padding:"18px"},children:[(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)(m,{data:[{label:"Deudoras",id:"debit"},{label:"Acredoras",id:"credit"}],active:null===(h=(0,i.bh)("extraAccountPicker"))||void 0===h?void 0:h.type,updSelect:l=>A("type",l)}),(0,n.jsx)("div",{className:"flexSpace"})]}),(0,n.jsx)(u,{init:null===(_=(0,i.bh)("extraAccountPicker"))||void 0===_?void 0:_.document,label:"Documento",width:220,updChanges:l=>A("document",l)}),(0,n.jsx)(u,{init:null===(p=(0,i.bh)("extraAccountPicker"))||void 0===p?void 0:p.amount,label:"Importe",width:120,type:"number",updChanges:l=>A("amount",l)})]}),(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("button",{onClick:()=>{let l={...(0,i.bh)("extraAccountPicker")}||{},e={...(0,i.bh)(j)}||{},o=(0,i.M5)();l.type||(l.type="debit"),l.amount=1*l.amount,e[o]=l,(0,i.Rz)(j,e),(0,i.Rz)("extraAccountPicker",null),N((0,i.M5)()),y&&y(),(0,t.CloseModal)({id:x.modalID})},children:"Agregar"})})]})},_=l=>{var e,o;let{data:d,deleteItem:a,idKey:t}=l,c=null===(e=(0,i.bh)("account_ids"))||void 0===e?void 0:e[null===d||void 0===d?void 0:d.account],u=null===(o=(0,i.bh)("sub_account_ids"))||void 0===o?void 0:o[null===d||void 0===d?void 0:d.subAccount];return(0,n.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:(0,n.jsx)(v,{data:c,labelField:"code",infoField:"name"})}),(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:(0,n.jsx)(v,{data:u,labelField:"subAccount",infoField:"subAccountName"})}),(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:null===d||void 0===d?void 0:d.document}),(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:(0,i.Zv)(null===d||void 0===d?void 0:d.amount,2)}),(0,n.jsx)("div",{className:"flexSpace"}),(0,n.jsx)("div",{className:"icon",onClick:()=>{a(t)},children:(0,n.jsx)(s,{name:"outline_delete",color:"#c62828"})})]})},p=l=>{var e;let{collectionName:o}=l;const[,a]=(0,d.useState)(0),c=()=>{a((0,i.M5)())},s=l=>{let e=(0,i.bh)(o)||{};delete e[l],(0,i.Rz)(o,e),a((0,i.M5)())};return(0,n.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,n.jsx)("div",{className:"_dsplFlx",children:(0,n.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{let l={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};l.content=(0,n.jsx)(h,{collectionName:o,confirm:c}),(0,t.OpenModal)(l)},children:"Agregar gastos"})}),(0,n.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:"Cuenta"}),(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:"Sub Cuenta"}),(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:"Documento"}),(0,n.jsx)("div",{className:"tr_bar tr_bar_25",children:"Monto"})]}),(0,i.bh)(o)&&(null===(e=(0,i._2)((0,i.bh)(o)))||void 0===e?void 0:e.map(((l,e)=>(0,n.jsx)(_,{idKey:l,data:(0,i.bh)(o)[l],deleteItem:s},l))))]})}},1232:(l,e,o)=>{o.d(e,{GP:()=>n,N$:()=>t,hF:()=>u,i7:()=>i,nr:()=>a,pj:()=>r});var d=o(2350);const i=async(l,e)=>{var o,i;let a={...null===(o=(0,d.bh)((0,d.hQ)()))||void 0===o?void 0:o.filter_search_opera};a.params={businessId:null===(i=(0,d.bh)("profileUser"))||void 0===i?void 0:i.businessId,":account":null===l||void 0===l?void 0:l.account,":subAccount":null===l||void 0===l?void 0:l.subAccount,year:(0,d.bh)("date_current_year")};const t=(0,d.I7)(a),n=await t;if(n&&!n.error){(0,d.Rz)("collect_list",n),(0,d.Rz)("collect_by_doc",c(n)),(0,d.Rz)("collect_by_docM",c(n));let e=(null===l||void 0===l?void 0:l.account)+"_"+(null===l||void 0===l?void 0:l.subAccount);s(n,e)}e&&e()},a=async(l,e)=>{var o,i;let a={...null===(o=(0,d.bh)((0,d.hQ)()))||void 0===o?void 0:o.filter_search_opera};a.params={businessId:null===(i=(0,d.bh)("profileUser"))||void 0===i?void 0:i.businessId,":account":null===l||void 0===l?void 0:l.account,":subAccount":null===l||void 0===l?void 0:l.subAccount,year:(0,d.bh)("date_current_year")};const t=(0,d.I7)(a),n=await t;if(n&&!n.error){(0,d.Rz)("toPay_list",n),(0,d.Rz)("toPay_by_doc",c(n,!0)),(0,d.Rz)("toPay_by_docM",c(n,!0));let e=(null===l||void 0===l?void 0:l.account)+"_"+(null===l||void 0===l?void 0:l.subAccount);s(n,e)}e&&e()},t=async l=>{var e,o;let i={...null===(e=(0,d.bh)((0,d.hQ)()))||void 0===e?void 0:e.search_opera};i.params={businessId:null===(o=(0,d.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search":(0,d.bh)("search_acc_record"),year:(0,d.bh)("date_current_year")};const a=(0,d.I7)(i),t=await a;t&&!t.error&&((0,d.Rz)("comprobante_list",t),(0,d.Rz)("comprobante_by_doc",c(t))),l&&l()};function c(l,e){var o={};let i=l&&(0,d._2)(l);return i.length>0?i.map((i=>{var a;let t=l[i],c=null===(a=t.document)||void 0===a?void 0:a.trim();if(!o[c]){o[c]={},["date","description","document","entryName"].forEach((l=>{o[c][l]=t[l]})),o[c].amount=0,o[c].operations=[]}if(t.type){let l=(0,d.Zv)(t.amount,2),i=(0,d.Zv)(o[c].amount,2),a=0;a=e?1*i+l*("debit"===t.type?-1:1):1*i+l*("credit"===t.type?-1:1),o[c].amount=(0,d.Zv)(a,2),o[c].operations.push(function(l){var e,o;let i={};i.account=null===(e=(0,d.bh)("account_ids"))||void 0===e?void 0:e[l.account],i.sub_account=null===(o=(0,d.bh)("sub_account_ids"))||void 0===o?void 0:o[l.subAccount],i.comprobanteId=l.comprobanteId,i.operationId=l.operationId,i.date=l.date,i.description=l.description;let a=(0,d.Zv)(l.amount,2);"credit"===l.type?(i.debit=0,i.credit=a):"debit"===l.type&&(i.credit=0,i.debit=a);return i}(t))}})):o=null,o}const n=(l,e,o)=>(0,d.MV)("SumDocuments",[l,e,o],(()=>{var o;let i=0;return l&&(null===(o=(0,d._2)(l))||void 0===o||o.map(((o,d)=>{var a;i+=1*(null===(a=l[o])||void 0===a?void 0:a[e])}))),i})),s=async(l,e,o)=>{let i=(0,d.bh)("rec_by_acc")||{};i[e]=((l,e,o)=>{var i;let a=0;return l&&(null===(i=(0,d._2)(l))||void 0===i||i.map(((e,o)=>{var i;let t=(0,d.Zv)(l[e].amount,2);a+=t*("credit"===(null===(i=l[e])||void 0===i?void 0:i.type)?-1:1)}))),a})(l)||"no",(0,d.Rz)("rec_by_acc",i),o&&o()},u=async(l,e,o)=>{var i,a;let t={...null===(i=(0,d.bh)((0,d.hQ)()))||void 0===i?void 0:i.filter_search_opera};t.params={businessId:null===(a=(0,d.bh)("profileUser"))||void 0===a?void 0:a.businessId,":account":null===l||void 0===l?void 0:l.account,":subAccount":null===l||void 0===l?void 0:l.subAccount,year:(0,d.bh)("date_current_year")};const c=(0,d.I7)(t),n=await c;n&&!n.error&&s(n,e),o&&o()},r=async(l,e,o)=>{var i,a;let t={...null===(i=(0,d.bh)((0,d.hQ)()))||void 0===i?void 0:i.search_subacc_acc};t.params={businessId:null===(a=(0,d.bh)("profileUser"))||void 0===a?void 0:a.businessId,":account":l,":search":e,year:(0,d.bh)("date_current_year")};const c=(0,d.I7)(t),n=await c;if(n&&!n.error){var s;let l=null===(s=(0,d._2)(n))||void 0===s?void 0:s[0];o&&o(n[l])}}},6021:()=>{}}]);
//# sourceMappingURL=5639.08bb3831.chunk.js.map