"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[5639],{5639:(l,e,o)=>{o.r(e),o.d(e,{default:()=>I});var d=o(2791),i=o(2350),c=o(2647),a=(o(6021),o(9760)),n=o(1232),t=o(9661),s=o(7689),u=o(24),r=o(3990),v=o(4050),m=o(184);const b=(0,c.PU)(),_=(0,c.Np)(),h=(0,t.FC)(),p=(0,u.f_)(),x=(0,c.JC)(),j="new_multi_collect_prov",y="Acc2MPay",N="multi_collect_by_prov_Doc",f="collect_by_docM",g="multi_collect_2S",A="extraAccountListOnCollect",I=l=>{var e,o,c,n,t,u,b,h,x,I,F;let{data:M,confirm:z}=l;const D=(0,d.useRef)(!1),[,w]=(0,d.useState)(0),S=(0,s.s0)();(0,d.useEffect)((()=>{D.current||(D.current=!0,(0,v.Ht)("global_accounts","global_account_params",P),(0,i.Rz)("PamentMethodAccount",null),(0,i.Rz)(g,null),(0,i.Rz)(f,null),(0,i.Rz)(N,null),(0,i.Rz)("accountPicker",{}),w((0,i.M5)()))}));const P=()=>{w((0,i.M5)())},T=(l,e,o)=>{let d=(0,i.bh)(j)||{};o?(d[o]||(d[o]={}),d[o][l]=e):d[l]=e,(0,i.Rz)(j,d),w((0,i.M5)())},O=()=>{let l={...(0,i.bh)(N)}||{},e={...(0,i.bh)(g)}||{};(0,i._2)(l).map((o=>{var d,c;let a=(null===(d=(0,i.bh)(y))||void 0===d?void 0:d.account)+"_"+(null===(c=(0,i.bh)(y))||void 0===c?void 0:c.subAccount)+"_"+o,n={...(0,i.bh)(y)};e[a]={},e[a].amount=1*l[o],e[a].document=o,e[a].type="credit",e[a].account=null===n||void 0===n?void 0:n.account,e[a].subAccount=null===n||void 0===n?void 0:n.subAccount,e[a].customerId=null===n||void 0===n?void 0:n.customerId})),(0,i.Rz)(g,e),(0,i.Rz)(N,null),(0,i.Rz)(y,null),w((0,i.M5)())};let Z=null===(e=(0,i.bh)("global_account_params"))||void 0===e?void 0:e.cash_bank;return(0,m.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"720px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("p",{className:"form_title",children:"Registrando Cobro"}),(0,m.jsx)("div",{className:"flexSpace"})]}),(0,m.jsxs)("div",{className:"_dsplFlx",children:[(0,m.jsx)("div",{className:"flexSpace"}),null!==Z&&void 0!==Z&&Z.account?(0,m.jsxs)("div",{className:" acc_dtls",children:[(0,m.jsxs)("div",{className:"_dsplFlx",children:[(0,m.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===(o=(0,i.bh)("account_ids"))||void 0===o||null===(c=o[null===Z||void 0===Z?void 0:Z.account])||void 0===c?void 0:c.code}),(0,m.jsx)("div",{className:"name",children:null===(n=(0,i.bh)("account_ids"))||void 0===n||null===(t=n[null===Z||void 0===Z?void 0:Z.account])||void 0===t?void 0:t.name})]}),(0,m.jsx)("div",{className:"flexSpace"})]}):null]}),(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)(p,{init:null===(u=(0,i.bh)(j))||void 0===u?void 0:u.date,updDate:l=>T("date",l)}),(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)(_,{init:null===(b=(0,i.bh)(j))||void 0===b?void 0:b.paymentDocument,label:"Documento de Cobro",width:200,updChanges:l=>T("paymentDocument",l)})]}),(0,m.jsx)(_,{init:null===(h=(0,i.bh)(j))||void 0===h?void 0:h.description,label:"Descripcion",width:520,updChanges:l=>T("description",l)}),(0,m.jsxs)("div",{className:" _dsplFlx",children:[(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{let l={zIndex:450,height:"93vh",props:{minHeight:"1vh",overlay:!0}};l.content=(0,m.jsx)(R,{updObs:w,confirm:O}),(0,a.OpenModal)(l)},children:"Clientes"})]}),(0,i.bh)(g)&&(0,i._2)((0,i.bh)(g)).length>0?(0,m.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Cuenta"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Sub Cuenta"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Documento"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Balance"})]}),(0,m.jsx)(C,{data:{account:null===Z||void 0===Z?void 0:Z.account,amount:k((0,i.bh)(g)),type:"debit",document:null===(x=(0,i.bh)(j))||void 0===x?void 0:x.paymentDocument},updObs:w}),(0,i.bh)(g)&&(null===(I=(0,i._2)((0,i.bh)(g)))||void 0===I?void 0:I.map(((l,e)=>(0,m.jsx)(C,{idKey:l,data:(0,i.bh)(g)[l],updObs:w},l))))]}):null,(0,m.jsx)(r.Z,{collectionName:A}),null!==(F=(0,i.bh)(j))&&void 0!==F&&F.paymentDocument&&(k((0,i.bh)(g))>0||k((0,i.bh)("multi_collect_anticipo_by_doc"))>0||k((0,i.bh)(A))>0)?(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("div",{className:"card",children:(0,m.jsx)("button",{onClick:async()=>{var l,e,o;let d=(0,i.bh)(j)||{},c=[];d.date?d.date=new Date(d.date).getTime()+4800:d.date=(new Date).getTime()+4800;let n=await(0,i.fN)(d.date),t="",s=0,u={date:d.date,comprobanteId:n,description:d.description,businessId:null===(l=(0,i.bh)("profileUser"))||void 0===l?void 0:l.businessId,year:new Date(d.date).getFullYear()};delete d.date;let r=(0,i.bh)("multi_collect_anticipo_by_doc")&&(0,i._2)((0,i.bh)("multi_collect_anticipo_by_doc"));r&&(null===r||void 0===r||r.map(((l,e)=>{let o=(0,i.bh)("multi_collect_anticipo_by_doc")[l];if(o){let l={};l.document=null===o||void 0===o?void 0:o.document,l.account=null===o||void 0===o?void 0:o.account,l.subAccount=null===o||void 0===o?void 0:o.subAccount,l.type=null===o||void 0===o?void 0:o.type,l.amount=null===o||void 0===o?void 0:o.amount,l.operationId=(0,i.M5)(),c.push(l)}let a={...d};a.document=null===o||void 0===o?void 0:o.documentRefer,a.account=null===o||void 0===o?void 0:o.accountRef,a.subAccount=null===o||void 0===o?void 0:o.sub_accountRef,a.type="credit",a.amount=null===o||void 0===o?void 0:o.amount,a.operationId=(0,i.M5)(),c.push(a)})));let v=(0,i.bh)(g)&&(0,i._2)((0,i.bh)(g));v&&(null===v||void 0===v||v.map(((l,e)=>{let o={...d},a=(0,i.bh)(g)[l];o.document=null===a||void 0===a?void 0:a.document,t+=(null===a||void 0===a?void 0:a.document)+" ; ",o.account=null===a||void 0===a?void 0:a.account,o.subAccount=null===a||void 0===a?void 0:a.subAccount,o.providerId=null===a||void 0===a?void 0:a.providerId,o.customerId=null===a||void 0===a?void 0:a.customerId,o.type=null===a||void 0===a?void 0:a.type,o.amount=null===a||void 0===a?void 0:a.amount,o.collectOrCollect="collect",o.operationId=(0,i.M5)(),c.push(o)})));let m=(0,i.bh)(A)&&(0,i._2)((0,i.bh)(A)),b=null===(e=(0,i.bh)("global_account_params"))||void 0===e?void 0:e.cash_bank;if(m&&(null===m||void 0===m||m.map(((l,e)=>{let o={...d},a=(0,i.bh)(A)[l];a.document?o.document=a.document:o.document=o.paymentDocument,o.account=null===a||void 0===a?void 0:a.account,o.subAccount=null===a||void 0===a?void 0:a.subAccount,o.type=null===a||void 0===a?void 0:a.type,o.amount=null===a||void 0===a?void 0:a.amount,o.operationId=(0,i.M5)(),c.push(o);let n={...d};null!==a&&void 0!==a&&a.deducefromBank?"debit"===(null===a||void 0===a?void 0:a.type)&&(s-=1*(null===a||void 0===a?void 0:a.amount)):"debit"===(null===a||void 0===a?void 0:a.type)?(n.document=n.paymentDocument,n.paymentDocument=t,n.account=null===b||void 0===b?void 0:b.account,n.type="credit"===(null===a||void 0===a?void 0:a.type)?"debit":"credit",n.amount=1*(null===a||void 0===a?void 0:a.amount),n.operationId=(0,i.M5)(),c.push(n)):"credit"===(null===a||void 0===a?void 0:a.type)&&(s+=1*(null===a||void 0===a?void 0:a.amount))}))),1*k((0,i.bh)(g))+s>0){var _;let l=k((0,i.bh)(g)),e={...d};e.document=e.paymentDocument,e.paymentDocument=t,e.account=null===b||void 0===b?void 0:b.account;let o=null===(_=(0,i.bh)("account_ids"))||void 0===_?void 0:_[e.account];o.collectOrCollect&&(e.collectOrCollect=o.collectOrCollect),e.type="debit",e.amount=1*l+s,e.operationId=(0,i.M5)(),c.push(e)}let h={...null===(o=(0,i.bh)((0,i.hQ)()))||void 0===o?void 0:o.add_multi_opera};h.params=u,h.form=c;const p=(0,i.I7)(h);await p&&setTimeout((()=>{(0,i.Rz)(N,null),(0,i.Rz)(j,null),(0,i.Rz)(m,null),(0,i.Rz)("multi_collect_anticipo_by_doc",null),(null===M||void 0===M?void 0:M.modalID)&&(0,a.CloseModal)({id:null===M||void 0===M?void 0:M.modalID}),S({pathname:"/accounting-ledger",search:"?cId=".concat(n)})}),400)},children:"Guardar"})})]}):null]})},C=l=>{var e,o;let{data:d}=l;return 1*(null===d||void 0===d?void 0:d.amount)===0?null:(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_25",style:{marginTop:10},children:(0,m.jsx)(x,{data:null===(e=(0,i.bh)("account_ids"))||void 0===e?void 0:e[null===d||void 0===d?void 0:d.account],color:"debit"===d.type?"#009688":"#c62828",labelField:"code",infoField:"name"})}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",style:{marginTop:10},children:null!==d&&void 0!==d&&d.subAccount?(0,m.jsx)(x,{data:null===(o=(0,i.bh)("sub_account_ids"))||void 0===o?void 0:o[null===d||void 0===d?void 0:d.subAccount],color:"debit"===d.type?"#009688":"#c62828",labelField:"subAccount",infoField:"subAccountName"}):null}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",style:{marginTop:10},children:null===d||void 0===d?void 0:d.document}),(0,m.jsxs)("div",{className:"tr_bar  tr_bar_25",style:{marginTop:10},children:["$",(1*(null===d||void 0===d?void 0:d.amount)).toFixed(2)]})]})},R=l=>{var e,o,c,t,s,u,r,v,b,_,p,x,j,N,g;let{data:A,confirm:I}=l;const[C,R]=(0,d.useState)(0),k=()=>{var l,e,o,d;let c=null===(l=(0,i.bh)("sub_account_ids"))||void 0===l?void 0:l[null===(e=(0,i.bh)(y))||void 0===e?void 0:e.subAccount];(0,n.pj)(null===(o=(0,i.bh)("global_account_params"))||void 0===o||null===(d=o.advance_collections)||void 0===d?void 0:d.account,c.subAccount,z)},z=l=>{var e,o;let d={account:null===(e=(0,i.bh)("global_account_params"))||void 0===e||null===(o=e.advance_collections)||void 0===o?void 0:o.account,subAccount:null===l||void 0===l?void 0:l.sub_accountId};(0,i.Rz)("advance_collections",d),(0,n.nr)(d,D)},D=()=>{R((0,i.M5)())};return(0,m.jsxs)("div",{style:{maxHeight:"92vh",minHeight:"90vh",width:"720px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("p",{className:"form_title",children:"Cobros por Clientes"}),(0,m.jsx)("div",{className:"flexSpace"})]}),(0,m.jsx)("div",{style:{margin:"18px 0"},children:null!==(e=(0,i.bh)(y))&&void 0!==e&&e.account?(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:" acc_dtls",children:[(0,m.jsxs)("div",{className:"_dsplFlx",children:[(0,m.jsx)("div",{className:"code",style:{color:"#646cff"},onClick:()=>{(0,i.Rz)(y,null),R((0,i.M5)())},children:null===(o=(0,i.bh)("account_ids"))||void 0===o||null===(c=o[null===(t=(0,i.bh)(y))||void 0===t?void 0:t.account])||void 0===c?void 0:c.code}),(0,m.jsx)("div",{className:"name",children:null===(s=(0,i.bh)("account_ids"))||void 0===s||null===(u=s[null===(r=(0,i.bh)(y))||void 0===r?void 0:r.account])||void 0===u?void 0:u.name})]}),(0,m.jsx)("div",{className:"flexSpace"}),null!==(v=(0,i.bh)(y))&&void 0!==v&&v.subAccount?(0,m.jsxs)("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[(0,m.jsx)("div",{className:"code",children:null===(b=(0,i.bh)("sub_account_ids"))||void 0===b||null===(_=b[null===(p=(0,i.bh)(y))||void 0===p?void 0:p.subAccount])||void 0===_?void 0:_.subAccount}),(0,m.jsx)("div",{className:"name",children:null===(x=(0,i.bh)("sub_account_ids"))||void 0===x||null===(j=x[null===(N=(0,i.bh)(y))||void 0===N?void 0:N.subAccount])||void 0===j?void 0:j.subAccountName})]}):null]}),(0,m.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Documento"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_20",children:"Balance"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_5"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_25",children:"Por Pagar"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_20",children:"Anticipo"})]}),(0,i.bh)(f)&&(null===(g=(0,i._2)((0,i.bh)(f)))||void 0===g?void 0:g.map(((l,e)=>(0,m.jsx)(M,{idKey:l,data:(0,i.bh)(f)[l],updObs:R},l))))]})]}):(0,m.jsx)(h,{placeholder:"buscar un provedor",width:420,handleClick:l=>{let e={account:null===l||void 0===l?void 0:l.account,subAccount:null===l||void 0===l?void 0:l.subAccount,customerId:null===l||void 0===l?void 0:l.customerId};(0,i.Rz)(y,e),(0,n.i7)(e,k)}})}),F((0,i.bh)(f))?(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{I&&I(),(null===A||void 0===A?void 0:A.modalID)&&(0,a.CloseModal)({id:null===A||void 0===A?void 0:A.modalID})},children:"Guardar"})]}):null]})},k=l=>{var e;let o=0;return l&&(null===(e=(0,i._2)(l))||void 0===e||e.map(((e,d)=>{var c;o+=1*(0,i.Zv)(null===(c=l[e])||void 0===c?void 0:c.amount,2)}))),o},F=l=>{let e=l&&(0,i._2)(l),o=(0,i.bh)(N),d=!0;return e&&(null===e||void 0===e||e.map(((e,c)=>{var a,n,t;let s=l[e],u=(null===(a=(0,i.bh)(y))||void 0===a?void 0:a.account)+"_"+(null===(n=(0,i.bh)(y))||void 0===n?void 0:n.subAccount)+"_"+s.document,r={...(0,i.bh)("multi_collect_anticipo_by_doc")},v=null===r||void 0===r||null===(t=r[u])||void 0===t?void 0:t.amount,m=v||0,b=(0,i.Zv)(1*(null===s||void 0===s?void 0:s.amount)-1*m,2),_=(0,i.Zv)(1*(null===o||void 0===o?void 0:o[s.document]),2);_&&_-b>0&&(d=!1)}))),d},M=l=>{var e,o,c;let{data:n,updObs:t,idKey:s}=l;const[u,r]=(0,d.useState)(0),[v,h]=(0,d.useState)(0);let p=(null===(e=(0,i.bh)(y))||void 0===e?void 0:e.account)+"_"+(null===(o=(0,i.bh)(y))||void 0===o?void 0:o.subAccount)+"_"+n.document,x={...(0,i.bh)("multi_collect_anticipo_by_doc")},j=null===x||void 0===x||null===(c=x[p])||void 0===c?void 0:c.amount,f=j?1*j:0;const g=l=>{h((0,i.M5)())},A=(l,e,o)=>{let d=(0,i.bh)(N)||{};o?(d[o]||(d[o]={}),d[o][l]=e):d[l]=e,(0,i.Rz)(N,d)};return 1*(null===n||void 0===n?void 0:n.amount)===0?null:(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,m.jsx)("div",{className:" tr_bar_25",style:{marginTop:10},children:null===n||void 0===n?void 0:n.document}),(0,m.jsxs)("div",{className:" tr_bar_20",style:{marginTop:10},children:["$",(1*(null===n||void 0===n?void 0:n.amount)-f).toFixed(2)]}),(0,m.jsx)("div",{className:"tr_bar_5",style:{marginTop:10},children:u>(null===n||void 0===n?void 0:n.amount)-f?(0,m.jsx)("div",{className:"icon",children:(0,m.jsx)(b,{name:"alert",color:"#c62828"})}):null}),(0,m.jsx)("div",{className:" tr_bar_25",children:(0,m.jsx)(_,{init:u,type:"number",width:120,updChanges:l=>{return r(e=l),A(null===n||void 0===n?void 0:n.document,e),void t((0,i.M5)());var e}})}),(0,m.jsx)("div",{className:" tr_bar_20",style:{marginTop:10},onClick:()=>{let l={zIndex:450,height:"93vh",props:{minHeight:"1vh",overlay:!0}};l.content=(0,m.jsx)(z,{confirm:g,item:n}),(0,a.OpenModal)(l)},children:null===f||void 0===f?void 0:f.toFixed(2)})]})},z=l=>{var e;let{data:o,confirm:c,item:n}=l;const[t,s]=(0,d.useState)(""),u=l=>{c&&c(l),(null===o||void 0===o?void 0:o.modalID)&&(0,a.CloseModal)({id:null===o||void 0===o?void 0:o.modalID})};return(0,m.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"88vh",width:"660px",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("p",{className:"form_title",children:"Anticipos por Clientes"}),(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("p",{className:"group_title addBtn",onClick:()=>(()=>{var l,e;let d={...(0,i.bh)("multi_collect_anticipo_by_doc")}||{};delete d[(null===(l=(0,i.bh)(y))||void 0===l?void 0:l.account)+"_"+(null===(e=(0,i.bh)(y))||void 0===e?void 0:e.subAccount)+"_"+n.document],(0,i.Rz)("multi_collect_anticipo_by_doc",d),c&&c(0),(null===o||void 0===o?void 0:o.modalID)&&(0,a.CloseModal)({id:null===o||void 0===o?void 0:o.modalID})})(),children:"Borrar"})]}),(0,m.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,m.jsx)("div",{className:"tr_bar_40 tex_left",children:"Cliente"}),(0,m.jsx)("div",{className:"tr_bar_20",children:"Balance"}),(0,m.jsx)("div",{className:"tr_bar_5"}),(0,m.jsx)("div",{className:"tr_bar_25",children:"Amount"}),(0,m.jsx)("div",{className:"tr_bar_10"})]}),(0,m.jsx)("div",{className:"accounts_container ",children:(0,i.bh)("toPay_by_doc")&&(null===(e=(0,i._2)((0,i.bh)("toPay_by_doc")))||void 0===e?void 0:e.map(((l,e)=>{let o=(0,i.bh)("toPay_by_doc")[l];return 0===1*(null===o||void 0===o?void 0:o.amount)?null:(0,m.jsx)(D,{document:n.document,itm:o,activeDoc:t,updDoc:s,closeModal:u},o.document+"_"+e)})))})]})]})},D=l=>{let{itm:e,closeModal:o,activeDoc:c,updDoc:a,document:n}=l;const[t,s]=(0,d.useState)(0);let u=w(e.document,{...(0,i.bh)("multi_collect_anticipo_by_doc")});return(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar",style:{margin:"2px 0"},children:[(0,m.jsx)("div",{className:"tr_bar_40 tex_left",style:{marginTop:10,color:c===e.document?"var(--hrm_palette-blue-purple)":""},onClick:()=>{a(e.document),s(0)},children:e.document}),(0,m.jsxs)("div",{className:"tr_bar_20",style:{marginTop:10},children:["$",(1*(null===e||void 0===e?void 0:e.amount)-1*u).toFixed(2)]}),(0,m.jsx)("div",{className:"tr_bar_5",style:{marginTop:10},children:t>(null===e||void 0===e?void 0:e.amount)?(0,m.jsx)("div",{className:"icon",children:(0,m.jsx)(b,{name:"alert",color:"#c62828"})}):null}),(0,m.jsx)("div",{className:"tr_bar_25",children:c===e.document?(0,m.jsx)(_,{init:t,type:"number",width:80,updChanges:l=>s(1*l)}):null}),(0,m.jsx)("div",{className:"tr_bar_10",style:{marginTop:10,marginLeft:9},children:c===e.document&&t<=1*(null===e||void 0===e?void 0:e.amount)?(0,m.jsx)("div",{className:"icon",onClick:()=>(l=>{var d,c,a,s;let u={...(0,i.bh)("multi_collect_anticipo_by_doc")}||{},r=(null===(d=(0,i.bh)(y))||void 0===d?void 0:d.account)+"_"+(null===(c=(0,i.bh)(y))||void 0===c?void 0:c.subAccount)+"_"+n,v={...(0,i.bh)("advance_collections")};v.document=e.document,v.documentRefer=n,v.amount=1*t,v.type="debit",v.description=l.description,v.accountRef=null===(a=(0,i.bh)(y))||void 0===a?void 0:a.account,v.sub_accountRef=null===(s=(0,i.bh)(y))||void 0===s?void 0:s.subAccount,u[r]=v,(0,i.Rz)("multi_collect_anticipo_by_doc",u),o(1*t)})(e),children:(0,m.jsx)(b,{name:"add",color:"var(--hrm_palette-blue-purple)"})}):null})]})},w=(l,e)=>{var o;let d=0;return e&&(null===(o=(0,i._2)(e))||void 0===o||o.map(((o,c)=>{var a,n;l===(null===(a=e[o])||void 0===a?void 0:a.document)&&(d+=1*(0,i.Zv)(null===(n=e[o])||void 0===n?void 0:n.amount,2))}))),d}},3990:(l,e,o)=>{o.d(e,{Z:()=>p});var d=o(2791),i=o(2350),c=o(2647),a=(o(6021),o(9760)),n=o(9661),t=o(184);const s=(0,c.PU)(),u=(0,c.Np)(),r=(0,n.a)(),v=(0,c.JC)(),m=(0,c.tL)(),b=(0,c.YZ)(),_=l=>{var e,o,c,n,s,v,_,h,p;let{data:x,collectionName:j,confirm:y}=l;const[,N]=(0,d.useState)(0);let f=null===(e=(0,i.bh)("account_ids"))||void 0===e?void 0:e[null===(o=(0,i.bh)("extraAccountPicker"))||void 0===o?void 0:o.account],g=null===(c=(0,i.bh)("sub_account_ids"))||void 0===c?void 0:c[null===(n=(0,i.bh)("extraAccountPicker"))||void 0===n?void 0:n.subAccount];const A=(l,e,o)=>{let d=(0,i.bh)("extraAccountPicker")||{};o?(d[o]||(d[o]={}),d[o][l]=e):d[l]=e,(0,i.Rz)("extraAccountPicker",d),N((0,i.M5)())};return(0,t.jsxs)("div",{style:{maxHeight:"80vh",width:"560px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,t.jsxs)("div",{className:"_dsplFlx ",children:[(0,t.jsx)("p",{className:"form_title",children:"Agregar gastos extras"}),(0,t.jsx)("div",{className:"flexSpace"}),(0,t.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:20},children:[(0,t.jsx)(b,{initvalue:null===(s=(0,i.bh)("extraAccountPicker"))||void 0===s?void 0:s.deducefromBank,keyCode:57,updChange:l=>A("deducefromBank",l)}),(0,t.jsx)("span",{className:"checklabel",children:"Deducir del Banco"})]})]}),null!==(v=(0,i.bh)("extraAccountPicker"))&&void 0!==v&&v.account?(0,t.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,t.jsxs)("div",{className:" acc_dtls",children:[(0,t.jsxs)("div",{className:"_dsplFlx",onClick:()=>{(0,i.Rz)("extraAccountPicker",null),N((0,i.M5)())},children:[(0,t.jsx)("div",{className:"code",style:{color:"#646cff"},children:null===f||void 0===f?void 0:f.upc_barcode}),(0,t.jsx)("div",{className:"name",children:null===f||void 0===f?void 0:f.name})]}),g?(0,t.jsxs)("div",{className:"_dsplFlx",style:{margin:"10px 0 0 18px"},children:[(0,t.jsx)("div",{className:"code",children:null===g||void 0===g?void 0:g.subAccount}),(0,t.jsx)("div",{className:"name",children:null===g||void 0===g?void 0:g.subAccountName})]}):null,(0,t.jsx)("div",{className:"flexSpace"})]})}):(0,t.jsx)("div",{className:"_dsplFlx ",style:{margin:"18px 0"},children:(0,t.jsx)(r,{width:420,handleClick:(l,e)=>{let o={account:l,subAccount:e};(0,i.Rz)("extraAccountPicker",o),N((0,i.M5)())}})}),(0,t.jsxs)("div",{className:"_dsplFlx spaceAround flxWrp",style:{marginLeft:7},children:[(0,t.jsxs)("div",{className:"_dsplFlx ",style:{padding:"18px"},children:[(0,t.jsx)("div",{className:"flexSpace"}),(0,t.jsx)(m,{data:[{label:"Deudoras",id:"debit"},{label:"Acredoras",id:"credit"}],active:null===(_=(0,i.bh)("extraAccountPicker"))||void 0===_?void 0:_.type,updSelect:l=>A("type",l)}),(0,t.jsx)("div",{className:"flexSpace"})]}),(0,t.jsx)(u,{init:null===(h=(0,i.bh)("extraAccountPicker"))||void 0===h?void 0:h.document,label:"Documento",width:220,updChanges:l=>A("document",l)}),(0,t.jsx)(u,{init:null===(p=(0,i.bh)("extraAccountPicker"))||void 0===p?void 0:p.amount,label:"Importe",width:120,type:"number",updChanges:l=>A("amount",l)})]}),(0,t.jsx)("div",{className:"card",children:(0,t.jsx)("button",{onClick:()=>{let l={...(0,i.bh)("extraAccountPicker")}||{},e={...(0,i.bh)(j)}||{},o=(0,i.M5)();l.type||(l.type="debit"),l.amount=1*l.amount,e[o]=l,(0,i.Rz)(j,e),(0,i.Rz)("extraAccountPicker",null),N((0,i.M5)()),y&&y(),(0,a.CloseModal)({id:x.modalID})},children:"Agregar"})})]})},h=l=>{var e,o;let{data:d,deleteItem:c,idKey:a}=l,n=null===(e=(0,i.bh)("account_ids"))||void 0===e?void 0:e[null===d||void 0===d?void 0:d.account],u=null===(o=(0,i.bh)("sub_account_ids"))||void 0===o?void 0:o[null===d||void 0===d?void 0:d.subAccount];return(0,t.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:(0,t.jsx)(v,{data:n,labelField:"code",infoField:"name"})}),(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:(0,t.jsx)(v,{data:u,labelField:"subAccount",infoField:"subAccountName"})}),(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:null===d||void 0===d?void 0:d.document}),(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:(0,i.Zv)(null===d||void 0===d?void 0:d.amount,2)}),(0,t.jsx)("div",{className:"flexSpace"}),(0,t.jsx)("div",{className:"icon",onClick:()=>{c(a)},children:(0,t.jsx)(s,{name:"outline_delete",color:"#c62828"})})]})},p=l=>{var e;let{collectionName:o}=l;const[,c]=(0,d.useState)(0),n=()=>{c((0,i.M5)())},s=l=>{let e=(0,i.bh)(o)||{};delete e[l],(0,i.Rz)(o,e),c((0,i.M5)())};return(0,t.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,t.jsx)("div",{className:"_dsplFlx",children:(0,t.jsx)("p",{className:"group_title addBtn purple",onClick:()=>{let l={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};l.content=(0,t.jsx)(_,{collectionName:o,confirm:n}),(0,a.OpenModal)(l)},children:"Agregar gastos"})}),(0,t.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:"Cuenta"}),(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:"Sub Cuenta"}),(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:"Documento"}),(0,t.jsx)("div",{className:"tr_bar tr_bar_25",children:"Monto"})]}),(0,i.bh)(o)&&(null===(e=(0,i._2)((0,i.bh)(o)))||void 0===e?void 0:e.map(((l,e)=>(0,t.jsx)(h,{idKey:l,data:(0,i.bh)(o)[l],deleteItem:s},l))))]})}},1232:(l,e,o)=>{o.d(e,{GP:()=>t,N$:()=>a,hF:()=>u,i7:()=>i,nr:()=>c,pj:()=>r});var d=o(2350);const i=async(l,e)=>{var o,i;let c={...null===(o=(0,d.bh)((0,d.hQ)()))||void 0===o?void 0:o.filter_search_opera};c.params={businessId:null===(i=(0,d.bh)("profileUser"))||void 0===i?void 0:i.businessId,":account":null===l||void 0===l?void 0:l.account,":subAccount":null===l||void 0===l?void 0:l.subAccount,year:(0,d.bh)("date_current_year")};const a=(0,d.I7)(c),t=await a;if(t&&!t.error){(0,d.Rz)("collect_list",t),(0,d.Rz)("collect_by_doc",n(t)),(0,d.Rz)("collect_by_docM",n(t));let e=(null===l||void 0===l?void 0:l.account)+"_"+(null===l||void 0===l?void 0:l.subAccount);s(t,e)}e&&e()},c=async(l,e)=>{var o,i;let c={...null===(o=(0,d.bh)((0,d.hQ)()))||void 0===o?void 0:o.filter_search_opera};c.params={businessId:null===(i=(0,d.bh)("profileUser"))||void 0===i?void 0:i.businessId,":account":null===l||void 0===l?void 0:l.account,":subAccount":null===l||void 0===l?void 0:l.subAccount,year:(0,d.bh)("date_current_year")};const a=(0,d.I7)(c),t=await a;if(t&&!t.error){(0,d.Rz)("toPay_list",t),(0,d.Rz)("toPay_by_doc",n(t,!0)),(0,d.Rz)("toPay_by_docM",n(t,!0));let e=(null===l||void 0===l?void 0:l.account)+"_"+(null===l||void 0===l?void 0:l.subAccount);s(t,e)}e&&e()},a=async l=>{var e,o;let i={...null===(e=(0,d.bh)((0,d.hQ)()))||void 0===e?void 0:e.search_opera};i.params={businessId:null===(o=(0,d.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search":(0,d.bh)("search_acc_record"),year:(0,d.bh)("date_current_year")};const c=(0,d.I7)(i),a=await c;a&&!a.error&&((0,d.Rz)("comprobante_list",a),(0,d.Rz)("comprobante_by_doc",n(a))),l&&l()};function n(l,e){var o={};let i=l&&(0,d._2)(l);return i.length>0?i.map((i=>{var c;let a=l[i],n=null===(c=a.document)||void 0===c?void 0:c.trim();if(!o[n]){o[n]={},["date","description","document","entryName"].forEach((l=>{o[n][l]=a[l]})),o[n].amount=0,o[n].operations=[]}if(a.type){let l=(0,d.Zv)(a.amount,2),i=(0,d.Zv)(o[n].amount,2),c=0;c=e?1*i+l*("debit"===a.type?-1:1):1*i+l*("credit"===a.type?-1:1),o[n].amount=(0,d.Zv)(c,2),o[n].operations.push(function(l){var e,o;let i={};i.account=null===(e=(0,d.bh)("account_ids"))||void 0===e?void 0:e[l.account],i.sub_account=null===(o=(0,d.bh)("sub_account_ids"))||void 0===o?void 0:o[l.subAccount],i.comprobanteId=l.comprobanteId,i.operationId=l.operationId,i.date=l.date,i.description=l.description;let c=(0,d.Zv)(l.amount,2);"credit"===l.type?(i.debit=0,i.credit=c):"debit"===l.type&&(i.credit=0,i.debit=c);return i}(a))}})):o=null,o}const t=(l,e,o)=>(0,d.MV)("SumDocuments",[l,e,o],(()=>{var o;let i=0;return l&&(null===(o=(0,d._2)(l))||void 0===o||o.map(((o,d)=>{var c;i+=1*(null===(c=l[o])||void 0===c?void 0:c[e])}))),i})),s=async(l,e,o)=>{let i=(0,d.bh)("rec_by_acc")||{};i[e]=((l,e,o)=>{var i;let c=0;return l&&(null===(i=(0,d._2)(l))||void 0===i||i.map(((e,o)=>{var i;let a=(0,d.Zv)(l[e].amount,2);c+=a*("credit"===(null===(i=l[e])||void 0===i?void 0:i.type)?-1:1)}))),c})(l)||"no",(0,d.Rz)("rec_by_acc",i),o&&o()},u=async(l,e,o)=>{var i,c;let a={...null===(i=(0,d.bh)((0,d.hQ)()))||void 0===i?void 0:i.filter_search_opera};a.params={businessId:null===(c=(0,d.bh)("profileUser"))||void 0===c?void 0:c.businessId,":account":null===l||void 0===l?void 0:l.account,":subAccount":null===l||void 0===l?void 0:l.subAccount,year:(0,d.bh)("date_current_year")};const n=(0,d.I7)(a),t=await n;t&&!t.error&&s(t,e),o&&o()},r=async(l,e,o)=>{var i,c;let a={...null===(i=(0,d.bh)((0,d.hQ)()))||void 0===i?void 0:i.search_subacc_acc};a.params={businessId:null===(c=(0,d.bh)("profileUser"))||void 0===c?void 0:c.businessId,":account":l,":search":e,year:(0,d.bh)("date_current_year")};const n=(0,d.I7)(a),t=await n;if(t&&!t.error){var s;let l=null===(s=(0,d._2)(t))||void 0===s?void 0:s[0];o&&o(t[l])}}},6021:()=>{}}]);
//# sourceMappingURL=5639.b8d0edd8.chunk.js.map