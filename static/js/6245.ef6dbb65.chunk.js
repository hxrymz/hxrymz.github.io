"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[6245],{713:(o,n,s)=>{s.d(n,{$P:()=>f,B8:()=>U,H9:()=>R,IR:()=>b,N0:()=>l,QJ:()=>y,Rd:()=>p,VI:()=>g,Ve:()=>_,WA:()=>w,ZW:()=>u,Zj:()=>Q,_U:()=>t,fK:()=>c,g5:()=>e,ii:()=>m,nj:()=>z,qT:()=>h,qv:()=>I,yJ:()=>d,yk:()=>v});var i=s(2350);const e={WH:"Almacen",PR:"Production",PT:"Patio"},t=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.scan_inv_location};e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId};let t=(0,i.bh)("date_range_inv_loc");if(t||(0,i.bh)("locationId2F")||(0,i.bh)("productId2F")||(0,i.bh)("searchLocationQry")&&(0,i.bh)("searchLocationQry").length>1){if((0,i.bh)("searchLocationQry").split(" ").map(((o,n)=>{o&&(e.params[":search"+n]=o.trim())})),(0,i.bh)("locationId2F")&&(e.params[":search5"]=(0,i.bh)("locationId2F").trim()),(0,i.bh)("productId2F")){let o=5;(0,i.bh)("locationId2F")&&(o=4),e.params[":search"+o]=(0,i.bh)("productId2F").trim()}null!==t&&void 0!==t&&t.initDate&&(e.params[":date1"]=null===t||void 0===t?void 0:t.initDate,e.params[":date2"]=null===t||void 0===t?void 0:t.lastDate);const n=(0,i.I7)(e),s=await n;s&&!s.error&&(r(s),(0,i.Rz)("inv_location_ids",s),(0,i.Rz)("inv_location_list",Q((0,i.jQ)(s),"date",0)),o&&o())}else(0,i.Rz)("inv_location_list",null),o&&o()},r=async o=>{let n={},s={};o&&(0,i._2)(o).map((i=>{var e,t,r,a;n[null===(e=o[i])||void 0===e?void 0:e.inventoryId]||(n[null===(r=o[i])||void 0===r?void 0:r.inventoryId]=1);s[null===(t=o[i])||void 0===t?void 0:t.productId]||(s[null===(a=o[i])||void 0===a?void 0:a.productId]=1)}));const e=(0,i._2)(s).map((async o=>{await a(o)}));await Promise.all(e);return 1},a=async o=>{var n,s;if(console.log(o),null!==(n=(0,i.bh)("ProductsOnScanItems"))&&void 0!==n&&n[o])return null===(s=(0,i.bh)("ProductsOnScanItems"))||void 0===s?void 0:s[o];{var e,t;let n={...null===(e=(0,i.bh)((0,i.hQ)()))||void 0===e?void 0:e.search_prod};n.params={businessId:null===(t=(0,i.bh)("profileUser"))||void 0===t?void 0:t.businessId,":search0":o};const s=(0,i.I7)(n),r=await s;if(console.log(n),console.log(r),r){let n=(0,i.bh)("ProductsOnScanItems")||{};return n[o]=r[o],(0,i.Rz)("ProductsOnScanItems",n),r[o]}return null}},d=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.search_prod};e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId,":search0":o};const t=(0,i.I7)(e),r=await t;if(r){let o=(0,i.bh)("ProductsOnScanItems")||{},n=Object.assign({},o,r);return(0,i.Rz)("ProductsOnScanItems",n),P(r)}return[]},l=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.scan_area_location};e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId,limit:120};const t=(0,i.I7)(e),r=await t;r?((0,i.Rz)("location_drpdwn",k(r)),(0,i.Rz)("locations_ids",r),(0,i.Rz)("locations_list",Q((0,i.jQ)(r),"areaLocationId")),o&&o()):o&&o()},c=async(o,n)=>{var s,e;let t={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.scan_voucher_production};t.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,":search0":o};const r=(0,i.I7)(t),a=await r;a&&!a.error&&(0,i._2)(a)&&(0,i._2)(a).length>0?n&&n(a):n&&n(null)},v=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.scan_voucher_production};if(e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId,limit:120},(0,i.bh)("searchVoucherQry")&&(0,i.bh)("searchVoucherQry").length>1){(0,i.bh)("searchVoucherQry").split(" ").map(((o,n)=>{o&&(e.params[":search"+n]=o.trim())}));const n=(0,i.I7)(e),s=await n;s&&((0,i.Rz)("voucher_production",s),(0,i.Rz)("vouchers_list",Q((0,i.jQ)(s),"voucherId")),o&&o())}else(0,i.Rz)("vouchers_list",null),o&&o()},u=async(o,n)=>{var s,e;let t={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.get_inventory_prod};t.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,":productId":o};const r=(0,i.I7)(t),a=await r;a&&((0,i.Rz)("inv_products_list",Q((0,i.jQ)(a.list),"name")),(0,i.Rz)("inv_products_stock",a.stock),n&&n())},p=async(o,n)=>{var s,e;let t={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.get_prod_stock};t.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,productId:o};const r=(0,i.I7)(t),a=await r;if(a){let s={...(0,i.bh)("products_stock")};s[o]=a.stock,(0,i.Rz)("products_stock",s),n&&n()}},h=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.all_prods};e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId},e.subQuerys={},e.subQuerys.stock=1;const t=(0,i.I7)(e),r=await t;if(r){let n={},s=[],e=0;r.map((o=>{var t;if(null!==o&&void 0!==o&&null!==(t=o.inventory)&&void 0!==t&&t.qty){var r,a,d;if(e+=1*(0,i.Zv)(null===o||void 0===o||null===(r=o.inventory)||void 0===r?void 0:r.amount,2),n[o.unit])n[o.unit]+=null===o||void 0===o||null===(a=o.inventory)||void 0===a?void 0:a.qty;else n[o.unit]=null===o||void 0===o||null===(d=o.inventory)||void 0===d?void 0:d.qty;s.push({productId:o.productId,name:o.name,unit:o.unit,qty:(1*o.inventory.qty).toFixed(2),amount:(1*o.inventory.amount).toFixed(2),cost:(o.inventory.amount/o.inventory.qty*1).toFixed(2)})}})),(0,i.Ey)(o)&&o({list:Q(s,"name"),total:e,units:n})}},b=async(o,n)=>{var s,e;let t={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.group_prod_stock};t.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId};const r=(0,i.I7)(t),a=await r;if(a){let s=(0,i._I)(a.comps),e=0,t=0,r=0,d=[],l=[];(0,i._2)(o).map((n=>{let c={...o[n]},v=("debit"===o[n].type?1:-1)*o[n].amount,u=1*(0,i.Zv)(v,2);if(e+=u,a.comps[o[n].comprobanteId]){c.inventory=a.comps[o[n].comprobanteId];let e=0;if((0,i._2)(a.comps[o[n].comprobanteId]).map((s=>{e=1*(0,i.Zv)(e,2)+1*(0,i.Zv)(a.comps[o[n].comprobanteId][s],2)})),e=e<0?-1*e:e,e=1*(0,i.Zv)(e,2),c.inventoryAmount=e,t+=e,u=u<0?-1*u:u,u-e!==0){let o=u-e;r+=o,l.push(c),console.log("diff",c,u,e,o)}else d.push(c);delete s[o[n].comprobanteId]}else r+=v,l.push(c)}));let c=0;(0,i._2)(s).map((o=>{let n=0;(0,i._2)(s[o]).map((e=>{n=1*(0,i.Zv)(n,2)+1*(0,i.Zv)(s[o][e],2)})),c+=n})),console.log("inventoryBack",s,"inventoryBackTotal",c),(0,i.Rz)("inv_comprobantes_compare",{hasError:l,success:d,inventoryBack:s}),(0,i.Ey)(n)&&n()}},I=async o=>{var n,s,e;let t={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.filter_search_opera};t.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId,year:(0,i.bh)("date_current_year"),":account":null===(e=(0,i.bh)("global_account_params"))||void 0===e?void 0:e.inventory.account};const r=(0,i.I7)(t),a=await r;a&&!a.error&&(0,i.Ey)(o)&&o(Q((0,i.jQ)(a),"date"))},m=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.all_prods};e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId};const t=(0,i.I7)(e),r=await t;r&&((0,i.Rz)("products_list",Q(r,"name")),(0,i.Rz)("products_ids",(0,i.ME)((0,i.jQ)(r),"productId")),o&&o())},_=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.search_prod};if(e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId,limit:120},(0,i.bh)("searchQry").length>1){(0,i.bh)("searchQry").split(" ").map(((o,n)=>{o&&(e.params[":search"+n]=o.trim())}));const n=(0,i.I7)(e),s=await n;s&&((0,i.Rz)("products_list",Q((0,i.jQ)(s),"code")),o&&o())}else(0,i.Rz)("products_list",null),o&&o()},y=async o=>{var n,s;let e={...null===(n=(0,i.bh)((0,i.hQ)()))||void 0===n?void 0:n.all_entry_invoices};e.params={businessId:null===(s=(0,i.bh)("profileUser"))||void 0===s?void 0:s.businessId};const t=(0,i.I7)(e),r=await t;r&&((0,i.Rz)("movements_list",Q(r,"date")),(0,i.Rz)("movements_ids",(0,i.ME)((0,i.jQ)(r),"inventoryId")),o&&o())},f=async o=>{var n;if((null===(n=(0,i.bh)("searchMovQry"))||void 0===n?void 0:n.length)>1){var s,e;let n={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.search_inventory};n.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,":search0":(0,i.bh)("searchMovQry")};const t=(0,i.I7)(n),r=await t;r&&((0,i.Rz)("movements_list",function(o){var n={};let s=o&&(0,i._2)(o);s.length>0?s.map((s=>{let i=o[s];n[i.comprobanteId]||(n[i.comprobanteId]={},n[i.comprobanteId].amount=0,n[i.comprobanteId].document=i.document,n[i.comprobanteId].date=i.date,n[i.comprobanteId].comprobanteId=i.comprobanteId,n[i.comprobanteId].entriesInvoiceId=i.entriesInvoiceId,n[i.comprobanteId].products=[]),n[i.comprobanteId].amount+=i.qty*i.price,n[i.comprobanteId].products.push({productId:i.productId,qty:i.qty,price:i.price,inventoryId:i.inventoryId})})):n=null;return n}(r)),(0,i.Rz)("movements_ids",r),o&&o())}else(0,i.Rz)("movements_list",[]),(0,i.Rz)("movements_ids",{}),o&&o()};const Q=function(o,n){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,i.MV)("sortProducts",[o],(()=>o&&o.sort(((o,i)=>{let e=o[n],t=i[n];return e<t?s?-1:1:e>t?s?1:-1:0}))))},R=async(o,n)=>{var s,e;let t={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.rmv_inv_location};t.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,inventoryLocationId:o};const r=(0,i.I7)(t);await r&&n&&n()},z=async(o,n)=>{var s,e;let t={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.delete_prod};t.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,productId:o};const r=(0,i.I7)(t);await r&&n&&n()},w=async(o,n)=>{var s,e;let t={...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.delete_inventory};t.params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,inventoryId:o};const r=(0,i.I7)(t);await r&&n&&n()},g=async(o,n)=>{var s,e;({...null===(s=(0,i.bh)((0,i.hQ)()))||void 0===s?void 0:s.entry_invoice_acc_2}).params={businessId:null===(e=(0,i.bh)("profileUser"))||void 0===e?void 0:e.businessId,entriesInvoiceId:o}},U=(o,n)=>(0,i.MV)("rangeProdArr",[o,n],(()=>o?(0,i._2)(o).slice(0,n):[])),k=o=>{let n=[{id:null,label:"Location"}];return o&&(0,i._2)(o).map((s=>{var i,e;n.push({id:s,label:"".concat(null===(i=o[s])||void 0===i?void 0:i.areaId,"-").concat(null===(e=o[s])||void 0===e?void 0:e.location)})})),n},P=o=>{let n=[];return o&&(0,i._2)(o).map((s=>{var i;n.push({id:s,label:null===(i=o[s])||void 0===i?void 0:i.name})})),n}}}]);
//# sourceMappingURL=6245.ef6dbb65.chunk.js.map