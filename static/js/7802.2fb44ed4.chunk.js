"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[7802],{3728:function(n,e,t){t.d(e,{NA:function(){return u},g5:function(){return i},ph:function(){return o},yq:function(){return c}});var r=t(4165),a=t(5861),s=t(2350),o=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e){var t,a,o,c,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(o=null===(t=(0,s.bh)((0,s.hQ)()))||void 0===t?void 0:t.all_entries).params={businessId:null===(a=(0,s.bh)("profileUser"))||void 0===a?void 0:a.businessId},c=(0,s.I7)(o),n.next=5,c;case 5:(i=n.sent)&&((0,s.Rz)("entries_list",i),(0,s.Rz)("entries_ids",(0,s.ME)(i,"accountingEntryId")),e&&e());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),c=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e){var t,a,o,c,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(o=null===(t=(0,s.bh)((0,s.hQ)()))||void 0===t?void 0:t.search_entries).params={businessId:null===(a=(0,s.bh)("profileUser"))||void 0===a?void 0:a.businessId,":search":(0,s.bh)("search_entry_qry")},c=(0,s.I7)(o),n.next=5,c;case 5:(i=n.sent)&&((0,s.Rz)("entries_list",i),e&&e());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),i=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e,t){var a,o,c,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(c=null===(a=(0,s.bh)((0,s.hQ)()))||void 0===a?void 0:a.delete_entries).params={businessId:null===(o=(0,s.bh)("profileUser"))||void 0===o?void 0:o.businessId,accountingEntryId:e},i=(0,s.I7)(c),n.next=5,i;case 5:n.sent&&t&&t();case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),u=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e){var t,a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=(0,s.I7)({query:"getLastSequence"}),n.next=3,t;case 3:if(!(a=n.sent)){n.next=7;break}return e&&e(a),n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},5686:function(n,e,t){t.r(e);var r=t(4296),a=t(4165),s=t(5861),o=t(1413),c=t(9439),i=t(2791),u=t(2350),l=t(2647),d=(t(1e3),t(3588)),p=t(2692),v=t(4050),h=t(7689),f=t(5281),m=t(9760),_=(t(3728),t(184)),b=(0,l.h0)(),x=(0,l.Vg)(),Z=(0,p.LO)(),y=(0,l.PU)(),g="coll2list";e.default=function(n){n.data,n.elmId,n.updObs;var e,t,r,l,p,f=(0,i.useState)(!1),N=(0,c.Z)(f,2),w=N[0],k=N[1],R=(0,i.useState)(0),z=(0,c.Z)(R,2),C=(z[0],z[1]),S=(0,i.useState)(128),D=(0,c.Z)(S,2),F=D[0],A=D[1],E=(0,i.useState)(!1),Q=(0,c.Z)(E,2),U=Q[0],B=Q[1],M=(0,i.useState)(!1),T=(0,c.Z)(M,2),q=T[0],V=T[1],H=(0,h.TH)(),O=(0,h.s0)();(0,i.useEffect)((function(){setTimeout((function(){var n,e,t=null===(n=H.search)||void 0===n||null===(e=n.split("?"))||void 0===e?void 0:e[1],r=(0,u.mB)(t);null!==r&&void 0!==r&&r.cId&&((0,u.Rz)("search_acc_record",null===r||void 0===r?void 0:r.cId),(0,d.N$)(J)),(0,v.Ht)("comp_under_review","comp_under_review",P)}),350)}),[H]),(0,i.useEffect)((function(){w||(k(!0),C((0,u.M5)()),(0,v._0)(P),(0,v.ZX)(L))}));var $=function(){},J=function(){var n=(0,o.Z)({},(0,u.bh)("comprobante_by_doc"));(0,u.Rz)(g,n),U&&(0,u.Rz)(g,I(n)),P()},L=function(n){J(),(0,u.Rz)("comprobante_list",null),(0,u.Rz)("comprobante_by_doc",null),V(!1)},P=function(){var n=(0,s.Z)((0,a.Z)().mark((function n(e,t){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:C((0,u.M5)()),V(!1);case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),W=function(n){null!==n&&void 0!==n&&n.initDate&&null!==n&&void 0!==n&&n.lastDate&&(0,u.Rz)("date_range_comps",n),(0,d.Ng)(J)},G=(null===(e=(0,u.bh)("date_range_comps"))||void 0===e?void 0:e.initDate)&&(0,u.sJ)(null===(t=(0,u.bh)("date_range_comps"))||void 0===t?void 0:t.initDate)+"-"+(0,u.sJ)(null===(r=(0,u.bh)("date_range_comps"))||void 0===r?void 0:r.lastDate);return(0,_.jsxs)("div",{className:"",children:[(0,_.jsxs)("div",{className:"accounts_header",children:[(0,_.jsx)("h2",{children:"Comprobantes"}),(0,_.jsxs)("div",{className:"_dsplFlx ",children:[(0,_.jsx)("p",{className:"group_title addBtn purple",onClick:function(n){O({pathname:"/entries"})},children:"Agregar Comprobantes"}),(0,_.jsx)("p",{className:"group_title addBtn purple",onClick:function(){(0,u.eY)("export_comprobantes_list_"+(0,u.M5)()+".csv",(0,d.bx)())},children:"Exportar a CSV"})]}),(0,_.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,_.jsx)(x,{placeholder:"Buscar ....",width:360,obs:C,fetchData:function(n){V(!0),A((function(n){return 128})),(0,d.N$)(J)},loading:q,change:function(n){!q&&V(!0)},callempty:L,keyFlds:"search_acc_record"}),(0,_.jsx)("div",{className:"flexSpace"}),(0,_.jsxs)("div",{className:"_dsplFlx ",children:[(0,_.jsx)("div",{className:"total_comprobante_title",children:"No de Comprobantes:"}),(0,_.jsx)("div",{className:"total_comprobante gray",children:(0,_.jsx)("span",{children:null===(l=(0,u._2)((0,u.bh)(g)))||void 0===l?void 0:l.length})})]})]})]}),(0,_.jsxs)("div",{className:"_dsplFlx ",style:{marginBottom:14,maxWidth:500},children:[(0,_.jsxs)("div",{className:"filter_date_btn _dsplFlx",onClick:function(){var n,e,t={zIndex:950,height:"80vh",props:{minHeight:"1vh",overlay:!0}};t.content=(0,_.jsx)(b,{onConfirm:W,init:null===(n=(0,u.bh)("date_range_comps"))||void 0===n?void 0:n.initDate,last:null===(e=(0,u.bh)("date_range_comps"))||void 0===e?void 0:e.lastDate,isRange:!0}),(0,m.OpenModal)(t)},children:[(0,_.jsx)("div",{className:"lbl date",children:G||"Fecha"}),(0,_.jsx)(y,{name:"calendar",color:"#66666"})]}),(0,_.jsxs)("div",{className:"filter_cmp_btn _dsplFlx",style:{"--filter_cmp_btn_color":U?"var(--hrm_palette-color-orange-800)":"var(--hrm_palette-success-fg)","--filter_cmp_btn_bck-color":U?"var(--hrm_palette-color-orange-100)":"var(--hrm_palette-success-100)"},onClick:function(){var n=(0,o.Z)({},(0,u.bh)("comprobante_by_doc"));(0,u.Rz)(g,n),U||(0,u.Rz)(g,I(n)),B(!U)},children:[(0,_.jsx)("div",{className:"lbl",children:U?"En Revision":"Todos"}),(0,_.jsx)(y,{name:U?"alert":"success",color:"#66666"})]}),(0,_.jsx)("div",{className:"flexSpace"})]}),(0,_.jsxs)("div",{className:"accounts_container ",children:[(0,_.jsx)("div",{style:{height:55},children:(0,_.jsx)(j,{})}),(0,u.bh)(g)&&(null===(p=(0,d.tS)((0,u.bh)(g),F))||void 0===p?void 0:p.map((function(n){return(0,_.jsx)(Z,{data:(0,u.bh)(g)[n],elmId:n,openUpdateView:$,handleRefreshAll:L,inReview:U},n)}))),(0,u.bh)(g)&&(0,u._2)((0,u.bh)(g),F).length>F?(0,_.jsxs)("div",{className:"_dsplFlx ",style:{margin:"15px 0 35px"},children:[(0,_.jsx)("div",{className:"flexSpace"}),(0,_.jsx)("p",{className:"group_title addBtn purple",onClick:function(){A((function(n){return n+128}))},children:"Cargar Mas"}),(0,_.jsx)("div",{className:"flexSpace"})]}):null]})]})};var j=function(n){(0,r.Z)(n);var e=(0,i.useState)(!1),t=(0,c.Z)(e,2),a=t[0],s=t[1];return(0,_.jsxs)("div",{className:"header_tbl ".concat(a?"_floating":""),children:[(0,_.jsxs)("div",{className:"_dsplFlx hdr_bar purple",children:[(0,_.jsxs)("div",{className:"_dsplFlx tr_bar_90",children:[(0,_.jsx)("div",{className:" tr_bar_20",children:"Fecha"}),(0,_.jsx)("div",{className:" tr_bar_25",children:"Comprobante"}),(0,_.jsx)("div",{className:" tr_bar_55",children:"Descripcion"})]}),(0,_.jsx)("div",{className:"flexSpace"}),(0,_.jsx)("div",{className:"icon tr_bar_5"})]}),(0,_.jsx)(f.Z,{scrollhandler:function(n){n>170?!a&&s(!0):a&&s(!1)}})]})};function I(n){var e=[];return(0,u._2)(n).map((function(t){var r,a,s=n[t];null!==(r=(0,u.bh)("comp_under_review"))&&void 0!==r&&null!==(a=r.inReview)&&void 0!==a&&a[null===s||void 0===s?void 0:s.comprobanteId]&&e.push(s)})),e}},3588:function(n,e,t){t.d(e,{Eb:function(){return p},N$:function(){return i},Ng:function(){return u},WB:function(){return l},bx:function(){return f},ly:function(){return c},tS:function(){return h}});var r=t(4165),a=t(1413),s=t(5861),o=t(2350),c=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(e){var t,s,c,i,u;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(c=(0,a.Z)({},null===(t=(0,o.bh)((0,o.hQ)()))||void 0===t?void 0:t.all_opera)).params={businessId:null===(s=(0,o.bh)("profileUser"))||void 0===s?void 0:s.businessId},i=(0,o.I7)(c),n.next=5,i;case 5:(u=n.sent)&&!u.error&&((0,o.Rz)("comprobante_list",v(u,"date",1)),(0,o.Rz)("comprobante_by_doc",d(u)),e&&e());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),i=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(e){var t,s,c,i,u;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(c=(0,a.Z)({},null===(t=(0,o.bh)((0,o.hQ)()))||void 0===t?void 0:t.search_opera)).params={businessId:null===(s=(0,o.bh)("profileUser"))||void 0===s?void 0:s.businessId,":search":(0,o.bh)("search_acc_record")},i=(0,o.I7)(c),n.next=5,i;case 5:(u=n.sent)&&!u.error&&((0,o.Rz)("comprobante_list",u),(0,o.Rz)("comprobante_by_doc",d((0,o.jQ)(u))),e&&e());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),u=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(e){var t,s,c,i,u,l,p;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(u=(0,a.Z)({},null===(t=(0,o.bh)((0,o.hQ)()))||void 0===t?void 0:t.search_opera)).params={businessId:null===(s=(0,o.bh)("profileUser"))||void 0===s?void 0:s.businessId,":search":(0,o.bh)("search_acc_record"),":date1":null===(c=(0,o.bh)("date_range_comps"))||void 0===c?void 0:c.initDate,":date2":null===(i=(0,o.bh)("date_range_comps"))||void 0===i?void 0:i.lastDate},u.queryString="date > :date1 AND date < :date2",l=(0,o.I7)(u),n.next=6,l;case 6:(p=n.sent)&&!p.error&&((0,o.Rz)("comprobante_list",p),(0,o.Rz)("comprobante_by_doc",d((0,o.jQ)(p))),e&&e());case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),l=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(e,t){var c,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=[],e.map((function(n){var e,t,r=(0,a.Z)({},null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.delete_opera);r.params={businessId:null===(t=(0,o.bh)("profileUser"))||void 0===t?void 0:t.businessId,operationId:n.operationId},c.push(r)})),i=c.map(function(){var n=(0,s.Z)((0,r.Z)().mark((function n(e){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=(0,o.I7)(e),n.next=3,t;case 3:n.sent;case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),n.next=5,Promise.all(i);case 5:t&&t();case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();function d(n){var e={};return n.length>0?n.map((function(n){var t=new Date(n.date).getTime()+"_"+n.comprobanteId;if(!e[t]){e[t]={};["date","description","entryName","comprobanteId"].forEach((function(r){e[t][r]=n[r]})),e[t].amount=0,e[t].operations=[]}n.type&&(e[t].amount+="credit"===n.type?(0,o.Zv)(n.amount,2):0,e[t].operations.push(function(n){var e,t,r={};r.account=null===(e=(0,o.bh)("account_ids"))||void 0===e?void 0:e[n.account],r.sub_account=null===(t=(0,o.bh)("sub_account_ids"))||void 0===t?void 0:t[n.subAccount],r.comprobanteId=n.comprobanteId,r.operationId=n.operationId,r.document=n.document,r.type=n.type;var a=(0,o.Zv)(n.amount,2);"credit"===n.type?(r.debit=0,r.credit=a):"debit"===n.type&&(r.credit=0,r.debit=a);return r}(n)))})):e=null,e}var p=function(n){return(0,o.MV)("sortComprobantesByType",[n],(function(){var e="type";return n&&n.sort((function(n,t){var r=n[e],a=t[e];return r===a?t[a]-n[r]:a>r?1:-1}))}))},v=function(n,e,t){return n&&n.sort((function(n,r){var a=n[e],s=r[e];return a<s?t?-1:1:a>s?t?1:-1:0}))},h=function(n,e){return(0,o.MV)("rangeArr",[n,e],(function(){return n?(0,o._2)(n).slice(0,e):[]}))};function f(){return(0,o.bh)("comprobante_list").map((function(n){var e,t,r=null===(e=(0,o.bh)("account_ids"))||void 0===e?void 0:e[n.account],a=null===(t=(0,o.bh)("sub_account_ids"))||void 0===t?void 0:t[n.subAccount],s={fecha:(0,o.Gv)(n.date),documento:n.document,comprobante:n.comprobanteId,tipo_cuenta:n.type,importe:n.amount,cuenta:r.code+"",nombre:r.name};return a&&a.subAccount&&(s.sub_cuenta=a.subAccount,s.nombre_sub_cuenta=a.subAccountName),s}))}},1e3:function(){},4296:function(n,e,t){function r(n){if(null==n)throw new TypeError("Cannot destructure "+n)}t.d(e,{Z:function(){return r}})}}]);
//# sourceMappingURL=7802.2fb44ed4.chunk.js.map