"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[7802],{3728:function(e,n,t){t.d(n,{NA:function(){return u},g5:function(){return i},ph:function(){return c},yq:function(){return o}});var r=t(4165),a=t(5861),s=t(2350),c=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a,c,o,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=null===(t=(0,s.bh)((0,s.hQ)()))||void 0===t?void 0:t.all_entries).params={businessId:null===(a=(0,s.bh)("profileUser"))||void 0===a?void 0:a.businessId},o=(0,s.I7)(c),e.next=5,o;case 5:(i=e.sent)&&((0,s.Rz)("entries_list",i),(0,s.Rz)("entries_ids",(0,s.ME)(i,"accountingEntryId")),n&&n());case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),o=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a,c,o,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=null===(t=(0,s.bh)((0,s.hQ)()))||void 0===t?void 0:t.search_entries).params={businessId:null===(a=(0,s.bh)("profileUser"))||void 0===a?void 0:a.businessId,":search":(0,s.bh)("search_entry_qry")},o=(0,s.I7)(c),e.next=5,o;case 5:(i=e.sent)&&((0,s.Rz)("entries_list",i),n&&n());case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t){var a,c,o,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=null===(a=(0,s.bh)((0,s.hQ)()))||void 0===a?void 0:a.delete_entries).params={businessId:null===(c=(0,s.bh)("profileUser"))||void 0===c?void 0:c.businessId,accountingEntryId:n},i=(0,s.I7)(o),e.next=5,i;case 5:e.sent&&t&&t();case 7:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),u=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,s.I7)({query:"getLastSequence"}),e.next=3,t;case 3:if(!(a=e.sent)){e.next=6;break}return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},5686:function(e,n,t){t.r(n);var r=t(4296),a=t(4165),s=t(5861),c=t(1413),o=t(9439),i=t(2791),u=t(2350),l=t(2647),d=(t(1e3),t(3588)),p=t(2692),v=t(4050),h=t(7689),f=t(5281),m=t(9760),_=(t(3728),t(184)),b=(0,l.h0)(),x=(0,l.Vg)(),Z=(0,p.LO)(),y=(0,l.PU)(),j="coll2list";n.default=function(e){e.data,e.elmId,e.updObs;var n,t,r,l,p,f=(0,i.useState)(!1),I=(0,o.Z)(f,2),w=I[0],k=I[1],R=(0,i.useState)(0),z=(0,o.Z)(R,2),C=(z[0],z[1]),S=(0,i.useState)(128),D=(0,o.Z)(S,2),F=D[0],E=D[1],A=(0,i.useState)(!1),Q=(0,o.Z)(A,2),U=Q[0],B=Q[1],M=(0,i.useState)(!1),T=(0,o.Z)(M,2),q=T[0],V=T[1],O=(0,i.useState)(!1),H=(0,o.Z)(O,2),L=H[0],$=H[1],J=(0,h.TH)(),P=(0,h.s0)();(0,i.useEffect)((function(){setTimeout((function(){var e,n,t=null===(e=J.search)||void 0===e||null===(n=e.split("?"))||void 0===n?void 0:n[1],r=(0,u.mB)(t);null!==r&&void 0!==r&&r.cId&&((0,u.Rz)("search_acc_record",null===r||void 0===r?void 0:r.cId),(0,d.N$)(G)),(0,v.Ht)("comp_under_review","comp_under_review",X)}),350)}),[J]),(0,i.useEffect)((function(){w||(k(!0),C((0,u.M5)()),(0,v._0)(X),(0,v.ZX)(K))}));var W=function(){},G=function(){var e=(0,c.Z)({},(0,u.bh)("comprobante_by_doc"));(0,u.Rz)(j,e),U&&(0,u.Rz)(j,N(e)),X()},K=function(e){G(),(0,u.Rz)("comprobante_list",null),(0,u.Rz)("comprobante_by_doc",null),$(!1)},X=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(n,t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C((0,u.M5)()),$(!1);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Y=function(e){null!==e&&void 0!==e&&e.initDate&&null!==e&&void 0!==e&&e.lastDate&&(0,u.Rz)("date_range_comps",e),(0,d.Ng)(G)},ee=(null===(n=(0,u.bh)("date_range_comps"))||void 0===n?void 0:n.initDate)&&(0,u.sJ)(null===(t=(0,u.bh)("date_range_comps"))||void 0===t?void 0:t.initDate)+"-"+(0,u.sJ)(null===(r=(0,u.bh)("date_range_comps"))||void 0===r?void 0:r.lastDate);return(0,_.jsxs)("div",{className:"",children:[(0,_.jsxs)("div",{className:"accounts_header",children:[(0,_.jsx)("h2",{children:"Comprobantes"}),(0,_.jsxs)("div",{className:"_dsplFlx ",children:[(0,_.jsx)("p",{className:"group_title addBtn purple",onClick:function(e){P({pathname:"/entries"})},children:"Agregar Comprobantes"}),(0,_.jsx)("p",{className:"group_title addBtn purple",onClick:function(){(0,u.eY)("export_comprobantes_list_"+(0,u.M5)()+".csv",(0,d.bx)())},children:"Exportar a CSV"})]}),(0,_.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,_.jsx)(x,{placeholder:"Buscar ....",width:360,obs:C,fetchData:function(e){$(!0),E((function(e){return 128})),(0,d.N$)(G)},loading:L,change:function(e){!L&&$(!0)},callempty:K,keyFlds:"search_acc_record"}),(0,_.jsx)("div",{className:"flexSpace"}),(0,_.jsxs)("div",{className:"_dsplFlx ",children:[(0,_.jsx)("div",{className:"total_comprobante_title",children:"No de Comprobantes:"}),(0,_.jsx)("div",{className:"total_comprobante gray",children:(0,_.jsx)("span",{children:null===(l=(0,u._2)((0,u.bh)(j)))||void 0===l?void 0:l.length})})]})]})]}),(0,_.jsxs)("div",{className:"_dsplFlx ",style:{marginBottom:14,maxWidth:500},children:[(0,_.jsxs)("div",{className:"filter_date_btn _dsplFlx",onClick:function(){var e,n,t={zIndex:950,height:"80vh",props:{minHeight:"1vh",overlay:!0}};t.content=(0,_.jsx)(b,{onConfirm:Y,init:null===(e=(0,u.bh)("date_range_comps"))||void 0===e?void 0:e.initDate,last:null===(n=(0,u.bh)("date_range_comps"))||void 0===n?void 0:n.lastDate,isRange:!0}),(0,m.OpenModal)(t)},children:[(0,_.jsx)("div",{className:"lbl date",children:ee||"Fecha"}),(0,_.jsx)(y,{name:"calendar",color:"#66666"})]}),(0,_.jsxs)("div",{className:"filter_cmp_btn _dsplFlx",style:{"--filter_cmp_btn_color":U?"var(--hrm_palette-color-orange-800)":"var(--hrm_palette-success-fg)","--filter_cmp_btn_bck-color":U?"var(--hrm_palette-color-orange-100)":"var(--hrm_palette-success-100)"},onClick:function(){var e=(0,c.Z)({},(0,u.bh)("comprobante_by_doc"));(0,u.Rz)(j,e),U||(0,u.Rz)(j,N(e)),B(!U)},children:[(0,_.jsx)("div",{className:"lbl",children:U?"En Revision":"Todos"}),(0,_.jsx)(y,{name:U?"alert":"success",color:"#66666"})]}),(0,_.jsxs)("div",{className:"filter_cmp_btn _dsplFlx",style:{"--filter_cmp_btn_color":q?"var( --hrm_palette-selected-nav-text)":"var(--hrm_palette-success-fg)","--filter_cmp_btn_bck-color":q?"var( --hrm_palette-selected-nav-text-100)":"var(--hrm_palette-success-100)",marginLeft:12},onClick:function(){return V(!q)},children:[(0,_.jsx)("div",{className:"lbl",children:q?"Contiene errors":"OK"}),(0,_.jsx)(y,{name:q?"alert":"success",color:"#66666"})]}),(0,_.jsx)("div",{className:"flexSpace"})]}),(0,_.jsxs)("div",{className:"accounts_container ",children:[(0,_.jsx)("div",{style:{height:55},children:(0,_.jsx)(g,{})}),(0,u.bh)(j)&&(null===(p=(0,d.tS)((0,u.bh)(j),F))||void 0===p?void 0:p.map((function(e){return(0,_.jsx)(Z,{data:(0,u.bh)(j)[e],elmId:e,openUpdateView:W,handleRefreshAll:K,inReview:U,hasError:q},e)}))),(0,u.bh)(j)&&(0,u._2)((0,u.bh)(j),F).length>F?(0,_.jsxs)("div",{className:"_dsplFlx ",style:{margin:"15px 0 35px"},children:[(0,_.jsx)("div",{className:"flexSpace"}),(0,_.jsx)("p",{className:"group_title addBtn purple",onClick:function(){E((function(e){return e+128}))},children:"Cargar Mas"}),(0,_.jsx)("div",{className:"flexSpace"})]}):null]})]})};var g=function(e){(0,r.Z)(e);var n=(0,i.useState)(!1),t=(0,o.Z)(n,2),a=t[0],s=t[1];return(0,_.jsxs)("div",{className:"header_tbl ".concat(a?"_floating":""),children:[(0,_.jsxs)("div",{className:"_dsplFlx hdr_bar purple",children:[(0,_.jsxs)("div",{className:"_dsplFlx tr_bar_90",children:[(0,_.jsx)("div",{className:" tr_bar_20",children:"Fecha"}),(0,_.jsx)("div",{className:" tr_bar_25",children:"Comprobante"}),(0,_.jsx)("div",{className:" tr_bar_55",children:"Descripcion"})]}),(0,_.jsx)("div",{className:"flexSpace"}),(0,_.jsx)("div",{className:"icon tr_bar_5"})]}),(0,_.jsx)(f.Z,{scrollhandler:function(e){e>170?!a&&s(!0):a&&s(!1)}})]})};function N(e){var n=[];return(0,u._2)(e).map((function(t){var r,a,s=e[t];null!==(r=(0,u.bh)("comp_under_review"))&&void 0!==r&&null!==(a=r.inReview)&&void 0!==a&&a[null===s||void 0===s?void 0:s.comprobanteId]&&n.push(s)})),n}},3588:function(e,n,t){t.d(n,{Eb:function(){return p},N$:function(){return i},Ng:function(){return u},WB:function(){return l},bx:function(){return f},ly:function(){return o},tS:function(){return h}});var r=t(4165),a=t(1413),s=t(5861),c=t(2350),o=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t,s,o,i,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=(0,a.Z)({},null===(t=(0,c.bh)((0,c.hQ)()))||void 0===t?void 0:t.all_opera)).params={businessId:null===(s=(0,c.bh)("profileUser"))||void 0===s?void 0:s.businessId},i=(0,c.I7)(o),e.next=5,i;case 5:(u=e.sent)&&!u.error&&((0,c.Rz)("comprobante_list",v(u,"date",1)),(0,c.Rz)("comprobante_by_doc",d(u)),n&&n());case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t,s,o,i,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=(0,a.Z)({},null===(t=(0,c.bh)((0,c.hQ)()))||void 0===t?void 0:t.search_opera)).params={businessId:null===(s=(0,c.bh)("profileUser"))||void 0===s?void 0:s.businessId,":search":(0,c.bh)("search_acc_record")},i=(0,c.I7)(o),e.next=5,i;case 5:(u=e.sent)&&!u.error&&((0,c.Rz)("comprobante_list",u),(0,c.Rz)("comprobante_by_doc",d((0,c.jQ)(u))),n&&n());case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),u=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t,s,o,i,u,l,p;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(u=(0,a.Z)({},null===(t=(0,c.bh)((0,c.hQ)()))||void 0===t?void 0:t.search_opera)).params={businessId:null===(s=(0,c.bh)("profileUser"))||void 0===s?void 0:s.businessId,":search":(0,c.bh)("search_acc_record"),":date1":null===(o=(0,c.bh)("date_range_comps"))||void 0===o?void 0:o.initDate,":date2":null===(i=(0,c.bh)("date_range_comps"))||void 0===i?void 0:i.lastDate},u.queryString="date > :date1 AND date < :date2",l=(0,c.I7)(u),e.next=6,l;case 6:(p=e.sent)&&!p.error&&((0,c.Rz)("comprobante_list",p),(0,c.Rz)("comprobante_by_doc",d((0,c.jQ)(p))),n&&n());case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n,t){var o,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],n.map((function(e){var n,t,r=(0,a.Z)({},null===(n=(0,c.bh)((0,c.hQ)()))||void 0===n?void 0:n.delete_opera);r.params={businessId:null===(t=(0,c.bh)("profileUser"))||void 0===t?void 0:t.businessId,operationId:e.operationId},o.push(r)})),i=o.map(function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.I7)(n),e.next=3,t;case 3:e.sent;case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=5,Promise.all(i);case 5:t&&t();case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();function d(e){var n={};return e.length>0?e.map((function(e){var t=new Date(e.date).getTime()+"_"+e.comprobanteId;if(!n[t]){n[t]={};["date","description","entryName","comprobanteId"].forEach((function(r){n[t][r]=e[r]})),n[t].amount=0,n[t].balance=0,n[t].operations=[]}e.type&&(n[t].balance=1*(0,c.Zv)(n[t].balance,2)+("credit"===e.type?-1*(0,c.Zv)(e.amount,2):1*(0,c.Zv)(e.amount,2)),n[t].operations.push(function(e){var n,t,r={};r.account=null===(n=(0,c.bh)("account_ids"))||void 0===n?void 0:n[e.account],r.sub_account=null===(t=(0,c.bh)("sub_account_ids"))||void 0===t?void 0:t[e.subAccount],r.comprobanteId=e.comprobanteId,r.operationId=e.operationId,r.document=e.document,r.type=e.type;var a=(0,c.Zv)(e.amount,2);"credit"===e.type?(r.debit=0,r.credit=a):"debit"===e.type&&(r.credit=0,r.debit=a);return r}(e)))})):n=null,n}var p=function(e){return(0,c.MV)("sortComprobantesByType",[e],(function(){var n="type";return e&&e.sort((function(e,t){var r=e[n],a=t[n];return r===a?t[a]-e[r]:a>r?1:-1}))}))},v=function(e,n,t){return e&&e.sort((function(e,r){var a=e[n],s=r[n];return a<s?t?-1:1:a>s?t?1:-1:0}))},h=function(e,n){return(0,c.MV)("rangeArr",[e,n],(function(){return e?(0,c._2)(e).slice(0,n):[]}))};function f(){return(0,c.bh)("comprobante_list").map((function(e){var n,t,r=null===(n=(0,c.bh)("account_ids"))||void 0===n?void 0:n[e.account],a=null===(t=(0,c.bh)("sub_account_ids"))||void 0===t?void 0:t[e.subAccount],s={fecha:(0,c.Gv)(e.date),documento:e.document,comprobante:e.comprobanteId,tipo_cuenta:e.type,importe:e.amount,cuenta:r.code+"",nombre:r.name};return a&&a.subAccount&&(s.sub_cuenta=a.subAccount,s.nombre_sub_cuenta=a.subAccountName),s}))}},1e3:function(){},4296:function(e,n,t){function r(e){if(null==e)throw new TypeError("Cannot destructure "+e)}t.d(n,{Z:function(){return r}})}}]);
//# sourceMappingURL=7802.39f24e46.chunk.js.map