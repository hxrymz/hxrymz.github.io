"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[7802],{5686:function(e,n,t){t.r(n);var r=t(4296),a=t(4165),o=t(5861),c=t(1413),s=t(9439),i=t(2791),l=t(2350),u=t(2647),d=(t(1e3),t(3588)),p=t(2692),v=t(4050),h=t(7689),m=t(5281),_=t(9760),f=t(184),b=(0,u.h0)(),x=(0,u.Vg)(),j=(0,p.LO)(),N=(0,u.PU)(),g="coll2list";n.default=function(e){e.data,e.elmId,e.updObs;var n,t,r,u,p,m=(0,i.useState)(!1),I=(0,s.Z)(m,2),w=I[0],R=I[1],k=(0,i.useState)(0),C=(0,s.Z)(k,2),z=(C[0],C[1]),S=(0,i.useState)(128),D=(0,s.Z)(S,2),F=D[0],A=D[1],B=(0,i.useState)(!0),E=(0,s.Z)(B,2),M=E[0],T=E[1],Q=(0,i.useState)(!1),U=(0,s.Z)(Q,2),V=U[0],H=U[1],O=(0,h.TH)(),$=(0,h.s0)();(0,i.useEffect)((function(){(0,v.Ht)("comp_under_review","comp_under_review",q),setTimeout((function(){var e,n,t=null===(e=O.search)||void 0===e||null===(n=e.split("?"))||void 0===n?void 0:n[1],r=(0,l.mB)(t);null!==r&&void 0!==r&&r.cId&&((0,l.Rz)("search_acc_record",null===r||void 0===r?void 0:r.cId),(0,d.N$)(q))}),350)}),[O]),(0,i.useEffect)((function(){w||(R(!0),z((0,l.M5)()),(0,v._0)(q),(0,v.ZX)(W))}));var J=function(){},P=function(){var e=(0,c.Z)({},(0,l.bh)("comprobante_by_doc"));(0,l.Rz)(g,e),M&&(0,l.Rz)(g,y(e)),q()},W=function(e){(0,l.Rz)("comprobante_list",null),(0,l.Rz)("comprobante_by_doc",null),H(!1)},q=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n,t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:z((0,l.M5)()),H(!1);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),G=function(e){null!==e&&void 0!==e&&e.initDate&&null!==e&&void 0!==e&&e.lastDate&&(0,l.Rz)("date_range_comps",e),(0,d.Ng)(P)},L=(null===(n=(0,l.bh)("date_range_comps"))||void 0===n?void 0:n.initDate)&&(0,l.sJ)(null===(t=(0,l.bh)("date_range_comps"))||void 0===t?void 0:t.initDate)+"-"+(0,l.sJ)(null===(r=(0,l.bh)("date_range_comps"))||void 0===r?void 0:r.lastDate);return(0,f.jsxs)("div",{className:"",children:[(0,f.jsxs)("div",{className:"accounts_header",children:[(0,f.jsx)("h2",{children:"Comprobantes"}),(0,f.jsxs)("div",{className:"_dsplFlx ",children:[(0,f.jsx)("p",{className:"group_title addBtn purple",onClick:function(e){$({pathname:"/entries"})},children:"Agregar Comprobantes"}),(0,f.jsx)("p",{className:"group_title addBtn purple",onClick:function(){(0,l.eY)("export_comprobantes_list_"+(0,l.M5)()+".csv",(0,d.bx)())},children:"Exportar a CSV"})]}),(0,f.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,f.jsx)(x,{placeholder:"Buscar ....",width:360,obs:z,fetchData:function(e){H(!0),A((function(e){return 128})),(0,d.N$)(P)},loading:V,change:function(e){!V&&H(!0)},callempty:W,keyFlds:"search_acc_record"}),(0,f.jsx)("div",{className:"flexSpace"}),(0,f.jsxs)("div",{className:"_dsplFlx ",children:[(0,f.jsx)("div",{className:"total_comprobante_title",children:"No de Comprobantes:"}),(0,f.jsx)("div",{className:"total_comprobante gray",children:(0,f.jsx)("span",{children:null===(u=(0,l._2)((0,l.bh)(g)))||void 0===u?void 0:u.length})})]})]})]}),(0,f.jsxs)("div",{className:"_dsplFlx ",style:{marginBottom:14,maxWidth:500},children:[(0,f.jsxs)("div",{className:"filter_date_btn _dsplFlx",onClick:function(){var e,n,t={zIndex:950,height:"80vh",props:{minHeight:"1vh",overlay:!0}};t.content=(0,f.jsx)(b,{onConfirm:G,init:null===(e=(0,l.bh)("date_range_comps"))||void 0===e?void 0:e.initDate,last:null===(n=(0,l.bh)("date_range_comps"))||void 0===n?void 0:n.lastDate,isRange:!0}),(0,_.OpenModal)(t)},children:[(0,f.jsx)("div",{className:"lbl date",children:L||"Fecha"}),(0,f.jsx)(N,{name:"calendar",color:"#66666"})]}),(0,f.jsxs)("div",{className:"filter_cmp_btn _dsplFlx",style:{"--filter_cmp_btn_color":M?"var(--hrm_palette-color-orange-800)":"var(--hrm_palette-success-fg)","--filter_cmp_btn_bck-color":M?"var(--hrm_palette-color-orange-100)":"var(--hrm_palette-success-100)"},onClick:function(){var e=(0,c.Z)({},(0,l.bh)("comprobante_by_doc"));(0,l.Rz)(g,e),M||(0,l.Rz)(g,y(e)),T(!M)},children:[(0,f.jsx)("div",{className:"lbl",children:M?"En Revision":"Todos"}),(0,f.jsx)(N,{name:M?"alert":"success",color:"#66666"})]}),(0,f.jsx)("div",{className:"flexSpace"})]}),(0,f.jsxs)("div",{className:"accounts_container ",children:[(0,f.jsx)("div",{style:{height:55},children:(0,f.jsx)(Z,{})}),(0,l.bh)(g)&&(null===(p=(0,d.tS)((0,l.bh)(g),F))||void 0===p?void 0:p.map((function(e){return(0,f.jsx)(j,{data:(0,l.bh)(g)[e],elmId:e,openUpdateView:J,handleRefreshAll:W,inReview:M},e)}))),(0,l.bh)(g)&&(0,l._2)((0,l.bh)(g),F).length>F?(0,f.jsxs)("div",{className:"_dsplFlx ",style:{margin:"15px 0 35px"},children:[(0,f.jsx)("div",{className:"flexSpace"}),(0,f.jsx)("p",{className:"group_title addBtn purple",onClick:function(){A((function(e){return e+128}))},children:"Cargar Mas"}),(0,f.jsx)("div",{className:"flexSpace"})]}):null]})]})};var Z=function(e){(0,r.Z)(e);var n=(0,i.useState)(!1),t=(0,s.Z)(n,2),a=t[0],o=t[1];return(0,f.jsxs)("div",{className:"header_tbl ".concat(a?"_floating":""),children:[(0,f.jsxs)("div",{className:"_dsplFlx hdr_bar purple",children:[(0,f.jsxs)("div",{className:"_dsplFlx tr_bar_90",children:[(0,f.jsx)("div",{className:" tr_bar_20",children:"Fecha"}),(0,f.jsx)("div",{className:" tr_bar_25",children:"Comprobante"}),(0,f.jsx)("div",{className:" tr_bar_55",children:"Descripcion"})]}),(0,f.jsx)("div",{className:"flexSpace"}),(0,f.jsx)("div",{className:"icon tr_bar_5"})]}),(0,f.jsx)(m.Z,{scrollhandler:function(e){e>170?!a&&o(!0):a&&o(!1)}})]})};function y(e){var n=[];return(0,l._2)(e).map((function(t){var r,a,o=e[t];null!==(r=(0,l.bh)("comp_under_review"))&&void 0!==r&&null!==(a=r.inReview)&&void 0!==a&&a[null===o||void 0===o?void 0:o.comprobanteId]&&n.push(o)})),n}},3588:function(e,n,t){t.d(n,{Eb:function(){return p},N$:function(){return i},Ng:function(){return l},WB:function(){return u},bx:function(){return m},ly:function(){return s},tS:function(){return h}});var r=t(4165),a=t(1413),o=t(5861),c=t(2350),s=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t,o,s,i,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=(0,a.Z)({},null===(t=(0,c.bh)((0,c.hQ)()))||void 0===t?void 0:t.all_opera)).params={businessId:null===(o=(0,c.bh)("profileUser"))||void 0===o?void 0:o.businessId},i=(0,c.I7)(s),e.next=5,i;case 5:(l=e.sent)&&!l.error&&((0,c.Rz)("comprobante_list",v(l,"date",1)),(0,c.Rz)("comprobante_by_doc",d(l)),n&&n());case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t,o,s,i,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=(0,a.Z)({},null===(t=(0,c.bh)((0,c.hQ)()))||void 0===t?void 0:t.search_opera)).params={businessId:null===(o=(0,c.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search":(0,c.bh)("search_acc_record")},i=(0,c.I7)(s),e.next=5,i;case 5:(l=e.sent)&&!l.error&&((0,c.Rz)("comprobante_list",l),(0,c.Rz)("comprobante_by_doc",d((0,c.jQ)(l))),n&&n());case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t,o,s,i,l,u,p;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(l=(0,a.Z)({},null===(t=(0,c.bh)((0,c.hQ)()))||void 0===t?void 0:t.search_opera)).params={businessId:null===(o=(0,c.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search":(0,c.bh)("search_acc_record"),":date1":null===(s=(0,c.bh)("date_range_comps"))||void 0===s?void 0:s.initDate,":date2":null===(i=(0,c.bh)("date_range_comps"))||void 0===i?void 0:i.lastDate},l.queryString="date > :date1 AND date < :date2",u=(0,c.I7)(l),e.next=6,u;case 6:(p=e.sent)&&!p.error&&((0,c.Rz)("comprobante_list",p),(0,c.Rz)("comprobante_by_doc",d((0,c.jQ)(p))),n&&n());case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),u=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n,t){var s,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],n.map((function(e){var n,t,r=(0,a.Z)({},null===(n=(0,c.bh)((0,c.hQ)()))||void 0===n?void 0:n.delete_opera);r.params={businessId:null===(t=(0,c.bh)("profileUser"))||void 0===t?void 0:t.businessId,operationId:e.operationId},s.push(r)})),i=s.map(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.I7)(n),e.next=3,t;case 3:e.sent;case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=5,Promise.all(i);case 5:t&&t();case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();function d(e){var n={};return e.length>0?e.map((function(e){var t=new Date(e.date).getTime()+"_"+e.comprobanteId;if(!n[t]){n[t]={};["date","description","entryName","comprobanteId"].forEach((function(r){n[t][r]=e[r]})),n[t].amount=0,n[t].operations=[]}e.type&&(n[t].amount+="credit"===e.type?(0,c.Zv)(e.amount,2):0,n[t].operations.push(function(e){var n,t,r={};r.account=null===(n=(0,c.bh)("account_ids"))||void 0===n?void 0:n[e.account],r.sub_account=null===(t=(0,c.bh)("sub_account_ids"))||void 0===t?void 0:t[e.subAccount],r.comprobanteId=e.comprobanteId,r.operationId=e.operationId,r.document=e.document,r.type=e.type;var a=(0,c.Zv)(e.amount,2);"credit"===e.type?(r.debit=0,r.credit=a):"debit"===e.type&&(r.credit=0,r.debit=a);return r}(e)))})):n=null,n}var p=function(e){return(0,c.MV)("sortComprobantesByType",[e],(function(){var n="type";return e&&e.sort((function(e,t){var r=e[n],a=t[n];return r===a?t[a]-e[r]:a>r?1:-1}))}))},v=function(e,n,t){return e&&e.sort((function(e,r){var a=e[n],o=r[n];return a<o?t?-1:1:a>o?t?1:-1:0}))},h=function(e,n){return(0,c.MV)("rangeArr",[e,n],(function(){return e?(0,c._2)(e).slice(0,n):[]}))};function m(){return(0,c.bh)("comprobante_list").map((function(e){var n,t,r=null===(n=(0,c.bh)("account_ids"))||void 0===n?void 0:n[e.account],a=null===(t=(0,c.bh)("sub_account_ids"))||void 0===t?void 0:t[e.subAccount],o={fecha:(0,c.Gv)(e.date),documento:e.document,comprobante:e.comprobanteId,tipo_cuenta:e.type,importe:e.amount,cuenta:r.code+"",nombre:r.name};return a&&a.subAccount&&(o.sub_cuenta=a.subAccount,o.nombre_sub_cuenta=a.subAccountName),o}))}},1e3:function(){},4296:function(e,n,t){function r(e){if(null==e)throw new TypeError("Cannot destructure "+e)}t.d(n,{Z:function(){return r}})}}]);
//# sourceMappingURL=7802.a07f32aa.chunk.js.map