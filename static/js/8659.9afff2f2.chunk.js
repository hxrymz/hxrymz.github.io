"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[8659,9760],{9760:(e,s,l)=>{l.r(s),l.d(s,{CloseModal:()=>c,OpenModal:()=>r,default:()=>d});var t=l(2791),o=l(5408),i=l(2350),a=l(184);const n="listDialog_mdh392",d=()=>{const e=(0,i.bh)("listDialog")||{};(0,o.Z)(n);let s=Object.keys(e);return(0,a.jsx)(a.Fragment,{children:s.map(((s,l)=>{let o=e[s];if(o&&o.visible){let e={};o.height&&(e.heigth=o.height),o.width,o.zIndex&&(e.zIndex=o.zIndex-1);let l={zIndex:o.zIndex},i=null,n=o.data;return o.content&&(i=t.cloneElement(o.content,{data:n})),(0,a.jsxs)("div",{className:"ltr-1kbnjow",style:e,children:[(0,a.jsx)("div",{className:"ltr-hoe9xz",children:(0,a.jsx)("div",{className:"ltr-1wao6ny",style:l,id:s,children:i})}),o.data.overlay?(0,a.jsx)("div",{className:"DialogHRMOverlay ".concat(o.visible?"active":""),onClick:()=>{var e;e=s,document.getElementsByTagName("html")[0].classList.remove("has-level-two"),c({id:e})}}):null]},s)}}))})},r=e=>{let s=(0,i.bh)("listDialog")||{},l=(0,i.M5)();s[l]||(s[l]={}),s[l].visible=!0;let t={};e.props?(t=e.props,t.modalID=l):t.modalID=l;let o=document.getElementsByTagName("body")[0];null!==o&&void 0!==o&&o.style&&(o.style.overflowY="hidden"),s[l].isView=e.isView,s[l].observeResize=e.observeResize,s[l].observeResize&&(s[l].observeInterval=setInterval((()=>{let e=document.querySelector("[dialog-key-id='".concat(l,"']")),t=e&&e.getBoundingClientRect();t&&(t.width===s[l].width&&t.height===s[l].height||(s[l].height=t.height+10,s[l].width=t.width,(0,i.Rz)("listDialog",s),(0,i.wt)(n)))}),200)),s[l].display=!0,e.zIndex&&(s[l].zIndex=e.zIndex),e.height&&(s[l].height=e.height),e.width&&(s[l].width=e.width),e.content&&(s[l].content=e.content),s[l].data=t,(0,i.Rz)("listDialog",s),(0,i.wt)(n),setTimeout((()=>{document.getElementsByTagName("html")[0].classList.add("has-level-two"),(0,i.Rz)("modalOpen",l),(0,i.wt)(n)}),125)},c=e=>{let s=(0,i.bh)("listDialog")||{},l=e.id;if(s[l]){var t,o,a;s[l].observeResize&&s[l].observeInterval&&clearInterval(s[l].observeInterval),s[l].display=!1,null===(t=s[l])||void 0===t||null===(o=t.data)||void 0===o||null===(a=o.closeEvent)||void 0===a||a.call(o),(0,i.Rz)("listDialog",s),delete s[l],document.getElementsByTagName("body")[0].style.overflowY=null,(0,i.wt)(n),setTimeout((()=>{delete s[l],document.getElementsByTagName("html")[0].classList.remove("has-level-two"),(0,i.Rz)("modalOpen",null)}),750)}}},8659:(e,s,l)=>{l.r(s),l.d(s,{default:()=>x});var t=l(2791),o=l(2350),i=l(2647),a=l(9760),n=(l(7889),l(24)),d=l(713),r=l(4050),c=l(8779),v=l(7852),h=l(184);const m=(0,i.PU)(),u=(0,n.kZ)(),p=e=>{var s;let{data:l,handleRefreshAll:i}=e;const[n,r]=(0,t.useState)(!1),[p,b]=(0,t.useState)(0);(0,t.useEffect)((()=>{n||(r(!0),b((0,o.M5)()))}),[n]);const _=()=>{b((0,o.M5)())},y=()=>{(0,d.QJ)(_)},x=()=>{};(0,d.Zj)(null===(s=(0,o.bh)("sub_movement_group"))||void 0===s?void 0:s[l.movementId],"subProduct");return(0,h.jsx)("div",{className:"item_acc",children:(0,h.jsxs)("div",{className:"_dsplFlx item_box movement_header",children:[(0,h.jsxs)("div",{className:"_dsplFlx  tr_bar tr_bar_70",onClick:async()=>{},children:[(0,h.jsx)("div",{className:"name tr_bar tr_bar_30",children:(0,o.sJ)(null===l||void 0===l?void 0:l.date)}),(0,h.jsx)("div",{className:"code tr_bar tr_bar_25",style:{marginLeft:14},children:null===l||void 0===l?void 0:l.comprobanteId}),(0,h.jsx)("div",{className:"code tr_bar tr_bar_20",style:{marginLeft:14,textAlign:"right",color:(null===l||void 0===l?void 0:l.amount)<0?"#c62828":""},children:(1*(null===l||void 0===l?void 0:l.amount)).toFixed(2)}),(0,h.jsx)("div",{className:"cod tr_bar tr_bar_40",style:{marginLeft:14},children:null===l||void 0===l?void 0:l.document})]}),(0,h.jsx)("div",{className:"flexSpace"}),(0,h.jsx)("div",{className:" addSbAcc purple",onClick:()=>(e=>{(0,o.Rz)("view_product_entry_comprobante",l);let s={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};s.content=(0,h.jsx)(u,{confirm:y,item:l}),(0,a.OpenModal)(s)})(),children:"Details"}),(0,o.I0)()?(0,h.jsx)("div",{className:"icon",style:{marginLeft:19},onClick:()=>{let e=(0,o.bh)("lastTimeCallModal")||0;if((0,o.I0)()){if(Date.now()>e){(0,o.Rz)("lastTimeCallModal",Date.now()+320);let e={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};e.content=(0,h.jsx)(c.Z,{label:"Eliminar Movimiento",confirm:x,item:l}),(0,a.OpenModal)(e)}}else{let e={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};e.content=(0,h.jsx)(v.Z,{}),(0,a.OpenModal)(e)}},children:(0,h.jsx)(m,{name:"outline_delete",color:"#c62828"})}):null]})})},b=(0,i.Vg)(),_=(0,n.$d)(),y=(0,n.lA)(),x=e=>{var s,l;let{data:i,elmId:n,updObs:c}=e;const[v,m]=(0,t.useState)(!1),[u,x]=(0,t.useState)(0),[I,g]=(0,t.useState)(!1);(0,t.useEffect)((()=>{v||((0,o.Rz)("movements_list",[]),(0,o.Rz)("movements_ids",{}),(0,o.Rz)("searchMovQry",null),m(!0),x((0,o.M5)()),(0,d.$P)(z),(0,r.Ht)("global_accounts","global_account_params",c))}));const f=()=>{},j=e=>{(0,d.$P)(z)},z=async(e,s)=>{x((0,o.M5)()),g(!1)};return(0,h.jsxs)("div",{className:"",children:[(0,h.jsxs)("div",{className:"accounts_header",children:[(0,h.jsx)("h2",{children:"Movements"}),(0,h.jsxs)("div",{className:"_dsplFlx ",children:[(0,o.I0)()?(0,h.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>{let e={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,h.jsx)(_,{}),(0,a.OpenModal)(e)},children:"Entradas"}):null,(0,o.I0)()?(0,h.jsx)("p",{className:"btn_lkjh addBtn purple",onClick:()=>{let e={zIndex:450,height:"80vh",props:{minHeight:"1vh",overlay:!0}};e.content=(0,h.jsx)(y,{}),(0,a.OpenModal)(e)},children:"Salidas"}):null]})]}),(0,h.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:14},children:[(0,h.jsx)(b,{placeholder:"Buscar ....",width:560,obs:x,fetchData:e=>{g(!0),(0,d.$P)(z)},loading:I,change:e=>{!I&&g(!0)},callempty:j,keyFlds:"searchMovQry"}),(0,h.jsx)("div",{className:"flexSpace"}),(0,h.jsxs)("div",{className:"_dsplFlx ",children:[(0,h.jsx)("div",{className:"total_comprobante_title",children:"No de Movientos:"}),(0,h.jsx)("div",{className:"total_comprobante gray",children:(0,h.jsx)("span",{children:null===(s=(0,o._2)((0,o.bh)("movements_list")))||void 0===s?void 0:s.length})})]})]}),(0,h.jsx)("div",{className:"movements_container scollVh",children:(0,o.bh)("movements_list")&&(null===(l=(0,o._2)((0,o.bh)("movements_list")))||void 0===l?void 0:l.map((e=>(0,h.jsx)(p,{data:(0,o.bh)("movements_list")[e],elmId:e,openUpdateView:f,handleRefreshAll:j},e))))})]})}},7852:(e,s,l)=>{l.d(s,{Z:()=>i});l(2791),l(1534);var t=l(9760),o=l(184);const i=e=>{let{data:s,confirm:l,handleClick:i,close:a}=e;const{modalID:n}=s;return(0,o.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"18vh",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,o.jsxs)("div",{className:"_dsplFlx ",children:[(0,o.jsx)("p",{className:"form_title",style:{color:"var(--hrm_palette-static-brand-red"},children:"Lo sentimos"}),(0,o.jsx)("div",{className:"flexSpace"})]}),(0,o.jsx)("div",{className:"_dsplFlx ",children:(0,o.jsx)("span",{children:"no tiene acceso a esta operacion"})}),(0,o.jsxs)("div",{className:"_dsplFlx ",style:{padding:"5px 10px"},children:[(0,o.jsx)("div",{className:"flexSpace"}),(0,o.jsx)("p",{className:"group_title addBtn blue",onClick:()=>{(0,t.CloseModal)({id:n})},children:"OK"})]})]})}},8779:(e,s,l)=>{l.d(s,{Z:()=>i});l(2791),l(1534);var t=l(9760),o=l(184);const i=e=>{let{data:s,confirm:l,label:i,close:a}=e;const{modalID:n}=s,d=e=>{(0,t.CloseModal)({id:n})};return(0,o.jsxs)("div",{style:{maxHeight:"40vh",minHeight:"28vh",overflow:"auto",background:"#fff",borderRadius:13,padding:"10px 19px"},children:[(0,o.jsxs)("div",{className:"_dsplFlx ",children:[(0,o.jsx)("p",{className:"form_title",children:i}),(0,o.jsx)("div",{className:"flexSpace"})]}),(0,o.jsx)("div",{className:"_dsplFlx ",children:(0,o.jsx)("span",{children:"Una vez eliminado no podra ser recuperado"})}),(0,o.jsxs)("div",{className:"_dsplFlx ",style:{padding:"15px 10px"},children:[(0,o.jsx)("div",{className:"flexSpace"}),(0,o.jsx)("p",{className:"group_title addBtn",onClick:d,children:"Cancelar"}),(0,o.jsx)("p",{className:"group_title addBtn red",onClick:()=>{l(),d()},children:"Eliminar"})]})]})}},713:(e,s,l)=>{l.d(s,{$P:()=>m,B8:()=>y,IR:()=>d,QJ:()=>h,Rd:()=>a,VI:()=>_,Ve:()=>v,WA:()=>b,ZW:()=>i,Zj:()=>u,ii:()=>c,nj:()=>p,qT:()=>n,qv:()=>r,yk:()=>o});var t=l(2350);const o=async e=>{var s,l;let o={...null===(s=(0,t.bh)((0,t.hQ)()))||void 0===s?void 0:s.scan_voucher_production};if(o.params={businessId:null===(l=(0,t.bh)("profileUser"))||void 0===l?void 0:l.businessId,limit:120},(0,t.bh)("searchVoucherQry")&&(0,t.bh)("searchVoucherQry").length>1){(0,t.bh)("searchVoucherQry").split(" ").map(((e,s)=>{e&&(o.params[":search"+s]=e.trim())}));const s=(0,t.I7)(o),l=await s;l&&((0,t.Rz)("voucher_production",l),(0,t.Rz)("vouchers_list",u((0,t.jQ)(l),"voucherId")),e&&e())}else(0,t.Rz)("vouchers_list",null),e&&e()},i=async(e,s)=>{var l,o;let i={...null===(l=(0,t.bh)((0,t.hQ)()))||void 0===l?void 0:l.get_inventory_prod};i.params={businessId:null===(o=(0,t.bh)("profileUser"))||void 0===o?void 0:o.businessId,":productId":e};const a=(0,t.I7)(i),n=await a;n&&((0,t.Rz)("inv_products_list",u((0,t.jQ)(n.list),"name")),(0,t.Rz)("inv_products_stock",n.stock),s&&s())},a=async(e,s)=>{var l,o;let i={...null===(l=(0,t.bh)((0,t.hQ)()))||void 0===l?void 0:l.get_prod_stock};i.params={businessId:null===(o=(0,t.bh)("profileUser"))||void 0===o?void 0:o.businessId,productId:e};const a=(0,t.I7)(i),n=await a;if(n){let l={...(0,t.bh)("products_stock")};l[e]=n.stock,(0,t.Rz)("products_stock",l),s&&s()}},n=async e=>{var s,l;let o={...null===(s=(0,t.bh)((0,t.hQ)()))||void 0===s?void 0:s.all_prods};o.params={businessId:null===(l=(0,t.bh)("profileUser"))||void 0===l?void 0:l.businessId},o.subQuerys={},o.subQuerys.stock=1;const i=(0,t.I7)(o),a=await i;if(a){let s={},l=[],o=0;a.map((e=>{var i;if(null!==e&&void 0!==e&&null!==(i=e.inventory)&&void 0!==i&&i.qty){var a,n,d;if(o+=1*(0,t.Zv)(null===e||void 0===e||null===(a=e.inventory)||void 0===a?void 0:a.amount,2),s[e.unit])s[e.unit]+=null===e||void 0===e||null===(n=e.inventory)||void 0===n?void 0:n.qty;else s[e.unit]=null===e||void 0===e||null===(d=e.inventory)||void 0===d?void 0:d.qty;l.push({productId:e.productId,name:e.name,unit:e.unit,qty:(1*e.inventory.qty).toFixed(2),amount:(1*e.inventory.amount).toFixed(2),cost:(e.inventory.amount/e.inventory.qty*1).toFixed(2)})}})),(0,t.Ey)(e)&&e({list:u(l,"name"),total:o,units:s})}},d=async(e,s)=>{var l,o;let i={...null===(l=(0,t.bh)((0,t.hQ)()))||void 0===l?void 0:l.group_prod_stock};i.params={businessId:null===(o=(0,t.bh)("profileUser"))||void 0===o?void 0:o.businessId};const a=(0,t.I7)(i),n=await a;if(n){let l=(0,t._I)(n.comps),o=0,i=0,a=0,d=[],r=[];(0,t._2)(e).map((s=>{let c={...e[s]},v=("debit"===e[s].type?1:-1)*e[s].amount,h=1*(0,t.Zv)(v,2);if(o+=h,n.comps[e[s].comprobanteId]){c.inventory=n.comps[e[s].comprobanteId];let o=0;if((0,t._2)(n.comps[e[s].comprobanteId]).map((l=>{o=1*(0,t.Zv)(o,2)+1*(0,t.Zv)(n.comps[e[s].comprobanteId][l],2)})),o=o<0?-1*o:o,o=1*(0,t.Zv)(o,2),c.inventoryAmount=o,i+=o,h=h<0?-1*h:h,h-o!==0){let e=h-o;a+=e,r.push(c),console.log("diff",c,h,o,e)}else d.push(c);delete l[e[s].comprobanteId]}else a+=v,r.push(c)}));let c=0;(0,t._2)(l).map((e=>{let s=0;(0,t._2)(l[e]).map((o=>{s=1*(0,t.Zv)(s,2)+1*(0,t.Zv)(l[e][o],2)})),c+=s})),console.log("inventoryBack",l,"inventoryBackTotal",c),(0,t.Rz)("inv_comprobantes_compare",{hasError:r,success:d,inventoryBack:l}),(0,t.Ey)(s)&&s()}},r=async e=>{var s,l,o;let i={...null===(s=(0,t.bh)((0,t.hQ)()))||void 0===s?void 0:s.filter_search_opera};i.params={businessId:null===(l=(0,t.bh)("profileUser"))||void 0===l?void 0:l.businessId,year:(0,t.bh)("date_current_year"),":account":null===(o=(0,t.bh)("global_account_params"))||void 0===o?void 0:o.inventory.account};const a=(0,t.I7)(i),n=await a;n&&!n.error&&(0,t.Ey)(e)&&e(u((0,t.jQ)(n),"date"))},c=async e=>{var s,l;let o={...null===(s=(0,t.bh)((0,t.hQ)()))||void 0===s?void 0:s.all_prods};o.params={businessId:null===(l=(0,t.bh)("profileUser"))||void 0===l?void 0:l.businessId};const i=(0,t.I7)(o),a=await i;a&&((0,t.Rz)("products_list",u(a,"name")),(0,t.Rz)("products_ids",(0,t.ME)((0,t.jQ)(a),"productId")),e&&e())},v=async e=>{var s,l;let o={...null===(s=(0,t.bh)((0,t.hQ)()))||void 0===s?void 0:s.search_prod};if(o.params={businessId:null===(l=(0,t.bh)("profileUser"))||void 0===l?void 0:l.businessId,limit:120},(0,t.bh)("searchQry").length>1){(0,t.bh)("searchQry").split(" ").map(((e,s)=>{e&&(o.params[":search"+s]=e.trim())}));const s=(0,t.I7)(o),l=await s;l&&((0,t.Rz)("products_list",u((0,t.jQ)(l),"code")),e&&e())}else(0,t.Rz)("products_list",null),e&&e()},h=async e=>{var s,l;let o={...null===(s=(0,t.bh)((0,t.hQ)()))||void 0===s?void 0:s.all_entry_invoices};o.params={businessId:null===(l=(0,t.bh)("profileUser"))||void 0===l?void 0:l.businessId};const i=(0,t.I7)(o),a=await i;a&&((0,t.Rz)("movements_list",u(a,"date")),(0,t.Rz)("movements_ids",(0,t.ME)((0,t.jQ)(a),"inventoryId")),e&&e())},m=async e=>{var s;if((null===(s=(0,t.bh)("searchMovQry"))||void 0===s?void 0:s.length)>1){var l,o;let s={...null===(l=(0,t.bh)((0,t.hQ)()))||void 0===l?void 0:l.search_inventory};s.params={businessId:null===(o=(0,t.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search0":(0,t.bh)("searchMovQry")};const i=(0,t.I7)(s),a=await i;a&&((0,t.Rz)("movements_list",function(e){var s={};let l=e&&(0,t._2)(e);l.length>0?l.map((l=>{let t=e[l];s[t.comprobanteId]||(s[t.comprobanteId]={},s[t.comprobanteId].amount=0,s[t.comprobanteId].document=t.document,s[t.comprobanteId].date=t.date,s[t.comprobanteId].comprobanteId=t.comprobanteId,s[t.comprobanteId].products=[]),s[t.comprobanteId].amount+=t.qty*t.price,s[t.comprobanteId].products.push({productId:t.productId,qty:t.qty,price:t.price,inventoryId:t.inventoryId})})):s=null;return s}(a)),(0,t.Rz)("movements_ids",a),e&&e())}else(0,t.Rz)("movements_list",[]),(0,t.Rz)("movements_ids",{}),e&&e()};const u=(e,s)=>(0,t.MV)("sortProducts",[e],(()=>e&&e.sort(((e,l)=>{let t=e[s],o=l[s];return t<o?-1:t>o?1:0})))),p=async(e,s)=>{var l,o;let i={...null===(l=(0,t.bh)((0,t.hQ)()))||void 0===l?void 0:l.delete_prod};i.params={businessId:null===(o=(0,t.bh)("profileUser"))||void 0===o?void 0:o.businessId,productId:e};const a=(0,t.I7)(i);await a&&s&&s()},b=async(e,s)=>{var l,o;let i={...null===(l=(0,t.bh)((0,t.hQ)()))||void 0===l?void 0:l.delete_inventory};i.params={businessId:null===(o=(0,t.bh)("profileUser"))||void 0===o?void 0:o.businessId,inventoryId:e};const a=(0,t.I7)(i);await a&&s&&s()},_=async(e,s)=>{var l,o;({...null===(l=(0,t.bh)((0,t.hQ)()))||void 0===l?void 0:l.entry_invoice_acc_2}).params={businessId:null===(o=(0,t.bh)("profileUser"))||void 0===o?void 0:o.businessId,entriesInvoiceId:e}},y=(e,s)=>(0,t.MV)("rangeProdArr",[e,s],(()=>e?(0,t._2)(e).slice(0,s):[]))},7889:()=>{},1534:()=>{}}]);
//# sourceMappingURL=8659.9afff2f2.chunk.js.map