"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[9283],{1130:(s,e,i)=>{i.r(e),i.d(e,{default:()=>_});var o=i(2791),d=i(2350),r=i(2647),l=(i(1534),i(7689)),n=(i(6824),i(4050)),a=i(6677),t=i(713),c=i(9760),v=i(15),u=i(1087),p=i(184);const h=(0,r.PU)(),m=(0,r.JC)(),b="view_product_entry_comprobante",_=s=>{var e,i,r,v,h,m,_;let{data:y,confirm:x,item:f}=s;const[j,Q]=(0,o.useState)(!1),[N,g]=(0,o.useState)(0);(0,l.s0)();(0,o.useEffect)((()=>{var s,e;j||(Q(!0),(0,d.Rz)("accountPicker",{}),g((0,d.M5)()),(0,d.bh)("account_ids")||(0,n.ZX)(k),null!==(s=(0,d.bh)("providers_ids"))&&void 0!==s&&null!==(e=s[null===f||void 0===f?void 0:f.providerId])&&void 0!==e&&e.name||(0,a.Je)(k),(0,d.bh)("products_ids")||(0,t.ii)(k))}),[f.entriesInvoiceId]);const k=async()=>{g((0,d.M5)())};null===(e=(0,d.bh)("providers_ids"))||void 0===e||null===(i=e[null===f||void 0===f?void 0:f.providerId])||void 0===i||i.name;const R=()=>{};return(0,p.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"58vh",width:"860px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,p.jsxs)("div",{className:"_dsplFlx ",children:[(0,p.jsxs)("p",{className:"form_title",children:[f.amount<0?"Salida":"Entrada"," de Mercancias"]}),(0,p.jsx)("div",{className:"flexSpace"}),(0,p.jsx)("div",{children:(0,p.jsx)("div",{className:"date2Upd",children:(0,d.sG)(null===(r=(0,d.bh)(b))||void 0===r?void 0:r.date)})})]}),(0,p.jsxs)("div",{className:"_dsplFlx ",children:[(0,p.jsxs)("div",{className:"_dsplFlx ",children:[(0,p.jsx)("div",{className:"flexSpace"}),null!==(v=(0,d.bh)(b))&&void 0!==v&&v.comprobanteId?(0,p.jsxs)("div",{className:" ",onClick:async()=>{},children:[(0,p.jsx)("p",{className:"label",children:"Comprobante"}),(0,p.jsx)(u.OL,{to:{pathname:"/accounting-ledger",search:"?cId=".concat(null===(h=(0,d.bh)(b))||void 0===h?void 0:h.comprobanteId)},children:(0,p.jsx)("div",{className:"date2Upd",onClick:()=>{y.modalID&&(0,c.CloseModal)({id:y.modalID})},children:null===(m=(0,d.bh)(b))||void 0===m?void 0:m.comprobanteId})})]}):(0,p.jsx)("p",{className:"group_title addBtn purple",children:"Enviar a contabilidad"})]}),(0,p.jsx)("div",{className:"flexSpace"}),(0,p.jsxs)("div",{children:[(0,p.jsx)("p",{className:"label",children:"Documento"}),(0,p.jsx)("div",{className:"date2Upd",onClick:()=>{var s,e;return e=null===(s=(0,d.bh)(b))||void 0===s?void 0:s.document,void(0,d.vQ)(e,R)},children:null===(_=(0,d.bh)(b))||void 0===_?void 0:_.document})]})]}),(0,p.jsx)(I,{data:f.products}),(0,p.jsxs)("div",{className:"_dsplFlx ",style:{margin:"4px 1px 5px 10px"},children:[(0,p.jsx)("div",{className:"flexSpace"}),(0,p.jsx)("div",{className:"date2Upd",style:{margin:"0px 7px"},children:"Balance:"}),"$",f.amount.toFixed(2)]})]})},I=s=>{let{data:e}=s;return(0,p.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,p.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,p.jsx)("div",{className:"tr_bar tr_bar_50 left_alg",children:"Producto"}),(0,p.jsx)("div",{className:"tr_bar tr_bar_15",children:"Dimension"}),(0,p.jsx)("div",{className:"tr_bar tr_bar_15",children:"Qty"}),(0,p.jsx)("div",{className:"tr_bar tr_bar_15",children:"Precio"}),(0,p.jsx)("div",{className:"tr_bar tr_bar_5",children:(0,p.jsx)("div",{className:"icon",onClick:()=>{},children:(0,p.jsx)(h,{name:"printer",color:"#646cff"})})})]}),e&&e.length>0&&(null===e||void 0===e?void 0:e.map(((s,e)=>(0,p.jsx)(y,{idKey:s.productId,index:e,data:s},s.productId+"_"+e))))]})},y=s=>{var e;let{data:i,index:o}=s,r=null===(e=(0,d.bh)("products_ids"))||void 0===e?void 0:e[null===i||void 0===i?void 0:i.productId],l=(null===i||void 0===i?void 0:i.dimension)&&(null===i||void 0===i?void 0:i.dimension.split(",")[0])+" X "+(null===i||void 0===i?void 0:i.dimension.split(",")[1]),n=(null===i||void 0===i?void 0:i.dimension)&&{lbl:l+" (inch)",hover:(null===i||void 0===i?void 0:i.squareFeet)+"S/F X $"+(0,d.Zv)(null===i||void 0===i?void 0:i.pricePerSquareFeet,2)};const a=()=>{(0,v.OpenToast)({text:"Copied to clipobard",timeout:1500})},t=s=>{(0,d.vQ)(s,a)};return(0,p.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,p.jsx)("div",{className:"tr_bar tr_bar_50 left_alg",children:null===r||void 0===r?void 0:r.name}),(0,p.jsx)("div",{className:"tr_bar tr_bar_15",style:{marginTop:-4},children:null!==i&&void 0!==i&&i.dimension?(0,p.jsx)(m,{data:n,color:"#282828",labelField:"lbl",infoField:"hover"}):null}),(0,p.jsx)("div",{className:"tr_bar tr_bar_15",onClick:()=>t((0,d.Zv)(null===i||void 0===i?void 0:i.qty,2)),children:(0,d.Zv)(null===i||void 0===i?void 0:i.qty,2)}),(0,p.jsx)("div",{className:"tr_bar tr_bar_15",onClick:()=>t((0,d.Zv)(null===i||void 0===i?void 0:i.price,2)),children:(0,d.Zv)(null===i||void 0===i?void 0:i.price,2)}),(0,p.jsx)("div",{className:"flexSpace"})]})}},713:(s,e,i)=>{i.d(e,{$P:()=>p,B8:()=>I,IR:()=>a,QJ:()=>u,Rd:()=>l,VI:()=>_,Ve:()=>v,WA:()=>b,ZW:()=>r,Zj:()=>h,ii:()=>c,nj:()=>m,qT:()=>n,qv:()=>t,yk:()=>d});var o=i(2350);const d=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.scan_voucher_production};if(d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,limit:120},(0,o.bh)("searchVoucherQry")&&(0,o.bh)("searchVoucherQry").length>1){(0,o.bh)("searchVoucherQry").split(" ").map(((s,e)=>{s&&(d.params[":search"+e]=s.trim())}));const e=(0,o.I7)(d),i=await e;i&&((0,o.Rz)("voucher_production",i),(0,o.Rz)("vouchers_list",h((0,o.jQ)(i),"voucherId")),s&&s())}else(0,o.Rz)("vouchers_list",null),s&&s()},r=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.get_inventory_prod};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,":productId":s};const l=(0,o.I7)(r),n=await l;n&&((0,o.Rz)("inv_products_list",h((0,o.jQ)(n.list),"name")),(0,o.Rz)("inv_products_stock",n.stock),e&&e())},l=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.get_prod_stock};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,productId:s};const l=(0,o.I7)(r),n=await l;if(n){let i={...(0,o.bh)("products_stock")};i[s]=n.stock,(0,o.Rz)("products_stock",i),e&&e()}},n=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prods};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId},d.subQuerys={},d.subQuerys.stock=1;const r=(0,o.I7)(d),l=await r;if(l){let e={},i=[],d=0;l.map((s=>{var r;if(null!==s&&void 0!==s&&null!==(r=s.inventory)&&void 0!==r&&r.qty){var l,n,a;if(d+=1*(0,o.Zv)(null===s||void 0===s||null===(l=s.inventory)||void 0===l?void 0:l.amount,2),e[s.unit])e[s.unit]+=null===s||void 0===s||null===(n=s.inventory)||void 0===n?void 0:n.qty;else e[s.unit]=null===s||void 0===s||null===(a=s.inventory)||void 0===a?void 0:a.qty;i.push({productId:s.productId,name:s.name,unit:s.unit,qty:(1*s.inventory.qty).toFixed(2),amount:(1*s.inventory.amount).toFixed(2),cost:(s.inventory.amount/s.inventory.qty*1).toFixed(2)})}})),(0,o.Ey)(s)&&s({list:h(i,"name"),total:d,units:e})}},a=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.group_prod_stock};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId};const l=(0,o.I7)(r),n=await l;if(n){let i=(0,o._I)(n.comps),d=0,r=0,l=0,a=[],t=[];(0,o._2)(s).map((e=>{let c={...s[e]},v=("debit"===s[e].type?1:-1)*s[e].amount,u=1*(0,o.Zv)(v,2);if(d+=u,n.comps[s[e].comprobanteId]){c.inventory=n.comps[s[e].comprobanteId];let d=0;if((0,o._2)(n.comps[s[e].comprobanteId]).map((i=>{d=1*(0,o.Zv)(d,2)+1*(0,o.Zv)(n.comps[s[e].comprobanteId][i],2)})),d=d<0?-1*d:d,d=1*(0,o.Zv)(d,2),c.inventoryAmount=d,r+=d,u=u<0?-1*u:u,u-d!==0){let s=u-d;l+=s,t.push(c),console.log("diff",c,u,d,s)}else a.push(c);delete i[s[e].comprobanteId]}else l+=v,t.push(c)}));let c=0;(0,o._2)(i).map((s=>{let e=0;(0,o._2)(i[s]).map((d=>{e=1*(0,o.Zv)(e,2)+1*(0,o.Zv)(i[s][d],2)})),c+=e})),console.log("inventoryBack",i,"inventoryBackTotal",c),(0,o.Rz)("inv_comprobantes_compare",{hasError:t,success:a,inventoryBack:i}),(0,o.Ey)(e)&&e()}},t=async s=>{var e,i,d;let r={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.filter_search_opera};r.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,year:(0,o.bh)("date_current_year"),":account":null===(d=(0,o.bh)("global_account_params"))||void 0===d?void 0:d.inventory.account};const l=(0,o.I7)(r),n=await l;n&&!n.error&&(0,o.Ey)(s)&&s(h((0,o.jQ)(n),"date"))},c=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prods};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId};const r=(0,o.I7)(d),l=await r;l&&((0,o.Rz)("products_list",h(l,"name")),(0,o.Rz)("products_ids",(0,o.ME)((0,o.jQ)(l),"productId")),s&&s())},v=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.search_prod};if(d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,limit:120},(0,o.bh)("searchQry").length>1){(0,o.bh)("searchQry").split(" ").map(((s,e)=>{s&&(d.params[":search"+e]=s.trim())}));const e=(0,o.I7)(d),i=await e;i&&((0,o.Rz)("products_list",h((0,o.jQ)(i),"code")),s&&s())}else(0,o.Rz)("products_list",null),s&&s()},u=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_entry_invoices};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId};const r=(0,o.I7)(d),l=await r;l&&((0,o.Rz)("movements_list",h(l,"date")),(0,o.Rz)("movements_ids",(0,o.ME)((0,o.jQ)(l),"inventoryId")),s&&s())},p=async s=>{var e;if((null===(e=(0,o.bh)("searchMovQry"))||void 0===e?void 0:e.length)>1){var i,d;let e={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.search_inventory};e.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,":search0":(0,o.bh)("searchMovQry")};const r=(0,o.I7)(e),l=await r;l&&((0,o.Rz)("movements_list",function(s){var e={};let i=s&&(0,o._2)(s);i.length>0?i.map((i=>{let o=s[i];e[o.comprobanteId]||(e[o.comprobanteId]={},e[o.comprobanteId].amount=0,e[o.comprobanteId].document=o.document,e[o.comprobanteId].date=o.date,e[o.comprobanteId].comprobanteId=o.comprobanteId,e[o.comprobanteId].products=[]),e[o.comprobanteId].amount+=o.qty*o.price,e[o.comprobanteId].products.push({productId:o.productId,qty:o.qty,price:o.price,inventoryId:o.inventoryId})})):e=null;return e}(l)),(0,o.Rz)("movements_ids",l),s&&s())}else(0,o.Rz)("movements_list",[]),(0,o.Rz)("movements_ids",{}),s&&s()};const h=(s,e)=>(0,o.MV)("sortProducts",[s],(()=>s&&s.sort(((s,i)=>{let o=s[e],d=i[e];return o<d?-1:o>d?1:0})))),m=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.delete_prod};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,productId:s};const l=(0,o.I7)(r);await l&&e&&e()},b=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.delete_inventory};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,inventoryId:s};const l=(0,o.I7)(r);await l&&e&&e()},_=async(s,e)=>{var i,d;({...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.entry_invoice_acc_2}).params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,entriesInvoiceId:s}},I=(s,e)=>(0,o.MV)("rangeProdArr",[s,e],(()=>s?(0,o._2)(s).slice(0,e):[]))},6677:(s,e,i)=>{i.d(e,{Je:()=>d,Qn:()=>a,UO:()=>r,mQ:()=>n});var o=i(2350);const d=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prov_cust};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId};const r=(0,o.I7)(d),n=await r;n&&((0,o.Rz)("providers_list",l((0,o.jQ)(n),"name",1)),(0,o.Rz)("providers_ids",(0,o.ME)((0,o.jQ)(n),"providerId")),s&&s())},r=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.search_prov_cust};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,":search":(0,o.bh)("search_prov")};const r=(0,o.I7)(d),n=await r;n&&((0,o.Rz)("providers_list",l((0,o.jQ)(n),"name",1)),s&&s())};const l=(s,e,i)=>(0,o.MV)("sortProviders",[s],(()=>s&&s.sort(((s,o)=>{let d=1*s[e],r=1*o[e];return d<r?i?-1:1:d>r?i?1:-1:0})))),n=(s,e)=>(0,o.MV)("sortSubProviders",[s],(()=>s&&s.sort(((s,i)=>{let o=1*s[e],d=1*i[e];return o<d?-1:o>d?1:0})))),a=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.delete_prov_cust};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,providerId:s};const l=(0,o.I7)(r);await l&&e&&e()}},1534:()=>{}}]);
//# sourceMappingURL=9283.4dc15485.chunk.js.map