"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[9283],{1130:(s,e,i)=>{i.r(e),i.d(e,{default:()=>I});var o=i(2791),d=i(2350),r=i(2647),n=(i(1534),i(7689)),l=i(6824),a=i(4050),t=i(6677),c=i(713),v=i(9760),u=i(15),p=i(1087),m=i(184);const h=(0,r.PU)(),b=(0,r.JC)(),_="view_product_entry_comprobante",I=s=>{var e,i,r,l,u;let{data:h,confirm:b,item:I}=s;const[x,f]=(0,o.useState)(!1),[j,Q]=(0,o.useState)(0);(0,n.s0)();(0,o.useEffect)((()=>{var s,e;x||(f(!0),(0,d.Rz)("accountPicker",{}),Q((0,d.M5)()),(0,d.bh)("account_ids")||(0,a.ZX)(N),null!==(s=(0,d.bh)("providers_ids"))&&void 0!==s&&null!==(e=s[null===I||void 0===I?void 0:I.providerId])&&void 0!==e&&e.name||(0,t.Je)(N),(0,d.bh)("products_ids")||(0,c.ii)(N))}),[I.providerId,x]);const N=async()=>{Q((0,d.M5)())},g=()=>{};return(0,m.jsxs)("div",{style:{maxHeight:"90vh",minHeight:"58vh",width:"860px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsxs)("p",{className:"form_title",children:[I.amount<0?"Salida":"Entrada"," de Mercancias"]}),(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("div",{children:(0,m.jsx)("div",{className:"date2Upd",children:(0,d.sG)(null===(e=(0,d.bh)(_))||void 0===e?void 0:e.date)})})]}),(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsxs)("div",{className:"_dsplFlx ",children:[(0,m.jsx)("div",{className:"flexSpace"}),null!==(i=(0,d.bh)(_))&&void 0!==i&&i.comprobanteId?(0,m.jsxs)("div",{className:" ",onClick:async()=>{},children:[(0,m.jsx)("p",{className:"label",children:"Comprobante"}),(0,m.jsx)(p.OL,{to:{pathname:"/accounting-ledger",search:"?cId=".concat(null===(r=(0,d.bh)(_))||void 0===r?void 0:r.comprobanteId)},children:(0,m.jsx)("div",{className:"date2Upd",onClick:()=>{h.modalID&&(0,v.CloseModal)({id:h.modalID})},children:null===(l=(0,d.bh)(_))||void 0===l?void 0:l.comprobanteId})})]}):(0,m.jsx)("p",{className:"group_title addBtn purple",children:"Enviar a contabilidad"})]}),(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"label",children:"Documento"}),(0,m.jsx)("div",{className:"date2Upd",onClick:()=>{var s,e;return e=null===(s=(0,d.bh)(_))||void 0===s?void 0:s.document,void(0,d.vQ)(e,g)},children:null===(u=(0,d.bh)(_))||void 0===u?void 0:u.document})]})]}),(0,m.jsx)(y,{data:I.products,entriesInvoiceId:null===I||void 0===I?void 0:I.entriesInvoiceId}),(0,m.jsxs)("div",{className:"_dsplFlx ",style:{margin:"4px 1px 5px 10px"},children:[(0,m.jsx)("div",{className:"flexSpace"}),(0,m.jsx)("div",{className:"date2Upd",style:{margin:"0px 7px"},children:"Balance:"}),"$",I.amount.toFixed(2)]})]})},y=s=>{let{data:e,entriesInvoiceId:i}=s;return(0,m.jsxs)("div",{className:"boxAddAcc",style:{margin:"18px 0"},children:[(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar purple",style:{margin:"18px 0"},children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_50 left_alg",children:"Producto"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_15",children:"Dimension"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_15",children:"Qty"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_15",children:"Precio"}),(0,m.jsx)("div",{className:"tr_bar tr_bar_5",children:(0,m.jsx)("div",{className:"icon",onClick:()=>{let s=[];e.map((e=>{var i;s.push(null===(i=(0,d.bh)("movements_ids"))||void 0===i?void 0:i[e.inventoryId])})),(0,l.Hc)(s)},children:(0,m.jsx)(h,{name:"printer",color:"#646cff"})})})]}),e&&e.length>0&&(null===e||void 0===e?void 0:e.map(((s,e)=>(0,m.jsx)(x,{idKey:s.productId,index:e,data:s},s.productId+"_"+e))))]})},x=s=>{var e;let{data:i,index:o}=s,r=null===(e=(0,d.bh)("products_ids"))||void 0===e?void 0:e[null===i||void 0===i?void 0:i.productId],n=(null===i||void 0===i?void 0:i.dimension)&&(null===i||void 0===i?void 0:i.dimension.split(",")[0])+" X "+(null===i||void 0===i?void 0:i.dimension.split(",")[1]),l=(null===i||void 0===i?void 0:i.dimension)&&{lbl:n+" (inch)",hover:(null===i||void 0===i?void 0:i.squareFeet)+"S/F X $"+(0,d.Zv)(null===i||void 0===i?void 0:i.pricePerSquareFeet,2)};const a=()=>{(0,u.OpenToast)({text:"Copied to clipobard",timeout:1500})},t=s=>{(0,d.vQ)(s,a)};return(0,m.jsxs)("div",{className:"_dsplFlx hdr_bar",children:[(0,m.jsx)("div",{className:"tr_bar tr_bar_50 left_alg",children:null===r||void 0===r?void 0:r.name}),(0,m.jsx)("div",{className:"tr_bar tr_bar_15",style:{marginTop:-4},children:null!==i&&void 0!==i&&i.dimension?(0,m.jsx)(b,{data:l,color:"#282828",labelField:"lbl",infoField:"hover"}):null}),(0,m.jsx)("div",{className:"tr_bar tr_bar_15",onClick:()=>t((0,d.Zv)(null===i||void 0===i?void 0:i.qty,2)),children:(0,d.Zv)(null===i||void 0===i?void 0:i.qty,2)}),(0,m.jsx)("div",{className:"tr_bar tr_bar_15",onClick:()=>t((0,d.Zv)(null===i||void 0===i?void 0:i.price,2)),children:(0,d.Zv)(null===i||void 0===i?void 0:i.price,2)}),(0,m.jsx)("div",{className:"flexSpace"})]})}},713:(s,e,i)=>{i.d(e,{$P:()=>p,B8:()=>I,IR:()=>a,QJ:()=>u,Rd:()=>n,VI:()=>_,Ve:()=>v,WA:()=>b,ZW:()=>r,Zj:()=>m,ii:()=>c,nj:()=>h,qT:()=>l,qv:()=>t,yk:()=>d});var o=i(2350);const d=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.scan_voucher_production};if(d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,limit:120},(0,o.bh)("searchVoucherQry")&&(0,o.bh)("searchVoucherQry").length>1){(0,o.bh)("searchVoucherQry").split(" ").map(((s,e)=>{s&&(d.params[":search"+e]=s.trim())}));const e=(0,o.I7)(d),i=await e;i&&((0,o.Rz)("voucher_production",i),(0,o.Rz)("vouchers_list",m((0,o.jQ)(i),"voucherId")),s&&s())}else(0,o.Rz)("vouchers_list",null),s&&s()},r=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.get_inventory_prod};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,":productId":s};const n=(0,o.I7)(r),l=await n;l&&((0,o.Rz)("inv_products_list",m((0,o.jQ)(l.list),"name")),(0,o.Rz)("inv_products_stock",l.stock),e&&e())},n=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.get_prod_stock};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,productId:s};const n=(0,o.I7)(r),l=await n;if(l){let i={...(0,o.bh)("products_stock")};i[s]=l.stock,(0,o.Rz)("products_stock",i),e&&e()}},l=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prods};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId},d.subQuerys={},d.subQuerys.stock=1;const r=(0,o.I7)(d),n=await r;if(n){let e={},i=[],d=0;n.map((s=>{var r;if(null!==s&&void 0!==s&&null!==(r=s.inventory)&&void 0!==r&&r.qty){var n,l,a;if(d+=1*(0,o.Zv)(null===s||void 0===s||null===(n=s.inventory)||void 0===n?void 0:n.amount,2),e[s.unit])e[s.unit]+=null===s||void 0===s||null===(l=s.inventory)||void 0===l?void 0:l.qty;else e[s.unit]=null===s||void 0===s||null===(a=s.inventory)||void 0===a?void 0:a.qty;i.push({productId:s.productId,name:s.name,unit:s.unit,qty:(1*s.inventory.qty).toFixed(2),amount:(1*s.inventory.amount).toFixed(2),cost:(s.inventory.amount/s.inventory.qty*1).toFixed(2)})}})),(0,o.Ey)(s)&&s({list:m(i,"name"),total:d,units:e})}},a=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.group_prod_stock};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId};const n=(0,o.I7)(r),l=await n;if(l){let i=(0,o._I)(l.comps),d=0,r=0,n=0,a=[],t=[];(0,o._2)(s).map((e=>{let c={...s[e]},v=("debit"===s[e].type?1:-1)*s[e].amount,u=1*(0,o.Zv)(v,2);if(d+=u,l.comps[s[e].comprobanteId]){c.inventory=l.comps[s[e].comprobanteId];let d=0;if((0,o._2)(l.comps[s[e].comprobanteId]).map((i=>{d=1*(0,o.Zv)(d,2)+1*(0,o.Zv)(l.comps[s[e].comprobanteId][i],2)})),d=d<0?-1*d:d,d=1*(0,o.Zv)(d,2),c.inventoryAmount=d,r+=d,u=u<0?-1*u:u,u-d!==0){let s=u-d;n+=s,t.push(c),console.log("diff",c,u,d,s)}else a.push(c);delete i[s[e].comprobanteId]}else n+=v,t.push(c)}));let c=0;(0,o._2)(i).map((s=>{let e=0;(0,o._2)(i[s]).map((d=>{e=1*(0,o.Zv)(e,2)+1*(0,o.Zv)(i[s][d],2)})),c+=e})),console.log("inventoryBack",i,"inventoryBackTotal",c),(0,o.Rz)("inv_comprobantes_compare",{hasError:t,success:a,inventoryBack:i}),(0,o.Ey)(e)&&e()}},t=async s=>{var e,i,d;let r={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.filter_search_opera};r.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,year:(0,o.bh)("date_current_year"),":account":null===(d=(0,o.bh)("global_account_params"))||void 0===d?void 0:d.inventory.account};const n=(0,o.I7)(r),l=await n;l&&!l.error&&(0,o.Ey)(s)&&s(m((0,o.jQ)(l),"date"))},c=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prods};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId};const r=(0,o.I7)(d),n=await r;n&&((0,o.Rz)("products_list",m(n,"name")),(0,o.Rz)("products_ids",(0,o.ME)((0,o.jQ)(n),"productId")),s&&s())},v=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.search_prod};if(d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,limit:120},(0,o.bh)("searchQry").length>1){(0,o.bh)("searchQry").split(" ").map(((s,e)=>{s&&(d.params[":search"+e]=s.trim())}));const e=(0,o.I7)(d),i=await e;i&&((0,o.Rz)("products_list",m((0,o.jQ)(i),"code")),s&&s())}else(0,o.Rz)("products_list",null),s&&s()},u=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_entry_invoices};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId};const r=(0,o.I7)(d),n=await r;n&&((0,o.Rz)("movements_list",m(n,"date")),(0,o.Rz)("movements_ids",(0,o.ME)((0,o.jQ)(n),"inventoryId")),s&&s())},p=async s=>{var e;if((null===(e=(0,o.bh)("searchMovQry"))||void 0===e?void 0:e.length)>1){var i,d;let e={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.search_inventory};e.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,":search0":(0,o.bh)("searchMovQry")};const r=(0,o.I7)(e),n=await r;n&&((0,o.Rz)("movements_list",function(s){var e={};let i=s&&(0,o._2)(s);i.length>0?i.map((i=>{let o=s[i];e[o.comprobanteId]||(e[o.comprobanteId]={},e[o.comprobanteId].amount=0,e[o.comprobanteId].document=o.document,e[o.comprobanteId].date=o.date,e[o.comprobanteId].comprobanteId=o.comprobanteId,e[o.comprobanteId].products=[]),e[o.comprobanteId].amount+=o.qty*o.price,e[o.comprobanteId].products.push({productId:o.productId,qty:o.qty,price:o.price,inventoryId:o.inventoryId})})):e=null;return e}(n)),(0,o.Rz)("movements_ids",n),s&&s())}else(0,o.Rz)("movements_list",[]),(0,o.Rz)("movements_ids",{}),s&&s()};const m=(s,e)=>(0,o.MV)("sortProducts",[s],(()=>s&&s.sort(((s,i)=>{let o=s[e],d=i[e];return o<d?-1:o>d?1:0})))),h=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.delete_prod};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,productId:s};const n=(0,o.I7)(r);await n&&e&&e()},b=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.delete_inventory};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,inventoryId:s};const n=(0,o.I7)(r);await n&&e&&e()},_=async(s,e)=>{var i,d;({...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.entry_invoice_acc_2}).params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,entriesInvoiceId:s}},I=(s,e)=>(0,o.MV)("rangeProdArr",[s,e],(()=>s?(0,o._2)(s).slice(0,e):[]))},6677:(s,e,i)=>{i.d(e,{Je:()=>d,Qn:()=>a,UO:()=>r,mQ:()=>l});var o=i(2350);const d=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.all_prov_cust};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId};const r=(0,o.I7)(d),l=await r;l&&((0,o.Rz)("providers_list",n((0,o.jQ)(l),"name",1)),(0,o.Rz)("providers_ids",(0,o.ME)((0,o.jQ)(l),"providerId")),s&&s())},r=async s=>{var e,i;let d={...null===(e=(0,o.bh)((0,o.hQ)()))||void 0===e?void 0:e.search_prov_cust};d.params={businessId:null===(i=(0,o.bh)("profileUser"))||void 0===i?void 0:i.businessId,":search":(0,o.bh)("search_prov")};const r=(0,o.I7)(d),l=await r;l&&((0,o.Rz)("providers_list",n((0,o.jQ)(l),"name",1)),s&&s())};const n=(s,e,i)=>(0,o.MV)("sortProviders",[s],(()=>s&&s.sort(((s,o)=>{let d=1*s[e],r=1*o[e];return d<r?i?-1:1:d>r?i?1:-1:0})))),l=(s,e)=>(0,o.MV)("sortSubProviders",[s],(()=>s&&s.sort(((s,i)=>{let o=1*s[e],d=1*i[e];return o<d?-1:o>d?1:0})))),a=async(s,e)=>{var i,d;let r={...null===(i=(0,o.bh)((0,o.hQ)()))||void 0===i?void 0:i.delete_prov_cust};r.params={businessId:null===(d=(0,o.bh)("profileUser"))||void 0===d?void 0:d.businessId,providerId:s};const n=(0,o.I7)(r);await n&&e&&e()}},1534:()=>{}}]);
//# sourceMappingURL=9283.ebd62385.chunk.js.map