"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[9757],{9757:(e,t,o)=>{o.r(t),o.d(t,{default:()=>h});var a=o(2791),i=o(2350),l=(o(1e3),o(2647)),s=o(3588),d=o(1702),n=o(9760),r=o(2692),c=o(2502),u=o(184);const v=(0,l.JC)(),b=(0,r.dz)(),m=(0,l.PU)(),h=e=>{var t,o,l,r,v;let{data:b,item:h}=e;const[x,_]=(0,a.useState)(!1),[y,f]=(0,a.useState)(0);(0,a.useEffect)((()=>{if(!x){var e;if(_(!0),null!==h&&void 0!==h&&h.employeeId)null!==(e=(0,i.bh)("employees_ids"))&&void 0!==e&&e[null===h||void 0===h?void 0:h.employeeId]||(0,c.Dy)(g);f((0,i.M5)())}}));const w=()=>{(null===b||void 0===b?void 0:b.modalID)&&(0,n.CloseModal)({id:null===b||void 0===b?void 0:b.modalID})},g=()=>{f((0,i.M5)())};let z=null===(t=(0,i.bh)("employees_ids"))||void 0===t||null===(o=t[null===h||void 0===h?void 0:h.employeeId])||void 0===o?void 0:o.name,j=1*(null===(l=h.balance)||void 0===l?void 0:l.toFixed(2))!==0;return(0,u.jsxs)("div",{style:{maxHeight:"96vh",minHeight:"90vh",width:"960px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,u.jsx)("div",{className:"_dsplFlx ",children:(0,u.jsx)("div",{className:"flexSpace"})}),(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsxs)("div",{className:"_dsplFlx",style:{marginTop:20},children:[(0,u.jsx)("div",{className:"desc_lbl",children:"Comprobante:"}),(0,u.jsx)("div",{className:"name comprobante_id",style:j?{color:"var(--hrm_palette-selected-nav-text)"}:{},children:null===h||void 0===h?void 0:h.comprobanteId})]}),j?(0,u.jsx)("div",{className:"msg_alert red",children:(0,u.jsxs)("div",{className:"msg_alert_title",children:["El comprobante no esta cuadrado tiene una diferencia de ",null===h||void 0===h||null===(r=h.balance)||void 0===r?void 0:r.toFixed(2)]})}):null,(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)("div",{className:"icon",onClick:()=>{var e;let t=[];h.operations&&(null===(e=h.operations)||void 0===e||e.map(((e,o)=>{let a={...e};a.description=h.description,a.comprobanteId=h.comprobanteId,a.date=(0,i.sJ)(h.date),a.description=h.description;let l=e.account.code+" - "+e.account.name;if(a.account=l,a.sub_account){let t=e.sub_account.subAccount+" - "+e.sub_account.subAccountName;a.sub_account=t}t.push(a)}))),(0,i.eY)("export_compobante_"+h.comprobanteId+"_"+(0,i.M5)()+".csv",t)},style:{marginRight:17},children:(0,u.jsx)(m,{name:"google-spreadsheet",color:"#282828"})}),(0,u.jsx)("div",{className:"icon",onClick:()=>{(0,d.C)(h)},children:(0,u.jsx)(m,{name:"printer",color:"#282828"})})]}),(0,u.jsxs)("div",{className:"_dsplFlx cmp_dtls",children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsxs)("div",{className:"_dsplFlx",children:[(0,u.jsx)("div",{className:"desc_lbl"}),(0,u.jsx)("div",{className:"name",children:(0,i.sG)(null===h||void 0===h?void 0:h.date)})]})]}),(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar purple",children:[(0,u.jsx)("div",{className:"tr_bar_15",children:"Cuenta"}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Sub Cuenta"}),(0,u.jsx)("div",{className:"tr_bar_40",children:"Documento"}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Debito"}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Credito"})]}),null===(v=(0,s.Eb)(null===h||void 0===h?void 0:h.operations))||void 0===v?void 0:v.map(((e,t)=>(0,u.jsx)(p,{element:e,in2D:t,close:w},t))),(0,u.jsxs)("div",{className:"cmp_desc",children:[(0,u.jsx)("div",{className:"desc_lbl",children:"Detalles:"}),(0,u.jsxs)("div",{className:"description",children:[null===h||void 0===h?void 0:h.description," ",z]})]}),(0,u.jsxs)("div",{className:"_dsplFlx cmp_dtls",children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)("span",{className:"entryType",children:h.entryName||"Comprobante Manual"})]})]})},p=e=>{var t,o,a,l;let{element:s,in2D:d,close:r}=e;let c="".concat(null===s||void 0===s||null===(t=s.account)||void 0===t?void 0:t.accountId).concat(null!==s&&void 0!==s&&s.sub_account?"_"+(null===s||void 0===s||null===(o=s.sub_account)||void 0===o?void 0:o.sub_accountId):"");return(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar","item-key":"".concat(c),children:[(0,u.jsx)("div",{className:"tr_bar_15",children:(0,u.jsx)(v,{data:s.account,labelField:"code",infoField:"name"})}),(0,u.jsx)("div",{className:"tr_bar_15",children:(0,u.jsx)(v,{data:s.sub_account,labelField:"subAccount",infoField:"subAccountName"})}),(0,u.jsx)("div",{className:"tr_bar_40",onClick:()=>{var e,t;if(null!==(e=(0,i.bh)("profileUser"))&&void 0!==e&&e.isAdmin||null===(t=(0,i.Ch)()[(0,i.bh)("date_current_year")])||void 0===t||!t.isClosed){if((0,i.ML)()){let e=(0,i.bh)("lastTimeCallModal")||0;if(Date.now()>e){let e=["document","amount","type","description","account","subAccount","comprobanteId"],t=(0,i.Ld)({...(0,i.bh)("comprobante_list")[s.operationId]},e);(0,i.Rz)("upd_comprobantebyId",t),(0,i.Rz)("upd_comprobantebyId_bck",JSON.parse(JSON.stringify(t))),(0,i.Rz)("lastTimeCallModal",Date.now()+320);let o={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};o.content=(0,u.jsx)(b,{confirm:()=>{r()},item:s}),(0,n.OpenModal)(o)}}}else;},children:s.document}),(0,u.jsx)("div",{className:"tr_bar_15",children:null===(a=1*s.debit)||void 0===a?void 0:a.toFixed(2)}),(0,u.jsx)("div",{className:"tr_bar_15",children:null===(l=1*s.credit)||void 0===l?void 0:l.toFixed(2)})]},d)}},1702:(e,t,o)=>{o.d(t,{C:()=>r});var a=o(6963),i=o(2350),l=o(4e3);let s=0,d=null,n=null;const r=async e=>{const t=await a.PDFDocument.create();if(t.registerFontkit(l.Z),d=await t.embedFont(a.StandardFonts.TimesRoman,{subset:!0}),n=await t.embedFont(a.StandardFonts.TimesRomanBold,{subset:!0}),(0,i.bh)("modernFontReport")){let e=(0,i.bh)("Roboto-Bold.ttf"),o=(0,i.bh)("ggSans-Italic.ttf"),a=(0,i.bh)("ggSans-Medium.ttf");const l=await fetch(e).then((e=>e.arrayBuffer()));n=await t.embedFont(l,{subset:!0});await fetch(o).then((e=>e.arrayBuffer()));const s=await fetch(a).then((e=>e.arrayBuffer()));d=await t.embedFont(s,{subset:!0})}let o=t.addPage();const{width:r,height:c}=o.getSize(),u=10;let v=0,b=44;s=c-40,o.drawText(e.entryName||"Comprobante Manual",{x:50,y:s,size:14,font:n,color:(0,a.rgb)(0,0,0)});const m=n.widthOfTextAtSize(e.comprobanteId,14),h=d.widthOfTextAtSize("Comprobante:  ",13);o.drawText("Comprobante:  ",{x:580-h-m,y:s,size:13,font:d,color:(0,a.rgb)(0,0,0)}),o.drawText(e.comprobanteId+"",{x:580-m,y:s,size:14,font:n,color:(0,a.rgb)(0,0,0)}),s-=25;const p=d.widthOfTextAtSize("Fecha:  ",13),x=n.widthOfTextAtSize((0,i.Gv)(e.date)+"",14);o.drawText("Fecha:  ",{x:580-p-x,y:s,size:13,font:d,color:(0,a.rgb)(0,0,0)}),o.drawText((0,i.Gv)(e.date)+"",{x:580-x,y:s,size:14,font:n,color:(0,a.rgb)(0,0,0)}),s-=15;let _=(null===e||void 0===e?void 0:e.operations)||[];s-=18,o.drawText("Cuenta",{x:20,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)}),o.drawText("Sub Cuenta",{x:205,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)}),o.drawText("Documento",{x:360,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)});const y=n.widthOfTextAtSize("Debito",13);o.drawText("Debito",{x:500-y,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)});const f=n.widthOfTextAtSize("Credito",13);o.drawText("Credito",{x:580-f,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)}),s-=8,o.drawRectangle({x:15,y:s+1,width:570,height:.95,color:(0,a.rgb)(0,0,0),borderColor:(0,a.rgb)(0,0,0)});let w=Math.ceil(_.length/40);Array.from(Array(w).keys()).map((e=>{if(e>0){o=t.addPage(),s=c-26,o.drawText("Cuenta",{x:20,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)}),o.drawText("Sub Cuenta",{x:205,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)}),o.drawText("Documento",{x:360,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)});const e=n.widthOfTextAtSize("Debito",13);o.drawText("Debito",{x:500-e,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)});const i=n.widthOfTextAtSize("Credito",13);o.drawText("Credito",{x:580-i,y:s,size:13,font:n,color:(0,a.rgb)(0,0,0)}),s-=8,o.drawRectangle({x:15,y:s+1,width:570,height:.95,color:(0,a.rgb)(0,0,0),borderColor:(0,a.rgb)(0,0,0)}),s-=2}let i=_.slice(v,b);e>0&&(v=b+1,b=v+48),Array.isArray(i)&&i.map(((e,t)=>{var i,l,n,r,c;(s-=16,null!==e&&void 0!==e&&null!==(i=e.account)&&void 0!==i&&i.name)&&o.drawText((null===e||void 0===e||null===(c=e.account)||void 0===c?void 0:c.name)+"",{x:20,y:s,size:u,font:d,color:(0,a.rgb)(0,0,0)});if(null!==e&&void 0!==e&&null!==(l=e.sub_account)&&void 0!==l&&l.subAccountName){var v;let t=null===e||void 0===e||null===(v=e.sub_account)||void 0===v?void 0:v.subAccountName.substring(0,32);o.drawText(t+"",{x:205,y:s,size:u,font:d,color:(0,a.rgb)(0,0,0)})}o.drawText((null===e||void 0===e?void 0:e.document)+"",{x:360,y:s,size:u,font:d,color:(0,a.rgb)(0,0,0)});let b=null!==e&&void 0!==e&&e.debit?null===(n=1*(null===e||void 0===e?void 0:e.debit))||void 0===n?void 0:n.toFixed(2):"0.00";const m=d.widthOfTextAtSize(b+"",u);o.drawText(b+"",{x:500-m,y:s,size:u,font:d,color:(0,a.rgb)(0,0,0)});let h=null!==e&&void 0!==e&&e.credit?null===(r=1*(null===e||void 0===e?void 0:e.credit))||void 0===r?void 0:r.toFixed(2):"0.00";const p=d.widthOfTextAtSize(h+"",u);o.drawText(h+"",{x:580-p,y:s,size:u,font:d,color:(0,a.rgb)(0,0,0)})}))})),s-=28,o.drawRectangle({x:15,y:s+1,width:570,height:.85,color:(0,a.rgb)(0,0,0),borderColor:(0,a.rgb)(0,0,0)}),s-=18,o.drawText("Detalles: ",{x:50,y:s,size:12,font:d,color:(0,a.rgb)(0,0,0)}),s-=18,o.drawText(e.description?e.description:"",{x:70,y:s,size:11,font:d,color:(0,a.rgb)(0,0,0)});let g=function(e){let t=new Blob([e],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(t)}(await t.save());window.open(g)}},2502:(e,t,o)=>{o.d(t,{$5:()=>n,Dy:()=>i,Oy:()=>u,er:()=>d,hb:()=>r,iW:()=>c,kQ:()=>l,lG:()=>s,tM:()=>m});var a=o(2350);const i=async e=>{var t,o;let i={...null===(t=(0,a.bh)((0,a.hQ)()))||void 0===t?void 0:t.search_employee};i.params={businessId:null===(o=(0,a.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search1":(0,a.bh)("employeeOut")?"":"in-job"};const l=(0,a.I7)(i),s=await l;s&&((0,a.Rz)("employees_list",v((0,a.jQ)(s),"name")),(0,a.Rz)("employees_ids",s),(0,a.Rz)("employees_ctIds",(0,a.ME)((0,a.jQ)(s),"userTC")),e&&e())},l=async e=>{var t,o;let i={...null===(t=(0,a.bh)((0,a.hQ)()))||void 0===t?void 0:t.search_employee};i.params={businessId:null===(o=(0,a.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search0":(0,a.bh)("searchQry"),":search5":(0,a.bh)("employeeOut")?"":"in-job"};const l=(0,a.I7)(i),s=await l;s&&((0,a.Rz)("employees_list",v((0,a.jQ)(s),"name")),e&&e())},s=async(e,t)=>{var o,i,l,s;let d={...null===(o=(0,a.bh)((0,a.hQ)()))||void 0===o?void 0:o.search_employee_paystub};d.params={businessId:null===(i=(0,a.bh)("profileUser"))||void 0===i?void 0:i.businessId,year:(0,a.bh)("date_current_year"),":date1":(null===(l=(0,a.bh)("date_range_comps"))||void 0===l?void 0:l.initDate)-10,":date2":null===(s=(0,a.bh)("date_range_comps"))||void 0===s?void 0:s.lastDate,":employeeId":e};const n=(0,a.I7)(d),r=await n;r&&!r.error&&((0,a.Rz)("paystub_submayor_list",r),(0,a._2)(r).map((async e=>{var t,o;u(null===(t=r[e])||void 0===t?void 0:t.comprobanteId,null===(o=r[e])||void 0===o?void 0:o.employeeId)}))),t&&t()},d=async e=>{var t,o;let i=(0,a.Qk)((0,a.bh)("datePeriodRs")),l={...null===(t=(0,a.bh)((0,a.hQ)()))||void 0===t?void 0:t.search_employee_paystub};l.params={businessId:null===(o=(0,a.bh)("profileUser"))||void 0===o?void 0:o.businessId,":search2":"Wk_"+(1*i-1)};const s=(0,a.I7)(l),d=await s;return d&&!d.error&&(0,a._2)(d).length>0?d:null},n=async e=>{let t="get_all_timecard_last",o=(0,a.bh)(t)||0;if(Date.now()>o){var i,l;(0,a.Rz)(t,Date.now()+190);let o={...null===(i=(0,a.bh)((0,a.hQ)()))||void 0===i?void 0:i.scan_time_card};o.params={businessId:null===(l=(0,a.bh)("profileUser"))||void 0===l?void 0:l.businessId,":search0":"00"};const s=(0,a.I7)(o),d=await s;d&&((0,a.Rz)("timecard_list",v((0,a.jQ)(d),"code")),(0,a.Rz)("timecard_gorups_week",b(d)),e&&e())}},r=async(e,t)=>{let o="get_search_timecard_last",i=(0,a.bh)(o)||0;if(Date.now()>i){var l,s;(0,a.Rz)(o,Date.now()+190);let i={...null===(l=(0,a.bh)((0,a.hQ)()))||void 0===l?void 0:l.scan_time_card};i.params={businessId:null===(s=(0,a.bh)("profileUser"))||void 0===s?void 0:s.businessId},e.map(((e,t)=>{e&&(i.params[":search"+t]=e.toString().trim())}));const d=(0,a.I7)(i),n=await d;n&&((0,a.Rz)("timecard_list",v((0,a.jQ)(n),"code")),t&&t())}},c=async e=>{let t="get_search_timecard_last",o=(0,a.bh)(t)||0;if(!(Date.now()>o))return null;{var i,l;(0,a.Rz)(t,Date.now()+190);let o={...null===(i=(0,a.bh)((0,a.hQ)()))||void 0===i?void 0:i.scan_time_card};o.params={businessId:null===(l=(0,a.bh)("profileUser"))||void 0===l?void 0:l.businessId},e.map(((e,t)=>{e&&(o.params[":search"+t]=e.toString().trim())}));const d=(0,a.I7)(o),n=await d;var s;if(n)return null===n||void 0===n?void 0:n[null===(s=(0,a._2)(n))||void 0===s?void 0:s[0]]}},u=async(e,t)=>{let o="get_compById_last"+e+"_"+t,i=(0,a.bh)(o)||0;if(Date.now()>i){var l,s;(0,a.Rz)(o,Date.now()+890);let i={...null===(l=(0,a.bh)((0,a.hQ)()))||void 0===l?void 0:l.filter_search_opera};i.params={businessId:null===(s=(0,a.bh)("profileUser"))||void 0===s?void 0:s.businessId,":search0":e,":search1":t};const d=(0,a.I7)(i),n=await d;if(n){let t=(0,a.bh)("cmpByPayStubMayor");return t[e]=n,(0,a.Rz)("cmpByPayStubMayor",t),n}}return null};const v=(e,t)=>e&&e.sort(((e,o)=>{let a=1*e[t],i=1*o[t];return a<i?-1:a>i?1:0})),b=e=>{let t={};return e&&(0,a._2)(e).map((o=>{var a,i;let l=(null===(a=e[o])||void 0===a?void 0:a.week)+"_"+(null===(i=e[o])||void 0===i?void 0:i.userTC);t[l]||(t[l]=e[o])})),t},m=e=>{let t={},o=/\t/g;e&&e.split("\n").map(((e,i)=>{if(e.indexOf("No")<0){let i=e.split(o);if(7===i.length){let e=i[2].trim(),o=i[6].split("  "),l=o[0],s=(0,a.Qk)(new Date(l)),d=o[1].split(":"),n=60*d[0]+1*d[1],r=i[4].trim();t[e]||(t[e]={}),t[e][s]||(t[e][s]={}),t[e][s][l]||(t[e][s][l]={}),t[e][s][l][n]||(t[e][s][l][n]={}),t[e][s][l][n][r]||(t[e][s][l][n][r]=1)}}}));let i=[];return(0,a._2)(t).map((e=>{(0,a._2)(t[e]).map((o=>{let l={},s=null;(0,a._2)(t[e][o]).map((i=>{let d=h(t[e][o][i]),n=(0,a._2)(t[e][o][i][d[0]]),r=(0,a._2)(t[e][o][i][d[1]]);s=(0,a.qt)(new Date(i));let c={start:1*d[0],startMode:n,end:1*d[1],endMode:r,active:!0},u=new Date(i).getDay();l[u]=c}));let d={userTC:e,week:o,hourly:l,period:s};i.push(d)}))})),(0,a.Rz)("timeCard",i),i},h=e=>{let t=0,o=1e10;return(0,a._2)(e).map((e=>{let a=1*e;t<a&&(t=a),a<o&&(o=a)})),[o,t]}},1e3:()=>{}}]);
//# sourceMappingURL=9757.9e1c9a69.chunk.js.map