"use strict";(self.webpackChunkhrmfinance=self.webpackChunkhrmfinance||[]).push([[9757],{9757:(e,o,t)=>{t.r(o),t.d(o,{default:()=>x});var a=t(2791),l=t(2350),i=(t(1e3),t(2647)),d=t(3588),s=t(1702),n=t(9760),r=t(2692),c=t(2502),u=t(184);const b=(0,i.JC)(),v=(0,r.dz)(),m=(0,i.PU)(),x=e=>{var o,t,i,r,b;let{data:v,item:x}=e;const[p,y]=(0,a.useState)(!1),[_,f]=(0,a.useState)(0);(0,a.useEffect)((()=>{if(!p){var e;if(y(!0),null!==x&&void 0!==x&&x.employeeId)null!==(e=(0,l.bh)("employees_ids"))&&void 0!==e&&e[null===x||void 0===x?void 0:x.employeeId]||(0,c.Dy)(g);f((0,l.M5)())}}));const w=()=>{(null===v||void 0===v?void 0:v.modalID)&&(0,n.CloseModal)({id:null===v||void 0===v?void 0:v.modalID})},g=()=>{f((0,l.M5)())};let j=null===(o=(0,l.bh)("employees_ids"))||void 0===o||null===(t=o[null===x||void 0===x?void 0:x.employeeId])||void 0===t?void 0:t.name,z=1*(null===(i=x.balance)||void 0===i?void 0:i.toFixed(2))!==0;return(0,u.jsxs)("div",{style:{maxHeight:"96vh",minHeight:"90vh",width:"960px",overflow:"auto",background:"var(--hrm_palette-general-background-b)",borderRadius:13,padding:"10px 19px"},children:[(0,u.jsx)("div",{className:"_dsplFlx ",children:(0,u.jsx)("div",{className:"flexSpace"})}),(0,u.jsxs)("div",{className:"_dsplFlx ",children:[(0,u.jsxs)("div",{className:"_dsplFlx",style:{marginTop:20},children:[(0,u.jsx)("div",{className:"desc_lbl",children:"Comprobante:"}),(0,u.jsx)("div",{className:"name comprobante_id",style:z?{color:"var(--hrm_palette-selected-nav-text)"}:{},children:null===x||void 0===x?void 0:x.comprobanteId})]}),z?(0,u.jsx)("div",{className:"msg_alert red",children:(0,u.jsxs)("div",{className:"msg_alert_title",children:["El comprobante no esta cuadrado tiene una diferencia de ",null===x||void 0===x||null===(r=x.balance)||void 0===r?void 0:r.toFixed(2)]})}):null,(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)("div",{className:"icon",onClick:()=>{var e;let o=[];x.operations&&(null===(e=x.operations)||void 0===e||e.map(((e,t)=>{let a={...e};a.description=x.description,a.comprobanteId=x.comprobanteId,a.date=(0,l.sJ)(x.date),a.description=x.description;let i=e.account.code+" - "+e.account.name;if(a.account=i,a.sub_account){let o=e.sub_account.subAccount+" - "+e.sub_account.subAccountName;a.sub_account=o}o.push(a)}))),(0,l.eY)("export_compobante_"+x.comprobanteId+"_"+(0,l.M5)()+".csv",o)},style:{marginRight:17},children:(0,u.jsx)(m,{name:"google-spreadsheet",color:"#282828"})}),(0,u.jsx)("div",{className:"icon",onClick:()=>{(0,s.C)(x)},children:(0,u.jsx)(m,{name:"printer",color:"#282828"})})]}),(0,u.jsxs)("div",{className:"_dsplFlx cmp_dtls",children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsxs)("div",{className:"_dsplFlx",children:[(0,u.jsx)("div",{className:"desc_lbl"}),(0,u.jsx)("div",{className:"name",children:(0,l.sG)(null===x||void 0===x?void 0:x.date)})]})]}),(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar purple",children:[(0,u.jsx)("div",{className:"tr_bar_15",children:"Cuenta"}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Sub Cuenta"}),(0,u.jsx)("div",{className:"tr_bar_40",children:"Documento"}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Debito"}),(0,u.jsx)("div",{className:"tr_bar_15",children:"Credito"})]}),null===(b=(0,d.Eb)(null===x||void 0===x?void 0:x.operations))||void 0===b?void 0:b.map(((e,o)=>(0,u.jsx)(h,{element:e,in2D:o,close:w},o))),(0,u.jsxs)("div",{className:"cmp_desc",children:[(0,u.jsx)("div",{className:"desc_lbl",children:"Detalles:"}),(0,u.jsxs)("div",{className:"description",children:[null===x||void 0===x?void 0:x.description," ",j]})]}),(0,u.jsxs)("div",{className:"_dsplFlx cmp_dtls",children:[(0,u.jsx)("div",{className:"flexSpace"}),(0,u.jsx)("span",{className:"entryType",children:x.entryName||"Comprobante Manual"})]})]})},h=e=>{var o,t,a,i;let{element:d,in2D:s,close:r}=e;let c="".concat(null===d||void 0===d||null===(o=d.account)||void 0===o?void 0:o.accountId).concat(null!==d&&void 0!==d&&d.sub_account?"_"+(null===d||void 0===d||null===(t=d.sub_account)||void 0===t?void 0:t.sub_accountId):"");return(0,u.jsxs)("div",{className:"_dsplFlx hdr_bar","item-key":"".concat(c),children:[(0,u.jsx)("div",{className:"tr_bar_15",children:(0,u.jsx)(b,{data:d.account,labelField:"code",infoField:"name"})}),(0,u.jsx)("div",{className:"tr_bar_15",children:(0,u.jsx)(b,{data:d.sub_account,labelField:"subAccount",infoField:"subAccountName"})}),(0,u.jsx)("div",{className:"tr_bar_40",onClick:()=>{var e,o;if(null!==(e=(0,l.bh)("profileUser"))&&void 0!==e&&e.isAdmin||null===(o=(0,l.Ch)()[(0,l.bh)("date_current_year")])||void 0===o||!o.isClosed){if((0,l.ML)()){let e=(0,l.bh)("lastTimeCallModal")||0;if(Date.now()>e){let e=["document","amount","type","description","account","subAccount","comprobanteId"],o=(0,l.Ld)({...(0,l.bh)("comprobante_list")[d.operationId]},e);(0,l.Rz)("upd_comprobantebyId",o),(0,l.Rz)("upd_comprobantebyId_bck",JSON.parse(JSON.stringify(o))),(0,l.Rz)("lastTimeCallModal",Date.now()+320);let t={zIndex:450,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};t.content=(0,u.jsx)(v,{confirm:()=>{r()},item:d}),(0,n.OpenModal)(t)}}}else;},children:d.document}),(0,u.jsx)("div",{className:"tr_bar_15",children:null===(a=1*d.debit)||void 0===a?void 0:a.toFixed(2)}),(0,u.jsx)("div",{className:"tr_bar_15",children:null===(i=1*d.credit)||void 0===i?void 0:i.toFixed(2)})]},s)}},1702:(e,o,t)=>{t.d(o,{C:()=>r});var a=t(6963),l=t(2350),i=t(4e3);let d=0,s=null,n=null;const r=async e=>{const o=await a.PDFDocument.create();if(o.registerFontkit(i.Z),s=await o.embedFont(a.StandardFonts.TimesRoman,{subset:!0}),n=await o.embedFont(a.StandardFonts.TimesRomanBold,{subset:!0}),(0,l.bh)("modernFontReport")){let e=(0,l.bh)("Roboto-Bold.ttf"),t=(0,l.bh)("ggSans-Italic.ttf"),a=(0,l.bh)("ggSans-Medium.ttf");const i=await fetch(e).then((e=>e.arrayBuffer()));n=await o.embedFont(i,{subset:!0});await fetch(t).then((e=>e.arrayBuffer()));const d=await fetch(a).then((e=>e.arrayBuffer()));s=await o.embedFont(d,{subset:!0})}let t=o.addPage();const{width:r,height:c}=t.getSize(),u=10;let b=0,v=44;d=c-40,t.drawText(e.entryName||"Comprobante Manual",{x:50,y:d,size:14,font:n,color:(0,a.rgb)(0,0,0)});const m=n.widthOfTextAtSize(e.comprobanteId,14),x=s.widthOfTextAtSize("Comprobante:  ",13);t.drawText("Comprobante:  ",{x:580-x-m,y:d,size:13,font:s,color:(0,a.rgb)(0,0,0)}),t.drawText(e.comprobanteId+"",{x:580-m,y:d,size:14,font:n,color:(0,a.rgb)(0,0,0)}),d-=25;const h=s.widthOfTextAtSize("Fecha:  ",13),p=n.widthOfTextAtSize((0,l.Gv)(e.date)+"",14);t.drawText("Fecha:  ",{x:580-h-p,y:d,size:13,font:s,color:(0,a.rgb)(0,0,0)}),t.drawText((0,l.Gv)(e.date)+"",{x:580-p,y:d,size:14,font:n,color:(0,a.rgb)(0,0,0)}),d-=15;let y=(null===e||void 0===e?void 0:e.operations)||[];d-=18,t.drawText("Cuenta",{x:20,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)}),t.drawText("Sub Cuenta",{x:205,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)}),t.drawText("Documento",{x:360,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)});const _=n.widthOfTextAtSize("Debito",13);t.drawText("Debito",{x:500-_,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)});const f=n.widthOfTextAtSize("Credito",13);t.drawText("Credito",{x:580-f,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)}),d-=8,t.drawRectangle({x:15,y:d+1,width:570,height:.95,color:(0,a.rgb)(0,0,0),borderColor:(0,a.rgb)(0,0,0)});let w=Math.ceil(y.length/40);Array.from(Array(w).keys()).map((e=>{if(e>0){t=o.addPage(),d=c-26,t.drawText("Cuenta",{x:20,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)}),t.drawText("Sub Cuenta",{x:205,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)}),t.drawText("Documento",{x:360,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)});const e=n.widthOfTextAtSize("Debito",13);t.drawText("Debito",{x:500-e,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)});const l=n.widthOfTextAtSize("Credito",13);t.drawText("Credito",{x:580-l,y:d,size:13,font:n,color:(0,a.rgb)(0,0,0)}),d-=8,t.drawRectangle({x:15,y:d+1,width:570,height:.95,color:(0,a.rgb)(0,0,0),borderColor:(0,a.rgb)(0,0,0)}),d-=2}let l=y.slice(b,v);e>0&&(b=v+1,v=b+48),Array.isArray(l)&&l.map(((e,o)=>{var l,i,n,r,c;(d-=16,null!==e&&void 0!==e&&null!==(l=e.account)&&void 0!==l&&l.name)&&t.drawText((null===e||void 0===e||null===(c=e.account)||void 0===c?void 0:c.name)+"",{x:20,y:d,size:u,font:s,color:(0,a.rgb)(0,0,0)});if(null!==e&&void 0!==e&&null!==(i=e.sub_account)&&void 0!==i&&i.subAccountName){var b;let o=null===e||void 0===e||null===(b=e.sub_account)||void 0===b?void 0:b.subAccountName.substring(0,32);t.drawText(o+"",{x:205,y:d,size:u,font:s,color:(0,a.rgb)(0,0,0)})}t.drawText((null===e||void 0===e?void 0:e.document)+"",{x:360,y:d,size:u,font:s,color:(0,a.rgb)(0,0,0)});let v=null!==e&&void 0!==e&&e.debit?null===(n=1*(null===e||void 0===e?void 0:e.debit))||void 0===n?void 0:n.toFixed(2):"0.00";const m=s.widthOfTextAtSize(v+"",u);t.drawText(v+"",{x:500-m,y:d,size:u,font:s,color:(0,a.rgb)(0,0,0)});let x=null!==e&&void 0!==e&&e.credit?null===(r=1*(null===e||void 0===e?void 0:e.credit))||void 0===r?void 0:r.toFixed(2):"0.00";const h=s.widthOfTextAtSize(x+"",u);t.drawText(x+"",{x:580-h,y:d,size:u,font:s,color:(0,a.rgb)(0,0,0)})}))})),d-=28,t.drawRectangle({x:15,y:d+1,width:570,height:.85,color:(0,a.rgb)(0,0,0),borderColor:(0,a.rgb)(0,0,0)}),d-=18,t.drawText("Detalles: ",{x:50,y:d,size:12,font:s,color:(0,a.rgb)(0,0,0)}),d-=18,t.drawText(e.description?e.description:"",{x:70,y:d,size:11,font:s,color:(0,a.rgb)(0,0,0)});let g=function(e){let o=new Blob([e],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(o)}(await o.save());window.open(g)}},2502:(e,o,t)=>{t.d(o,{Dy:()=>l,Oy:()=>s,kQ:()=>i,lG:()=>d});var a=t(2350);const l=async e=>{var o,t;let l={...null===(o=(0,a.bh)((0,a.hQ)()))||void 0===o?void 0:o.all_employee};l.params={businessId:null===(t=(0,a.bh)("profileUser"))||void 0===t?void 0:t.businessId};const i=(0,a.I7)(l),d=await i;d&&((0,a.Rz)("employees_list",n((0,a.jQ)(d),"code")),(0,a.Rz)("employees_ids",(0,a.ME)((0,a.jQ)(d),"employeeId")),e&&e())},i=async e=>{var o,t;let l={...null===(o=(0,a.bh)((0,a.hQ)()))||void 0===o?void 0:o.search_employee};l.params={businessId:null===(t=(0,a.bh)("profileUser"))||void 0===t?void 0:t.businessId,":search":(0,a.bh)("searchQry")};const i=(0,a.I7)(l),d=await i;d&&((0,a.Rz)("employees_list",n((0,a.jQ)(d),"code")),e&&e())},d=async(e,o)=>{var t,l,i,d;let n={...null===(t=(0,a.bh)((0,a.hQ)()))||void 0===t?void 0:t.search_employee_paystub};n.params={businessId:null===(l=(0,a.bh)("profileUser"))||void 0===l?void 0:l.businessId,year:(0,a.bh)("date_current_year"),":date1":(null===(i=(0,a.bh)("date_range_comps"))||void 0===i?void 0:i.initDate)-10,":date2":null===(d=(0,a.bh)("date_range_comps"))||void 0===d?void 0:d.lastDate,":employeeId":e};const r=(0,a.I7)(n),c=await r;c&&!c.error&&((0,a.Rz)("paystub_submayor_list",c),(0,a._2)(c).map((async e=>{var o,t;s(null===(o=c[e])||void 0===o?void 0:o.comprobanteId,null===(t=c[e])||void 0===t?void 0:t.employeeId)}))),o&&o()},s=async(e,o)=>{let t="get_compById_last"+e+"_"+o,l=(0,a.bh)(t)||0;if(Date.now()>l){var i,d;(0,a.Rz)(t,Date.now()+890);let l={...null===(i=(0,a.bh)((0,a.hQ)()))||void 0===i?void 0:i.filter_search_opera};l.params={businessId:null===(d=(0,a.bh)("profileUser"))||void 0===d?void 0:d.businessId,":search0":e,":search1":o};const s=(0,a.I7)(l),n=await s;if(n){let o=(0,a.bh)("cmpByPayStubMayor");return o[e]=n,(0,a.Rz)("cmpByPayStubMayor",o),n}}return null};const n=(e,o)=>(0,a.MV)("sortEmployees",[e],(()=>e&&e.sort(((e,t)=>{let a=1*e[o],l=1*t[o];return a<l?-1:a>l?1:0}))))},1e3:()=>{}}]);
//# sourceMappingURL=9757.e1dc8887.chunk.js.map